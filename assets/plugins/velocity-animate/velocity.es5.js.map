{"version":3,"file":"velocity.es5.js","sources":["src/types.ts","src/utility.ts","src/Velocity/actions/actions.ts","src/constants.ts","src/Velocity/easing/easings.ts","src/Velocity/easing/bezier.ts","src/Velocity/easing/spring_rk4.ts","src/Velocity/easing/step.ts","src/Velocity/options.ts","src/Velocity/defaults.ts","src/Velocity/normalizations/normalizationsObject.ts","src/Velocity/data.ts","src/Velocity/state.ts","src/Velocity/queue.ts","src/Velocity/sequencesObject.ts","src/Velocity/complete.ts","src/Velocity/normalizations/normalizations.ts","src/Velocity/css/setPropertyValue.ts","src/Velocity/camelCase.ts","src/Velocity/css/fixColors.ts","src/Velocity/css/augmentDimension.ts","src/Velocity/css/getPropertyValue.ts","src/Velocity/tweens.ts","src/Velocity/tick.ts","src/Velocity/actions/finish.ts","src/Velocity/actions/option.ts","src/Velocity/actions/pauseResume.ts","src/Velocity/actions/property.ts","src/Velocity/actions/reverse.ts","src/Velocity/actions/stop.ts","src/Velocity/actions/style.ts","src/Velocity/actions/tween.ts","src/Velocity/css/colors.ts","src/Velocity/easing/back.ts","src/Velocity/easing/bounce.ts","src/Velocity/easing/elastic.ts","src/Velocity/easing/string.ts","src/Velocity/normalizations/dimensions.ts","src/Velocity/normalizations/display.ts","src/Velocity/normalizations/scroll.ts","src/Velocity/normalizations/style.ts","src/Velocity/normalizations/svg/attributes.ts","src/Velocity/normalizations/svg/dimensions.ts","src/Velocity/normalizations/tween.ts","version.ts","src/velocity.ts","src/Velocity/sequences.ts","src/velocityFn.ts","src/Velocity/patch.ts","src/velocity.ts"],"sourcesContent":["/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Runtime type checking methods.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityResult} from \"./../velocity.d\";\r\n\r\n/**\r\n * Check if a variable is a boolean.\r\n */\r\nexport function isBoolean(variable: any): variable is boolean {\r\n\treturn variable === true || variable === false;\r\n}\r\n\r\n/**\r\n * Check if a variable is an empty object.\r\n */\r\nexport function isEmptyObject(variable: {}): variable is {} {\r\n\tfor (const name in variable) {\r\n\t\tif (variable.hasOwnProperty(name)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Check if a variable is a function.\r\n */\r\nexport function isFunction(variable: any): variable is Function { // tslint:disable-line:ban-types\r\n\treturn Object.prototype.toString.call(variable) === \"[object Function]\";\r\n}\r\n\r\n/**\r\n * Check if a variable is an HTMLElement or SVGElement.\r\n */\r\nexport function isNode(variable: any): variable is HTMLorSVGElement {\r\n\treturn !!(variable && (variable as Element).nodeType);\r\n}\r\n\r\n/**\r\n * Check if a variable is a number.\r\n */\r\nexport function isNumber(variable: any): variable is number {\r\n\treturn typeof variable === \"number\";\r\n}\r\n\r\n/**\r\n * Faster way to parse a string/number as a number https://jsperf.com/number-vs-parseint-vs-plus/3\r\n */\r\nexport function isNumberWhenParsed(variable: any): variable is number {\r\n\treturn !isNaN(Number(variable));\r\n}\r\n\r\n/**\r\n * Check if a variable is a plain object (and not an instance).\r\n */\r\nexport function isPlainObject(variable: any): variable is {} {\r\n\tif (!variable || typeof variable !== \"object\" || (variable as Element).nodeType || Object.prototype.toString.call(variable) !== \"[object Object]\") {\r\n\t\treturn false;\r\n\t}\r\n\tconst proto = Object.getPrototypeOf(variable) as object;\r\n\r\n\treturn !proto || (proto.hasOwnProperty(\"constructor\") && proto.constructor === Object);\r\n}\r\n\r\n/**\r\n * Check if a variable is an SVGElement.\r\n */\r\nexport function isSVG(variable: any): variable is SVGElement {\r\n\treturn SVGElement && variable instanceof SVGElement;\r\n}\r\n\r\n/**\r\n * Check if a variable is a string.\r\n */\r\nexport function isString(variable: any): variable is string {\r\n\treturn typeof variable === \"string\";\r\n}\r\n\r\n/**\r\n * Check if a variable is the result of calling Velocity.\r\n */\r\nexport function isVelocityResult(variable: any): variable is VelocityResult {\r\n\treturn variable && isNumber((variable as VelocityResult).length) && isFunction((variable as VelocityResult).velocity);\r\n}\r\n\r\n/**\r\n * Check if a variable is an array-like wrapped jQuery, Zepto or similar, where\r\n * each indexed value is a Node.\r\n */\r\n\r\nexport function isWrapped(variable: any): variable is HTMLorSVGElement[] {\r\n\treturn variable\r\n\t\t&& variable !== window\r\n\t\t&& isNumber((variable as HTMLorSVGElement[]).length)\r\n\t\t&& !isString(variable)\r\n\t\t&& !isFunction(variable)\r\n\t\t&& !isNode(variable)\r\n\t\t&& ((variable as HTMLorSVGElement[]).length === 0 || isNode(variable[0]));\r\n}\r\n\r\n/**\r\n * Check is a property is an enumerable member of an object.\r\n */\r\nexport function propertyIsEnumerable(obj: object, property: string): boolean {\r\n\treturn Object.prototype.propertyIsEnumerable.call(obj, property);\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement} from \"./../velocity.d\";\r\n\r\n// Project\r\nimport {isNode} from \"./types\";\r\n\r\n/**\r\n * Add a single className to an Element.\r\n */\r\nexport function addClass(element: HTMLorSVGElement, className: string): void {\r\n\tif (element instanceof Element) {\r\n\t\tif (element.classList) {\r\n\t\t\telement.classList.add(className);\r\n\t\t} else {\r\n\t\t\tremoveClass(element, className);\r\n\t\t\t(element as any).className += (element.className.length ? \" \" : \"\") + className;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Clone an array, works for array-like too.\r\n */\r\nexport function cloneArray<T = any>(arrayLike: T[] | ArrayLike<T>): T[] {\r\n\treturn Array.prototype.slice.call(arrayLike, 0);\r\n}\r\n\r\n/**\r\n * The <strong><code>defineProperty()</code></strong> function provides a\r\n * shortcut to defining a property that cannot be accidentally iterated across.\r\n */\r\nexport function defineProperty(proto: any, name: string, value: any, readonly?: boolean) {\r\n\tif (proto) {\r\n\t\tObject.defineProperty(proto, name, {\r\n\t\t\tconfigurable: !readonly,\r\n\t\t\twritable: !readonly,\r\n\t\t\tvalue,\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * When there are multiple locations for a value pass them all in, then get the\r\n * first value that is valid.\r\n */\r\nexport function getValue<T>(...args: T[]): T {\r\n\tfor (const arg of arguments) {\r\n\t\tif (arg !== undefined && arg === arg) {\r\n\t\t\treturn arg;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Shim to get the current milliseconds - on anything except old IE it'll use\r\n * Date.now() and save creating an object. If that doesn't exist then it'll\r\n * create one that gets GC.\r\n */\r\nexport const now = Date.now ? Date.now : () => {\r\n\treturn (new Date()).getTime();\r\n};\r\n\r\n/**\r\n * Remove a single className from an Element.\r\n */\r\nexport function removeClass(element: HTMLorSVGElement, className: string): void {\r\n\tif (element instanceof Element) {\r\n\t\tif (element.classList) {\r\n\t\t\telement.classList.remove(className);\r\n\t\t} else {\r\n\t\t\t// TODO: Need some jsperf tests on performance - can we get rid of the regex and maybe use split / array manipulation?\r\n\t\t\t(element as any).className = element.className.replace(new RegExp(`(^|\\\\s)${className}(\\\\s|$)`, \"gi\"), \" \");\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Convert an element or array-like element list into an array if needed.\r\n */\r\nexport function sanitizeElements(elements: HTMLorSVGElement | HTMLorSVGElement[]): HTMLorSVGElement[] {\r\n\treturn isNode(elements)\r\n\t\t? [elements] as HTMLorSVGElement[]\r\n\t\t: elements as HTMLorSVGElement[];\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Actions that can be performed by passing a string instead of a propertiesMap.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityActionFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isFunction, isString, propertyIsEnumerable} from \"../../types\";\r\nimport {defineProperty} from \"../../utility\";\r\n\r\n// Constants\r\nexport const Actions: {[name: string]: VelocityActionFn} = {};\r\n\r\n/**\r\n * Used to register an action. This should never be called by users\r\n * directly, instead it should be called via  an action:<br/>\r\n * <code>Velocity(\"registerAction\", \"name\", VelocityActionFn);</code>\r\n */\r\nexport function registerAction(args?: [string, VelocityActionFn], internal?: boolean) {\r\n\tconst name: string = args[0],\r\n\t\tcallback = args[1];\r\n\r\n\tif (!isString(name)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerAction' name to an invalid value:`, name);\r\n\t} else if (!isFunction(callback)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerAction' callback to an invalid value:`, name, callback);\r\n\t} else if (Actions[name] && !propertyIsEnumerable(Actions, name)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to override internal 'registerAction' callback`, name);\r\n\t} else if (internal === true) {\r\n\t\tdefineProperty(Actions, name, callback);\r\n\t} else {\r\n\t\tActions[name] = callback;\r\n\t}\r\n}\r\n\r\nregisterAction([\"registerAction\", registerAction as any], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Constants and defaults. These values should never change without a MINOR\r\n * version bump.\r\n */\r\n\r\n/**\r\n * Without this it will only un-prefix properties that have a valid \"normal\"\r\n * version.\r\n */\r\nexport const ALL_VENDOR_PREFIXES = true;\r\n\r\nexport const DURATION_FAST = 200;\r\nexport const DURATION_NORMAL = 400;\r\nexport const DURATION_SLOW = 600;\r\n\r\nexport const FUZZY_MS_PER_SECOND = 980;\r\n\r\nexport const DEFAULT_CACHE = true;\r\nexport const DEFAULT_DELAY = 0;\r\nexport const DEFAULT_DURATION = DURATION_NORMAL;\r\nexport const DEFAULT_EASING = \"swing\";\r\nexport const DEFAULT_FPSLIMIT = 60;\r\nexport const DEFAULT_LOOP = 0;\r\nexport const DEFAULT_PROMISE = true;\r\nexport const DEFAULT_PROMISE_REJECT_EMPTY = true;\r\nexport const DEFAULT_QUEUE = \"\";\r\nexport const DEFAULT_REPEAT = 0;\r\nexport const DEFAULT_SPEED = 1;\r\nexport const DEFAULT_SYNC = true;\r\n\r\nexport const CLASSNAME = \"velocity-animating\";\r\n\r\nexport const Duration = {\r\n\tfast: DURATION_FAST,\r\n\tnormal: DURATION_NORMAL,\r\n\tslow: DURATION_SLOW,\r\n};\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityEasingFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isFunction, isString} from \"../../types\";\r\nimport {registerAction} from \"../actions/actions\";\r\n\r\n// Constants\r\nexport const Easings: {[name: string]: VelocityEasingFn} = {};\r\n\r\n/**\r\n * Used to register a easing. This should never be called by users\r\n * directly, instead it should be called via an action:<br/>\r\n * <code>Velocity(\"registerEasing\", \"name\", VelocityEasingFn);</code>\r\n */\r\nexport function registerEasing(args?: [string, VelocityEasingFn]) {\r\n\tconst name: string = args[0],\r\n\t\tcallback = args[1];\r\n\r\n\tif (!isString(name)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerEasing' name to an invalid value:`, name);\r\n\t} else if (!isFunction(callback)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerEasing' callback to an invalid value:`, name, callback);\r\n\t} else if (Easings[name]) {\r\n\t\tconsole.warn(`VelocityJS: Trying to override 'registerEasing' callback`, name);\r\n\t} else {\r\n\t\tEasings[name] = callback;\r\n\t}\r\n}\r\n\r\nregisterAction([\"registerEasing\", registerEasing], true);\r\n\r\n/**\r\n * Linear easing, used for sequence parts that don't have an actual easing\r\n * function.\r\n */\r\nexport function linearEasing(percentComplete, startValue, endValue, property) {\r\n\treturn startValue + percentComplete * (endValue - startValue);\r\n}\r\n\r\n/**\r\n * Swing is the default for jQuery and Velocity.\r\n */\r\nexport function swingEasing(percentComplete, startValue, endValue) {\r\n\treturn startValue + (0.5 - Math.cos(percentComplete * Math.PI) / 2) * (endValue - startValue);\r\n}\r\n\r\n/**\r\n * A less exaggerated version of easeInOutElastic.\r\n */\r\nexport function springEasing(percentComplete, startValue, endValue) {\r\n\treturn startValue + (1 - (Math.cos(percentComplete * 4.5 * Math.PI) * Math.exp(-percentComplete * 6))) * (endValue - startValue);\r\n}\r\n\r\nregisterEasing([\"linear\", linearEasing]);\r\nregisterEasing([\"swing\", swingEasing]);\r\nregisterEasing([\"spring\", springEasing]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityEasingFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {registerEasing} from \"./easings\";\r\n\r\n/**\r\n * Fix to a range of <code>0 <= num <= 1</code>.\r\n */\r\nfunction fixRange(num: number) {\r\n\treturn Math.min(Math.max(num, 0), 1);\r\n}\r\n\r\nfunction A(aA1, aA2) {\r\n\treturn 1 - 3 * aA2 + 3 * aA1;\r\n}\r\n\r\nfunction B(aA1, aA2) {\r\n\treturn 3 * aA2 - 6 * aA1;\r\n}\r\n\r\nfunction C(aA1) {\r\n\treturn 3 * aA1;\r\n}\r\n\r\nfunction calcBezier(aT, aA1, aA2) {\r\n\treturn ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT;\r\n}\r\n\r\nfunction getSlope(aT, aA1, aA2) {\r\n\treturn 3 * A(aA1, aA2) * aT * aT + 2 * B(aA1, aA2) * aT + C(aA1);\r\n}\r\n\r\nexport function generateBezier(mX1: number, mY1: number, mX2: number, mY2: number): VelocityEasingFn {\r\n\tconst NEWTON_ITERATIONS = 4,\r\n\t\tNEWTON_MIN_SLOPE = 0.001,\r\n\t\tSUBDIVISION_PRECISION = 0.0000001,\r\n\t\tSUBDIVISION_MAX_ITERATIONS = 10,\r\n\t\tkSplineTableSize = 11,\r\n\t\tkSampleStepSize = 1 / (kSplineTableSize - 1),\r\n\t\tfloat32ArraySupported = \"Float32Array\" in window;\r\n\r\n\t/* Must contain four arguments. */\r\n\tif (arguments.length !== 4) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t/* Arguments must be numbers. */\r\n\tfor (let i = 0; i < 4; ++i) {\r\n\t\tif (typeof arguments[i] !== \"number\" || isNaN(arguments[i]) || !isFinite(arguments[i])) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t/* X values must be in the [0, 1] range. */\r\n\tmX1 = fixRange(mX1);\r\n\tmX2 = fixRange(mX2);\r\n\r\n\tconst mSampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\r\n\r\n\tfunction newtonRaphsonIterate(aX, aGuessT) {\r\n\t\tfor (let i = 0; i < NEWTON_ITERATIONS; ++i) {\r\n\t\t\tconst currentSlope = getSlope(aGuessT, mX1, mX2);\r\n\r\n\t\t\tif (currentSlope === 0) {\r\n\t\t\t\treturn aGuessT;\r\n\t\t\t}\r\n\r\n\t\t\tconst currentX = calcBezier(aGuessT, mX1, mX2) - aX;\r\n\t\t\taGuessT -= currentX / currentSlope;\r\n\t\t}\r\n\r\n\t\treturn aGuessT;\r\n\t}\r\n\r\n\tfunction calcSampleValues() {\r\n\t\tfor (let i = 0; i < kSplineTableSize; ++i) {\r\n\t\t\tmSampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction binarySubdivide(aX, aA, aB) {\r\n\t\tlet currentX, currentT, i = 0;\r\n\r\n\t\tdo {\r\n\t\t\tcurrentT = aA + (aB - aA) / 2;\r\n\t\t\tcurrentX = calcBezier(currentT, mX1, mX2) - aX;\r\n\t\t\tif (currentX > 0) {\r\n\t\t\t\taB = currentT;\r\n\t\t\t} else {\r\n\t\t\t\taA = currentT;\r\n\t\t\t}\r\n\t\t} while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\r\n\r\n\t\treturn currentT;\r\n\t}\r\n\r\n\tfunction getTForX(aX) {\r\n\t\tconst lastSample = kSplineTableSize - 1;\r\n\t\tlet intervalStart = 0,\r\n\t\t\tcurrentSample = 1;\r\n\r\n\t\tfor (; currentSample !== lastSample && mSampleValues[currentSample] <= aX; ++currentSample) {\r\n\t\t\tintervalStart += kSampleStepSize;\r\n\t\t}\r\n\r\n\t\t--currentSample;\r\n\r\n\t\tconst dist = (aX - mSampleValues[currentSample]) / (mSampleValues[currentSample + 1] - mSampleValues[currentSample]),\r\n\t\t\tguessForT = intervalStart + dist * kSampleStepSize,\r\n\t\t\tinitialSlope = getSlope(guessForT, mX1, mX2);\r\n\r\n\t\tif (initialSlope >= NEWTON_MIN_SLOPE) {\r\n\t\t\treturn newtonRaphsonIterate(aX, guessForT);\r\n\t\t} else if (initialSlope === 0) {\r\n\t\t\treturn guessForT;\r\n\t\t} else {\r\n\t\t\treturn binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize);\r\n\t\t}\r\n\t}\r\n\r\n\tlet precomputed = false;\r\n\r\n\tfunction precompute() {\r\n\t\tprecomputed = true;\r\n\t\tif (mX1 !== mY1 || mX2 !== mY2) {\r\n\t\t\tcalcSampleValues();\r\n\t\t}\r\n\t}\r\n\r\n\tconst str = `generateBezier(${[mX1, mY1, mX2, mY2]})`,\r\n\t\tf = (percentComplete: number, startValue: number, endValue: number, property?: string) => {\r\n\t\t\tif (!precomputed) {\r\n\t\t\t\tprecompute();\r\n\t\t\t}\r\n\t\t\tif (percentComplete === 0) {\r\n\t\t\t\treturn startValue;\r\n\t\t\t}\r\n\t\t\tif (percentComplete === 1) {\r\n\t\t\t\treturn endValue;\r\n\t\t\t}\r\n\t\t\tif (mX1 === mY1 && mX2 === mY2) {\r\n\t\t\t\treturn startValue + percentComplete * (endValue - startValue);\r\n\t\t\t}\r\n\r\n\t\t\treturn startValue + calcBezier(getTForX(percentComplete), mY1, mY2) * (endValue - startValue);\r\n\t\t};\r\n\r\n\t(f as any).getControlPoints = () => {\r\n\t\treturn [{x: mX1, y: mY1}, {x: mX2, y: mY2}];\r\n\t};\r\n\tf.toString = () => {\r\n\t\treturn str;\r\n\t};\r\n\r\n\treturn f;\r\n}\r\n\r\n/* Common easings */\r\nconst easeIn = generateBezier(0.42, 0, 1, 1),\r\n\teaseOut = generateBezier(0, 0, 0.58, 1),\r\n\teaseInOut = generateBezier(0.42, 0, 0.58, 1);\r\n\r\nregisterEasing([\"ease\", generateBezier(0.25, 0.1, 0.25, 1)]);\r\nregisterEasing([\"easeIn\", easeIn]);\r\nregisterEasing([\"ease-in\", easeIn]);\r\nregisterEasing([\"easeOut\", easeOut]);\r\nregisterEasing([\"ease-out\", easeOut]);\r\nregisterEasing([\"easeInOut\", easeInOut]);\r\nregisterEasing([\"ease-in-out\", easeInOut]);\r\nregisterEasing([\"easeInSine\", generateBezier(0.47, 0, 0.745, 0.715)]);\r\nregisterEasing([\"easeOutSine\", generateBezier(0.39, 0.575, 0.565, 1)]);\r\nregisterEasing([\"easeInOutSine\", generateBezier(0.445, 0.05, 0.55, 0.95)]);\r\nregisterEasing([\"easeInQuad\", generateBezier(0.55, 0.085, 0.68, 0.53)]);\r\nregisterEasing([\"easeOutQuad\", generateBezier(0.25, 0.46, 0.45, 0.94)]);\r\nregisterEasing([\"easeInOutQuad\", generateBezier(0.455, 0.03, 0.515, 0.955)]);\r\nregisterEasing([\"easeInCubic\", generateBezier(0.55, 0.055, 0.675, 0.19)]);\r\nregisterEasing([\"easeOutCubic\", generateBezier(0.215, 0.61, 0.355, 1)]);\r\nregisterEasing([\"easeInOutCubic\", generateBezier(0.645, 0.045, 0.355, 1)]);\r\nregisterEasing([\"easeInQuart\", generateBezier(0.895, 0.03, 0.685, 0.22)]);\r\nregisterEasing([\"easeOutQuart\", generateBezier(0.165, 0.84, 0.44, 1)]);\r\nregisterEasing([\"easeInOutQuart\", generateBezier(0.77, 0, 0.175, 1)]);\r\nregisterEasing([\"easeInQuint\", generateBezier(0.755, 0.05, 0.855, 0.06)]);\r\nregisterEasing([\"easeOutQuint\", generateBezier(0.23, 1, 0.32, 1)]);\r\nregisterEasing([\"easeInOutQuint\", generateBezier(0.86, 0, 0.07, 1)]);\r\nregisterEasing([\"easeInExpo\", generateBezier(0.95, 0.05, 0.795, 0.035)]);\r\nregisterEasing([\"easeOutExpo\", generateBezier(0.19, 1, 0.22, 1)]);\r\nregisterEasing([\"easeInOutExpo\", generateBezier(1, 0, 0, 1)]);\r\nregisterEasing([\"easeInCirc\", generateBezier(0.6, 0.04, 0.98, 0.335)]);\r\nregisterEasing([\"easeOutCirc\", generateBezier(0.075, 0.82, 0.165, 1)]);\r\nregisterEasing([\"easeInOutCirc\", generateBezier(0.785, 0.135, 0.15, 0.86)]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityEasingFn} from \"../../../velocity.d\";\r\n\r\ninterface springState {\r\n\tx: number;\r\n\tv: number;\r\n\ttension: number;\r\n\tfriction: number;\r\n}\r\n\r\ninterface springDelta {\r\n\tdx: number;\r\n\tdv: number;\r\n}\r\n\r\n/* Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */\r\n/* Given a tension, friction, and duration, a simulation at 60FPS will first run without a defined duration in order to calculate the full path. A second pass\r\n then adjusts the time delta -- using the relation between actual time and duration -- to calculate the path for the duration-constrained animation. */\r\nfunction springAccelerationForState(state: springState) {\r\n\treturn (-state.tension * state.x) - (state.friction * state.v);\r\n}\r\n\r\nfunction springEvaluateStateWithDerivative(initialState: springState, dt: number, derivative: springDelta): springDelta {\r\n\tconst state = {\r\n\t\tx: initialState.x + derivative.dx * dt,\r\n\t\tv: initialState.v + derivative.dv * dt,\r\n\t\ttension: initialState.tension,\r\n\t\tfriction: initialState.friction,\r\n\t};\r\n\r\n\treturn {\r\n\t\tdx: state.v,\r\n\t\tdv: springAccelerationForState(state),\r\n\t};\r\n}\r\n\r\nfunction springIntegrateState(state: springState, dt: number) {\r\n\tconst a = {\r\n\t\tdx: state.v,\r\n\t\tdv: springAccelerationForState(state),\r\n\t},\r\n\t\tb = springEvaluateStateWithDerivative(state, dt * 0.5, a),\r\n\t\tc = springEvaluateStateWithDerivative(state, dt * 0.5, b),\r\n\t\td = springEvaluateStateWithDerivative(state, dt, c),\r\n\t\tdxdt = 1 / 6 * (a.dx + 2 * (b.dx + c.dx) + d.dx),\r\n\t\tdvdt = 1 / 6 * (a.dv + 2 * (b.dv + c.dv) + d.dv);\r\n\r\n\tstate.x = state.x + dxdt * dt;\r\n\tstate.v = state.v + dvdt * dt;\r\n\r\n\treturn state;\r\n}\r\n\r\nexport function generateSpringRK4(tension: number, friction: number): number;\r\nexport function generateSpringRK4(tension: number, friction: number, duration: number): VelocityEasingFn;\r\nexport function generateSpringRK4(tension: number, friction: number, duration?: number): any {\r\n\tconst initState: springState = {\r\n\t\tx: -1,\r\n\t\tv: 0,\r\n\t\ttension: parseFloat(tension as any) || 500,\r\n\t\tfriction: parseFloat(friction as any) || 20,\r\n\t},\r\n\t\tpath = [0],\r\n\t\ttolerance = 1 / 10000,\r\n\t\tDT = 16 / 1000,\r\n\t\thaveDuration = duration != null; // deliberate \"==\", as undefined == null != 0\r\n\tlet timeLapsed = 0,\r\n\t\tdt: number,\r\n\t\tlastState: springState;\r\n\r\n\t/* Calculate the actual time it takes for this animation to complete with the provided conditions. */\r\n\tif (haveDuration) {\r\n\t\t/* Run the simulation without a duration. */\r\n\t\ttimeLapsed = generateSpringRK4(initState.tension, initState.friction);\r\n\t\t/* Compute the adjusted time delta. */\r\n\t\tdt = (timeLapsed as number) / duration * DT;\r\n\t} else {\r\n\t\tdt = DT;\r\n\t}\r\n\r\n\twhile (true) {\r\n\t\t/* Next/step function .*/\r\n\t\tlastState = springIntegrateState(lastState || initState, dt);\r\n\t\t/* Store the position. */\r\n\t\tpath.push(1 + lastState.x);\r\n\t\ttimeLapsed += 16;\r\n\t\t/* If the change threshold is reached, break. */\r\n\t\tif (!(Math.abs(lastState.x) > tolerance && Math.abs(lastState.v) > tolerance)) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t/* If duration is not defined, return the actual time required for completing this animation. Otherwise, return a closure that holds the\r\n\t computed path and returns a snapshot of the position according to a given percentComplete. */\r\n\treturn !haveDuration ? timeLapsed : (percentComplete: number, startValue: number, endValue: number) => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn startValue + path[Math.floor(percentComplete * (path.length - 1))] * (endValue - startValue);\r\n\t};\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details\r\n *\r\n * Step easing generator.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityEasingFn} from \"../../../velocity.d\";\r\n\r\n// Constants\r\nconst cache: {[steps: number]: VelocityEasingFn} = {};\r\n\r\nexport function generateStep(steps): VelocityEasingFn {\r\n\tconst fn = cache[steps];\r\n\r\n\tif (fn) {\r\n\t\treturn fn;\r\n\t}\r\n\r\n\treturn cache[steps] = (percentComplete: number, startValue: number, endValue: number) => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn startValue + Math.round(percentComplete * steps) * (1 / steps) * (endValue - startValue);\r\n\t};\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Validation functions used for various types of data that can be supplied.\r\n * All errors are reported in the non-minified version for development. If a\r\n * validation fails then it should return <code>undefined</code>.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityCallbackFn, VelocityEasingFn, VelocityEasingType, VelocityProgressFn} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {Duration} from \"../constants\";\r\nimport {isBoolean, isFunction, isNumber, isString} from \"../types\";\r\nimport {generateBezier} from \"./easing/bezier\";\r\nimport {Easings} from \"./easing/easings\";\r\nimport {generateSpringRK4} from \"./easing/spring_rk4\";\r\nimport {generateStep} from \"./easing/step\";\r\n\r\n/**\r\n * Parse a duration value and return an ms number. Optionally return a\r\n * default value if the number is not valid.\r\n */\r\nexport function parseDuration(duration: \"fast\" | \"normal\" | \"slow\" | number, def?: \"fast\" | \"normal\" | \"slow\" | number): number {\r\n\tif (isNumber(duration)) {\r\n\t\treturn duration;\r\n\t}\r\n\tif (isString(duration)) {\r\n\t\treturn Duration[duration.toLowerCase()]\r\n\t\t\t|| parseFloat(duration.replace(\"ms\", \"\")\r\n\t\t\t\t.replace(\"s\", \"000\"));\r\n\t}\r\n\r\n\treturn def == null ? undefined : parseDuration(def);\r\n}\r\n\r\n/**\r\n * Validate a <code>cache</code> option.\r\n */\r\nexport function validateCache(value: boolean): boolean {\r\n\tif (isBoolean(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'cache' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>begin</code> option.\r\n */\r\nexport function validateBegin(value: VelocityCallbackFn): VelocityCallbackFn {\r\n\tif (isFunction(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'begin' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>complete</code> option.\r\n */\r\nexport function validateComplete(value: VelocityCallbackFn, noError?: true): VelocityCallbackFn {\r\n\tif (isFunction(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null && !noError) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'complete' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>delay</code> option.\r\n */\r\nexport function validateDelay(value: \"fast\" | \"normal\" | \"slow\" | number): number {\r\n\tconst parsed = parseDuration(value);\r\n\r\n\tif (!isNaN(parsed)) {\r\n\t\treturn parsed;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.error(`VelocityJS: Trying to set 'delay' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>duration</code> option.\r\n */\r\nexport function validateDuration(value: \"fast\" | \"normal\" | \"slow\" | number, noError?: true): number {\r\n\tconst parsed = parseDuration(value);\r\n\r\n\tif (!isNaN(parsed) && parsed >= 0) {\r\n\t\treturn parsed;\r\n\t}\r\n\tif (value != null && !noError) {\r\n\t\tconsole.error(`VelocityJS: Trying to set 'duration' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>easing</code> option.\r\n */\r\nexport function validateEasing(value: VelocityEasingType, duration: number, noError?: true): VelocityEasingFn {\r\n\tif (isString(value)) {\r\n\t\t// Named easing\r\n\t\treturn Easings[value];\r\n\t}\r\n\tif (isFunction(value)) {\r\n\t\treturn value;\r\n\t}\r\n\t// TODO: We should only do these if the correct function exists - don't force loading.\r\n\tif (Array.isArray(value)) {\r\n\t\tif (value.length === 1) {\r\n\t\t\t// Steps\r\n\t\t\treturn generateStep(value[0]);\r\n\t\t}\r\n\t\tif (value.length === 2) {\r\n\t\t\t// springRK4 must be passed the animation's duration.\r\n\t\t\t// Note: If the springRK4 array contains non-numbers,\r\n\t\t\t// generateSpringRK4() returns an easing function generated with\r\n\t\t\t// default tension and friction values.\r\n\t\t\treturn generateSpringRK4(value[0], value[1], duration);\r\n\t\t}\r\n\t\tif (value.length === 4) {\r\n\t\t\t// Note: If the bezier array contains non-numbers, generateBezier()\r\n\t\t\t// returns undefined.\r\n\t\t\treturn generateBezier.apply(null, value) || false;\r\n\t\t}\r\n\t}\r\n\tif (value != null && !noError) {\r\n\t\tconsole.error(`VelocityJS: Trying to set 'easing' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>fpsLimit</code> option.\r\n */\r\nexport function validateFpsLimit(value: number | false): number {\r\n\tif (value === false) {\r\n\t\treturn 0;\r\n\t} else {\r\n\t\tconst parsed = parseInt(value as any, 10);\r\n\r\n\t\tif (!isNaN(parsed) && parsed >= 0) {\r\n\t\t\treturn Math.min(parsed, 60);\r\n\t\t}\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'fpsLimit' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>loop</code> option.\r\n */\r\nexport function validateLoop(value: number | boolean): number | true {\r\n\tswitch (value) {\r\n\t\tcase false:\r\n\t\t\treturn 0;\r\n\r\n\t\tcase true:\r\n\t\t\treturn true;\r\n\r\n\t\tdefault:\r\n\t\t\tconst parsed = parseInt(value as any, 10);\r\n\r\n\t\t\tif (!isNaN(parsed) && parsed >= 0) {\r\n\t\t\t\treturn parsed;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'loop' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>progress</code> option.\r\n */\r\nexport function validateProgress(value: VelocityProgressFn): VelocityProgressFn {\r\n\tif (isFunction(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'progress' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>promise</code> option.\r\n */\r\nexport function validatePromise(value: boolean): boolean {\r\n\tif (isBoolean(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'promise' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>promiseRejectEmpty</code> option.\r\n */\r\nexport function validatePromiseRejectEmpty(value: boolean): boolean {\r\n\tif (isBoolean(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'promiseRejectEmpty' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>queue</code> option.\r\n */\r\nexport function validateQueue(value: string | false, noError?: true): string | false {\r\n\tif (value === false || isString(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null && !noError) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'queue' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>repeat</code> option.\r\n */\r\nexport function validateRepeat(value: number | boolean): number | true {\r\n\tswitch (value) {\r\n\t\tcase false:\r\n\t\t\treturn 0;\r\n\r\n\t\tcase true:\r\n\t\t\treturn true;\r\n\r\n\t\tdefault:\r\n\t\t\tconst parsed = parseInt(value as any, 10);\r\n\r\n\t\t\tif (!isNaN(parsed) && parsed >= 0) {\r\n\t\t\t\treturn parsed;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'repeat' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>speed</code> option.\r\n */\r\nexport function validateSpeed(value: number): number {\r\n\tif (isNumber(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.error(`VelocityJS: Trying to set 'speed' to an invalid value:`, value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Validate a <code>sync</code> option.\r\n */\r\nexport function validateSync(value: boolean): boolean {\r\n\tif (isBoolean(value)) {\r\n\t\treturn value;\r\n\t}\r\n\tif (value != null) {\r\n\t\tconsole.error(`VelocityJS: Trying to set 'sync' to an invalid value:`, value);\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Velocity option defaults, which can be overriden by the user.\r\n */\r\n\r\n// Typedefs\r\nimport {StrictVelocityOptions, VelocityCallbackFn, VelocityEasingFn} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {isBoolean} from \"../types\";\r\nimport {\r\n\tvalidateBegin, validateCache, validateComplete, validateDelay, validateDuration,\r\n\tvalidateEasing, validateFpsLimit, validateLoop, validatePromise, validatePromiseRejectEmpty,\r\n\tvalidateQueue, validateRepeat, validateSpeed, validateSync,\r\n} from \"./options\";\r\n\r\n// Constants\r\nimport {\r\n\tDEFAULT_CACHE, DEFAULT_DELAY, DEFAULT_DURATION, DEFAULT_EASING, DEFAULT_FPSLIMIT,\r\n\tDEFAULT_LOOP, DEFAULT_PROMISE, DEFAULT_PROMISE_REJECT_EMPTY, DEFAULT_QUEUE, DEFAULT_REPEAT,\r\n\tDEFAULT_SPEED, DEFAULT_SYNC, FUZZY_MS_PER_SECOND,\r\n} from \"../constants\";\r\n\r\n// NOTE: Add the variable here, then add the default state in \"reset\" below.\r\nlet cache: boolean,\r\n\tbegin: VelocityCallbackFn,\r\n\tcomplete: VelocityCallbackFn,\r\n\tdelay: number,\r\n\tduration: number,\r\n\teasing: VelocityEasingFn,\r\n\tfpsLimit: number,\r\n\tloop: number | true,\r\n\tmobileHA: boolean,\r\n\tminFrameTime: number,\r\n\tpromise: boolean,\r\n\tpromiseRejectEmpty: boolean,\r\n\tqueue: string | false,\r\n\trepeat: number | true,\r\n\tspeed: number,\r\n\tsync: boolean;\r\n\r\nexport abstract class defaults implements StrictVelocityOptions {\r\n\tstatic reset() {\r\n\t\tcache = DEFAULT_CACHE;\r\n\t\tbegin = undefined;\r\n\t\tcomplete = undefined;\r\n\t\tdelay = DEFAULT_DELAY;\r\n\t\tduration = DEFAULT_DURATION;\r\n\t\teasing = validateEasing(DEFAULT_EASING, DEFAULT_DURATION);\r\n\t\tfpsLimit = DEFAULT_FPSLIMIT;\r\n\t\tloop = DEFAULT_LOOP;\r\n\t\tminFrameTime = FUZZY_MS_PER_SECOND / DEFAULT_FPSLIMIT;\r\n\t\tpromise = DEFAULT_PROMISE;\r\n\t\tpromiseRejectEmpty = DEFAULT_PROMISE_REJECT_EMPTY;\r\n\t\tqueue = DEFAULT_QUEUE;\r\n\t\trepeat = DEFAULT_REPEAT;\r\n\t\tspeed = DEFAULT_SPEED;\r\n\t\tsync = DEFAULT_SYNC;\r\n\t}\r\n\r\n\tstatic get cache(): boolean {\r\n\t\treturn cache;\r\n\t}\r\n\r\n\tstatic set cache(value: boolean) {\r\n\t\tvalue = validateCache(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tcache = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get begin(): VelocityCallbackFn {\r\n\t\treturn begin;\r\n\t}\r\n\tstatic set begin(value: VelocityCallbackFn) {\r\n\t\tvalue = validateBegin(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tbegin = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get complete(): VelocityCallbackFn {\r\n\t\treturn complete;\r\n\t}\r\n\r\n\tstatic set complete(value: VelocityCallbackFn) {\r\n\t\tvalue = validateComplete(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tcomplete = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get delay(): number {\r\n\t\treturn delay;\r\n\t}\r\n\tstatic set delay(value: number) {\r\n\t\tvalue = validateDelay(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tdelay = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get duration(): number {\r\n\t\treturn duration;\r\n\t}\r\n\tstatic set duration(value: number) {\r\n\t\tvalue = validateDuration(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tduration = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get easing(): VelocityEasingFn {\r\n\t\treturn easing;\r\n\t}\r\n\tstatic set easing(value: VelocityEasingFn) {\r\n\t\tvalue = validateEasing(value, duration);\r\n\t\tif (value !== undefined) {\r\n\t\t\teasing = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get fpsLimit(): number | false {\r\n\t\treturn fpsLimit;\r\n\t}\r\n\tstatic set fpsLimit(value: number | false) {\r\n\t\tvalue = validateFpsLimit(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tfpsLimit = value;\r\n\t\t\tminFrameTime = FUZZY_MS_PER_SECOND / value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get loop(): number | true {\r\n\t\treturn loop;\r\n\t}\r\n\tstatic set loop(value: number | true) {\r\n\t\tvalue = validateLoop(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tloop = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get mobileHA(): boolean {\r\n\t\treturn mobileHA;\r\n\t}\r\n\tstatic set mobileHA(value: boolean) {\r\n\t\tif (isBoolean(value)) {\r\n\t\t\tmobileHA = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get minFrameTime(): number | false {\r\n\t\treturn minFrameTime;\r\n\t}\r\n\r\n\tstatic get promise(): boolean {\r\n\t\treturn promise;\r\n\t}\r\n\tstatic set promise(value: boolean) {\r\n\t\tvalue = validatePromise(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tpromise = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get promiseRejectEmpty(): boolean {\r\n\t\treturn promiseRejectEmpty;\r\n\t}\r\n\tstatic set promiseRejectEmpty(value: boolean) {\r\n\t\tvalue = validatePromiseRejectEmpty(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tpromiseRejectEmpty = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get queue(): string | false {\r\n\t\treturn queue;\r\n\t}\r\n\tstatic set queue(value: string | false) {\r\n\t\tvalue = validateQueue(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tqueue = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get repeat(): number | true {\r\n\t\treturn repeat;\r\n\t}\r\n\tstatic set repeat(value: number | true) {\r\n\t\tvalue = validateRepeat(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\trepeat = value;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get repeatAgain(): number | true {\r\n\t\treturn repeat;\r\n\t}\r\n\r\n\tstatic get speed(): number {\r\n\t\treturn speed;\r\n\t}\r\n\tstatic set speed(value: number) {\r\n\t\tvalue = validateSpeed(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tspeed = value;\r\n\t\t}\r\n\t}\r\n\tstatic get sync(): boolean {\r\n\t\treturn sync;\r\n\t}\r\n\tstatic set sync(value: boolean) {\r\n\t\tvalue = validateSync(value);\r\n\t\tif (value !== undefined) {\r\n\t\t\tsync = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObject.freeze(defaults);\r\n\r\n// Reset to our default values, currently everything is undefined.\r\ndefaults.reset();\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Normalisations are used when getting or setting a (normally css compound\r\n * properties) value that can have a different order in different browsers.\r\n *\r\n * It can also be used to extend and create specific properties that otherwise\r\n * don't exist (such as for scrolling, or inner/outer dimensions).\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n/**\r\n * The highest type index for finding the best normalization for a property.\r\n */\r\nexport let MaxType: number = -1;\r\n\r\n/**\r\n * Unlike \"actions\", normalizations can always be replaced by users.\r\n */\r\nexport const Normalizations: {[name: string]: VelocityNormalizationsFn}[] = [];\r\n\r\n/**\r\n * Store a cross-reference to units to be added to specific normalization\r\n * functions if the user supplies a unit-less number.\r\n *\r\n * This is pretty much confined to adding \"px\" to several css properties.\r\n */\r\nexport const NormalizationUnits: {[unit: string]: VelocityNormalizationsFn[]} = {};\r\n\r\n/**\r\n * Any normalisations that should never be cached are listed here.\r\n * Faster than an array - https://jsperf.com/array-includes-and-find-methods-vs-set-has\r\n */\r\nexport const NoCacheNormalizations = new Set<string>();\r\n\r\n/**\r\n * Used to define a constructor.\r\n */\r\nexport interface ClassConstructor {\r\n\tnew(): object;\r\n}\r\n\r\n/**\r\n * An array of classes used for the per-class normalizations. This\r\n * translates into a bitwise enum for quick cross-reference, and so that\r\n * the element doesn't need multiple <code>instanceof</code> calls every\r\n * frame.\r\n */\r\nexport const constructors: (ClassConstructor | string)[] = [];\r\n\r\n/**\r\n * A cache of the various constructors we've found and mapping to their real\r\n * name - saves expensive lookups.\r\n */\r\nexport const constructorCache = new Map<ClassConstructor, ClassConstructor | string>();\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {ElementData, HTMLorSVGElement} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {isString} from \"../types\";\r\nimport {constructors} from \"./normalizations/normalizationsObject\";\r\n\r\n// Constants\r\nconst dataName = \"velocityData\";\r\n\r\n/**\r\n * Get (and create) the internal data store for an element.\r\n */\r\nexport function Data(element: HTMLorSVGElement): ElementData {\r\n\t// Use a string member so Uglify doesn't mangle it.\r\n\tconst data = element[dataName];\r\n\r\n\tif (data) {\r\n\t\treturn data;\r\n\t}\r\n\tconst window = element.ownerDocument.defaultView;\r\n\tlet types = 0;\r\n\r\n\tfor (let index = 0; index < constructors.length; index++) {\r\n\t\tconst constructor = constructors[index];\r\n\r\n\t\tif (isString(constructor)) {\r\n\t\t\tif (element instanceof window[constructor]) {\r\n\t\t\t\ttypes |= 1 << index; // tslint:disable-line:no-bitwise\r\n\t\t\t}\r\n\t\t} else if (element instanceof constructor) {\r\n\t\t\ttypes |= 1 << index; // tslint:disable-line:no-bitwise\r\n\t\t}\r\n\t}\r\n\t// Use an intermediate object so it errors on incorrect data.\r\n\tconst newData: ElementData = {\r\n\t\ttypes,\r\n\t\tcount: 0,\r\n\t\tcomputedStyle: null,\r\n\t\tcache: {} as any,\r\n\t\tqueueList: {},\r\n\t\tlastAnimationList: {},\r\n\t\tlastFinishList: {},\r\n\t\twindow,\r\n\t};\r\n\r\n\tObject.defineProperty(element, dataName, {\r\n\t\tvalue: newData,\r\n\t});\r\n\r\n\treturn newData;\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityState} from \"../../velocity.d\";\r\n\r\n// Constants\r\nimport {CLASSNAME} from \"../constants\";\r\n\r\nconst isClient = window && window === window.window,\r\n\twindowScrollAnchor = isClient && window.pageYOffset !== undefined;\r\n\r\nexport const State: VelocityState = {\r\n\tisClient,\r\n\tisMobile: isClient && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),\r\n\tisGingerbread: isClient && /Android 2\\.3\\.[3-7]/i.test(navigator.userAgent),\r\n\tprefixElement: isClient && document.createElement(\"div\"),\r\n\twindowScrollAnchor,\r\n\tscrollAnchor: windowScrollAnchor ? window : (!isClient || document.documentElement || document.body.parentNode || document.body),\r\n\tscrollPropertyLeft: windowScrollAnchor ? \"pageXOffset\" : \"scrollLeft\",\r\n\tscrollPropertyTop: windowScrollAnchor ? \"pageYOffset\" : \"scrollTop\",\r\n\tclassName: CLASSNAME,\r\n\tisTicking: false,\r\n\tfirst: undefined,\r\n\tlast: undefined,\r\n\tfirstNew: undefined,\r\n};\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * AnimationCall queue\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, HTMLorSVGElement} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {isString} from \"../types\";\r\nimport {addClass} from \"../utility\";\r\nimport {Data} from \"./data\";\r\nimport {State} from \"./state\";\r\n\r\n/**\r\n * Simple queue management. Un-named queue is directly within the element data,\r\n * named queue is within an object within it.\r\n */\r\nfunction animate(animation: AnimationCall) {\r\n\tconst prev = State.last;\r\n\r\n\tanimation._prev = prev;\r\n\tanimation._next = undefined;\r\n\tif (prev) {\r\n\t\tprev._next = animation;\r\n\t} else {\r\n\t\tState.first = animation;\r\n\t}\r\n\tState.last = animation;\r\n\tif (!State.firstNew) {\r\n\t\tState.firstNew = animation;\r\n\t}\r\n\tconst element = animation.element,\r\n\t\tdata = Data(element);\r\n\r\n\tif (!data.count++) {\r\n\r\n\t\t////////////////////////\r\n\t\t// Feature: Classname //\r\n\t\t////////////////////////\r\n\r\n\t\taddClass(element, State.className);\r\n\t}\r\n}\r\n\r\n/**\r\n * Add an item to an animation queue.\r\n */\r\nexport function queue(element: HTMLorSVGElement, animation: AnimationCall, queueName: string | false): void {\r\n\tconst data = Data(element);\r\n\r\n\tif (queueName !== false) {\r\n\t\t// Store the last animation added so we can use it for the\r\n\t\t// beginning of the next one.\r\n\t\tdata.lastAnimationList[queueName] = animation;\r\n\t}\r\n\tif (queueName === false) {\r\n\t\tanimate(animation);\r\n\t} else {\r\n\t\tif (!isString(queueName)) {\r\n\t\t\tqueueName = \"\";\r\n\t\t}\r\n\t\tlet last = data.queueList[queueName];\r\n\r\n\t\tif (!last) {\r\n\t\t\tif (last === null) {\r\n\t\t\t\tdata.queueList[queueName] = animation;\r\n\t\t\t} else {\r\n\t\t\t\tdata.queueList[queueName] = null;\r\n\t\t\t\tanimate(animation);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twhile (last._next) {\r\n\t\t\t\tlast = last._next;\r\n\t\t\t}\r\n\t\t\tlast._next = animation;\r\n\t\t\tanimation._prev = last;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Start the next animation on this element's queue (named or default).\r\n *\r\n * @returns the next animation that is starting.\r\n */\r\nexport function dequeue(element: HTMLorSVGElement, queueName?: string | boolean, skip?: boolean): AnimationCall {\r\n\tif (queueName !== false) {\r\n\t\tif (!isString(queueName)) {\r\n\t\t\tqueueName = \"\";\r\n\t\t}\r\n\t\tconst data = Data(element),\r\n\t\t\tanimation = data.queueList[queueName];\r\n\r\n\t\tif (animation) {\r\n\t\t\tdata.queueList[queueName] = animation._next || null;\r\n\t\t\tif (!skip) {\r\n\t\t\t\tanimate(animation);\r\n\t\t\t}\r\n\t\t} else if (animation === null) {\r\n\t\t\tdelete data.queueList[queueName];\r\n\t\t}\r\n\r\n\t\treturn animation;\r\n\t}\r\n}\r\n\r\n/**\r\n * Remove an animation from the active animation list. If it has a queue set\r\n * then remember it as the last animation for that queue, and free the one\r\n * that was previously there. If the animation list is completely empty then\r\n * mark us as finished.\r\n */\r\nexport function freeAnimationCall(animation: AnimationCall): void {\r\n\tconst next = animation._next,\r\n\t\tprev = animation._prev,\r\n\t\tqueueName = animation.queue == null ? animation.options.queue : animation.queue;\r\n\r\n\tif (State.firstNew === animation) {\r\n\t\tState.firstNew = next;\r\n\t}\r\n\tif (State.first === animation) {\r\n\t\tState.first = next;\r\n\t} else if (prev) {\r\n\t\tprev._next = next;\r\n\t}\r\n\tif (State.last === animation) {\r\n\t\tState.last = prev;\r\n\t} else if (next) {\r\n\t\tnext._prev = prev;\r\n\t}\r\n\tif (queueName) {\r\n\t\tconst data = Data(animation.element);\r\n\r\n\t\tif (data) {\r\n\t\t\tanimation._next = animation._prev = undefined;\r\n\t\t}\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {SequenceList} from \"../../velocity.d\";\r\n\r\nexport const SequencesObject: {[name: string]: SequenceList} = {};\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Call Completion\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, AnimationFlags} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {getValue, removeClass} from \"../utility\";\r\nimport {Data} from \"./data\";\r\nimport {defaults} from \"./defaults\";\r\nimport {dequeue, freeAnimationCall} from \"./queue\";\r\nimport {State} from \"./state\";\r\n\r\n/**\r\n * Call the complete method of an animation in a separate function so it can\r\n * benefit from JIT compiling while still having a try/catch block.\r\n */\r\nfunction callComplete(activeCall: AnimationCall) {\r\n\tconst callback = activeCall.complete || activeCall.options.complete;\r\n\r\n\tif (callback) {\r\n\t\ttry {\r\n\t\t\tconst elements = activeCall.elements;\r\n\r\n\t\t\tcallback.call(elements, elements, activeCall);\r\n\t\t} catch (error) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthrow error;\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Complete an animation. This might involve restarting (for loop or repeat\r\n * options). Once it is finished we also check for any callbacks or Promises\r\n * that need updating.\r\n */\r\nexport function completeCall(activeCall: AnimationCall) {\r\n\t// TODO: Check if it's not been completed already\r\n\tconst options = activeCall.options,\r\n\t\tqueue = getValue(activeCall.queue, options.queue),\r\n\t\tisLoop = getValue(activeCall.loop, options.loop, defaults.loop),\r\n\t\tisRepeat = getValue(activeCall.repeat, options.repeat, defaults.repeat),\r\n\t\tisStopped = activeCall._flags & AnimationFlags.STOPPED; // tslint:disable-line:no-bitwise\r\n\r\n\tif (!isStopped && (isLoop || isRepeat)) {\r\n\r\n\t\t////////////////////\r\n\t\t// Option: Loop   //\r\n\t\t// Option: Repeat //\r\n\t\t////////////////////\r\n\r\n\t\tif (isRepeat && isRepeat !== true) {\r\n\t\t\tactiveCall.repeat = isRepeat - 1;\r\n\t\t} else if (isLoop && isLoop !== true) {\r\n\t\t\tactiveCall.loop = isLoop - 1;\r\n\t\t\tactiveCall.repeat = getValue(activeCall.repeatAgain, options.repeatAgain, defaults.repeatAgain);\r\n\t\t}\r\n\t\tif (isLoop) {\r\n\t\t\tactiveCall._flags ^= AnimationFlags.REVERSE; // tslint:disable-line:no-bitwise\r\n\t\t}\r\n\t\tif (queue !== false) {\r\n\t\t\t// Can't be called when stopped so no need for an extra check.\r\n\t\t\tData(activeCall.element).lastFinishList[queue] = activeCall.timeStart + getValue(activeCall.duration, options.duration, defaults.duration);\r\n\t\t}\r\n\t\tactiveCall.timeStart = activeCall.ellapsedTime = activeCall.percentComplete = 0;\r\n\t\tactiveCall._flags &= ~AnimationFlags.STARTED; // tslint:disable-line:no-bitwise\r\n\t} else {\r\n\t\tconst element = activeCall.element,\r\n\t\t\tdata = Data(element);\r\n\r\n\t\tif (!--data.count && !isStopped) {\r\n\r\n\t\t\t////////////////////////\r\n\t\t\t// Feature: Classname //\r\n\t\t\t////////////////////////\r\n\r\n\t\t\tremoveClass(element, State.className);\r\n\t\t}\r\n\r\n\t\t//////////////////////\r\n\t\t// Option: Complete //\r\n\t\t//////////////////////\r\n\r\n\t\t// If this is the last animation in this list then we can check for\r\n\t\t// and complete calls or Promises.\r\n\t\t// TODO: When deleting an element we need to adjust these values.\r\n\t\tif (options && ++options._completed === options._total) {\r\n\t\t\tif (!isStopped && options.complete) {\r\n\t\t\t\t// We don't call the complete if the animation is stopped,\r\n\t\t\t\t// and we clear the key to prevent it being called again.\r\n\t\t\t\tcallComplete(activeCall);\r\n\t\t\t\toptions.complete = null;\r\n\t\t\t}\r\n\t\t\tconst resolver = options._resolver;\r\n\r\n\t\t\tif (resolver) {\r\n\t\t\t\t// Fulfil the Promise\r\n\t\t\t\tresolver(activeCall.elements as any);\r\n\t\t\t\tdelete options._resolver;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t///////////////////\r\n\t\t// Option: Queue //\r\n\t\t///////////////////\r\n\r\n\t\tif (queue !== false) {\r\n\t\t\t// We only do clever things with queues...\r\n\t\t\tif (!isStopped) {\r\n\t\t\t\t// If we're not stopping an animation, we need to remember\r\n\t\t\t\t// what time it finished so that the next animation in\r\n\t\t\t\t// sequence gets the correct start time.\r\n\t\t\t\tdata.lastFinishList[queue] = activeCall.timeStart + getValue(activeCall.duration, options.duration, defaults.duration);\r\n\t\t\t}\r\n\t\t\t// Start the next animation in sequence, or delete the queue if\r\n\t\t\t// this was the last one.\r\n\t\t\tdequeue(element, queue);\r\n\t\t}\r\n\t\t// Cleanup any pointers, and remember the last animation etc.\r\n\t\tfreeAnimationCall(activeCall);\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Normalisations are used when getting or setting a (normally css compound\r\n * properties) value that can have a different order in different browsers.\r\n *\r\n * It can also be used to extend and create specific properties that otherwise\r\n * don't exist (such as for scrolling, or inner/outer dimensions).\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isFunction, isString} from \"../../types\";\r\nimport {registerAction} from \"../actions/actions\";\r\nimport {Data} from \"../data\";\r\nimport {ClassConstructor, constructorCache, constructors, NoCacheNormalizations, Normalizations, NormalizationUnits} from \"./normalizationsObject\";\r\n\r\n/**\r\n * Used to register a normalization. This should never be called by users\r\n * directly, instead it should be called via an action:<br/>\r\n * <code>Velocity(\"registerNormalization\", \"Element\", \"name\", VelocityNormalizationsFn[, false]);</code>\r\n *\r\n * The second argument is the class of the animatable object. If this is passed\r\n * as a class name (ie, `\"Element\"` -> `window[\"Element\"]`) then this will work\r\n * cross-iframe. If passed as an actual class (ie `Element`) then it will\r\n * attempt to find the class on the window and use that name instead. If it\r\n * can't find it then it will use the class passed, which allows for custom\r\n * animation targets, but will not work cross-iframe boundary.\r\n *\r\n * The fourth argument can be an explicit <code>false</code>, which prevents\r\n * the property from being cached. Please note that this can be dangerous\r\n * for performance!\r\n */\r\nexport function registerNormalization(\r\n\targs?: [ClassConstructor | string, string, VelocityNormalizationsFn]\r\n\t\t| [ClassConstructor | string, string, VelocityNormalizationsFn, boolean]\r\n\t\t| [ClassConstructor | string, string, VelocityNormalizationsFn, string]\r\n\t\t| [ClassConstructor | string, string, VelocityNormalizationsFn, string, boolean]) {\r\n\tconst constructor = args[0],\r\n\t\tname: string = args[1],\r\n\t\tcallback = args[2];\r\n\r\n\tif ((isString(constructor) && !(window[constructor] instanceof Object))\r\n\t\t|| (!isString(constructor) && !(constructor instanceof Object))) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerNormalization' constructor to an invalid value:`, constructor);\r\n\t} else if (!isString(name)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerNormalization' name to an invalid value:`, name);\r\n\t} else if (!isFunction(callback)) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set 'registerNormalization' callback to an invalid value:`, name, callback);\r\n\t} else {\r\n\t\tlet index = constructors.indexOf(constructor),\r\n\t\t\tnextArg = 3;\r\n\r\n\t\tif (index < 0 && !isString(constructor)) {\r\n\t\t\tif (constructorCache.has(constructor)) {\r\n\t\t\t\tindex = constructors.indexOf(constructorCache.get(constructor));\r\n\t\t\t} else {\r\n\t\t\t\tfor (const property in window) {\r\n\t\t\t\t\tif (window[property] === constructor) {\r\n\t\t\t\t\t\tindex = constructors.indexOf(property);\r\n\t\t\t\t\t\tif (index < 0) {\r\n\t\t\t\t\t\t\tindex = constructors.push(property) - 1;\r\n\t\t\t\t\t\t\tNormalizations[index] = {};\r\n\t\t\t\t\t\t\tconstructorCache.set(constructor, property);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (index < 0) {\r\n\t\t\tindex = constructors.push(constructor) - 1;\r\n\t\t\tNormalizations[index] = {};\r\n\t\t}\r\n\t\tNormalizations[index][name] = callback;\r\n\t\tif (isString(args[nextArg])) {\r\n\t\t\tconst unit = args[nextArg++] as string;\r\n\t\t\tlet units = NormalizationUnits[unit];\r\n\r\n\t\t\tif (!units) {\r\n\t\t\t\tunits = NormalizationUnits[unit] = [];\r\n\t\t\t}\r\n\t\t\tunits.push(callback);\r\n\t\t}\r\n\t\tif (args[nextArg] === false) {\r\n\t\t\tNoCacheNormalizations.add(name);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Used to check if a normalisation exists on a specific class.\r\n */\r\nexport function hasNormalization(args?: [ClassConstructor | string, string]): boolean {\r\n\tconst constructor = args[0],\r\n\t\tname: string = args[1];\r\n\tlet index = constructors.indexOf(constructor);\r\n\r\n\tif (index < 0 && !isString(constructor)) {\r\n\t\tif (constructorCache.has(constructor)) {\r\n\t\t\tindex = constructors.indexOf(constructorCache.get(constructor));\r\n\t\t} else {\r\n\t\t\tfor (const property in window) {\r\n\t\t\t\tif (window[property] === constructor) {\r\n\t\t\t\t\tindex = constructors.indexOf(property);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn index >= 0 && Normalizations[index].hasOwnProperty(name);\r\n}\r\n\r\n/**\r\n * Get the unit to add to a unitless number based on the normalization used.\r\n */\r\nexport function getNormalizationUnit(fn: VelocityNormalizationsFn) {\r\n\tfor (const unit in NormalizationUnits) {\r\n\t\tif (NormalizationUnits[unit].includes(fn)) {\r\n\t\t\treturn unit;\r\n\t\t}\r\n\t}\r\n\r\n\treturn \"\";\r\n}\r\n\r\n/**\r\n * Get the normalization for an element and propertyName combination. This\r\n * value should be cached at asking time, as it may change if the user adds\r\n * more normalizations.\r\n */\r\nexport function getNormalization(element: HTMLorSVGElement, propertyName: string) {\r\n\tconst data = Data(element);\r\n\tlet fn: VelocityNormalizationsFn;\r\n\r\n\tfor (let index = constructors.length - 1, types = data.types; !fn && index >= 0; index--) {\r\n\t\tif (types & (1 << index)) { // tslint:disable-line:no-bitwise\r\n\t\t\tfn = Normalizations[index][propertyName];\r\n\t\t}\r\n\t}\r\n\r\n\treturn fn;\r\n}\r\n\r\nregisterAction([\"registerNormalization\", registerNormalization]);\r\nregisterAction([\"hasNormalization\", hasNormalization]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport Velocity from \"../../velocity\";\r\nimport {Data} from \"../data\";\r\nimport {getNormalization} from \"../normalizations/normalizations\";\r\nimport {NoCacheNormalizations} from \"../normalizations/normalizationsObject\";\r\n\r\n/**\r\n * The singular setPropertyValue, which routes the logic for all\r\n * normalizations.\r\n */\r\nexport function setPropertyValue(element: HTMLorSVGElement, propertyName: string, propertyValue: any, fn?: VelocityNormalizationsFn) {\r\n\tconst noCache = NoCacheNormalizations.has(propertyName),\r\n\t\tdata = !noCache && Data(element);\r\n\r\n\tif (noCache || (data && data.cache[propertyName] !== propertyValue)) {\r\n\t\t// By setting it to undefined we force a true \"get\" later\r\n\t\tif (!noCache) {\r\n\t\t\tdata.cache[propertyName] = propertyValue || undefined;\r\n\t\t}\r\n\t\tfn = fn || getNormalization(element, propertyName);\r\n\t\tif (fn) {\r\n\t\t\tfn(element, propertyValue);\r\n\t\t}\r\n\t\tif (Velocity.debug >= 2) {\r\n\t\t\tconsole.info(`Set \"${propertyName}\": \"${propertyValue}\"`, element);\r\n\t\t}\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n/**\r\n * Cache every camelCase match to avoid repeating lookups.\r\n */\r\nconst cache: {[property: string]: string} = {};\r\n\r\n/**\r\n * Camelcase a property name into its JavaScript notation (e.g.\r\n * \"background-color\" ==> \"backgroundColor\"). Camelcasing is used to\r\n * normalize property names between and across calls.\r\n */\r\nexport function camelCase(property: string): string {\r\n\tconst fixed = cache[property];\r\n\r\n\tif (fixed) {\r\n\t\treturn fixed;\r\n\t}\r\n\r\n\treturn cache[property] = property.replace(/-([a-z])/g, ($: string, letter: string) => letter.toUpperCase());\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Constants\r\nconst rxColor6 = /#([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})/gi,\r\n\trxColor3 = /#([a-f\\d])([a-f\\d])([a-f\\d])/gi,\r\n\trxColorName = /(rgba?\\(\\s*)?(\\b[a-z]+\\b)/g,\r\n\trxRGB = /rgb(a?)\\(([^\\)]+)\\)/gi,\r\n\trxSpaces = /\\s+/g;\r\n\r\n/**\r\n * This is the list of color names -> rgb values. The object is in here so\r\n * that the actual name conversion can be in a separate file and not\r\n * included for custom builds.\r\n */\r\nexport const ColorNames: {[name: string]: string} = {};\r\n\r\n/**\r\n * Convert a hex list to an rgba value. Designed to be used in replace.\r\n */\r\nfunction makeRGBA(ignore: any, r: string, g: string, b: string): string {\r\n\treturn `rgba(${parseInt(r, 16)},${parseInt(g, 16)},${parseInt(b, 16)},1)`;\r\n}\r\n\r\n/**\r\n * Replace any css colour name with its rgba() value. It is possible to use\r\n * the name within an \"rgba(blue, 0.4)\" string this way.\r\n */\r\nexport function fixColors(str: string): string {\r\n\treturn str\r\n\t\t.replace(rxColor6, makeRGBA)\r\n\t\t.replace(rxColor3, ($0, r, g, b) => {\r\n\t\t\treturn makeRGBA($0, r + r, g + g, b + b);\r\n\t\t})\r\n\t\t.replace(rxColorName, ($0, $1, $2) => {\r\n\t\t\tif (ColorNames[$2]) {\r\n\t\t\t\treturn ($1 ? $1 : \"rgba(\") + ColorNames[$2] + ($1 ? \"\" : \",1)\");\r\n\t\t\t}\r\n\r\n\t\t\treturn $0;\r\n\t\t})\r\n\t\t.replace(rxRGB, ($0, $1, $2: string) => {\r\n\t\t\treturn `rgba(${$2.replace(rxSpaces, \"\") + ($1 ? \"\" : \",1\")})`;\r\n\t\t});\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {getPropertyValue} from \"./getPropertyValue\";\r\n\r\n/**\r\n * Figure out the dimensions for this width / height based on the\r\n * potential borders and whether we care about them.\r\n */\r\nexport function augmentDimension(element: HTMLorSVGElement, name: \"width\" | \"height\", wantInner: boolean): number {\r\n\tconst isBorderBox = getPropertyValue(element, \"boxSizing\")\r\n\t\t.toString()\r\n\t\t.toLowerCase() === \"border-box\";\r\n\r\n\tif (isBorderBox === wantInner) {\r\n\t\t// in box-sizing mode, the CSS width / height accessors already\r\n\t\t// give the outerWidth / outerHeight.\r\n\t\tconst sides = name === \"width\" ? [\"Left\", \"Right\"] : [\"Top\", \"Bottom\"],\r\n\t\t\tfields = [`padding${sides[0]}`, `padding${sides[1]}`, `border${sides[0]}Width`, `border${sides[1]}Width`];\r\n\t\tlet augment = 0;\r\n\r\n\t\tfor (const field of fields) {\r\n\t\t\tconst value = parseFloat(getPropertyValue(element, field));\r\n\r\n\t\t\tif (!isNaN(value)) {\r\n\t\t\t\taugment += value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn wantInner ? -augment : augment;\r\n\t}\r\n\r\n\treturn 0;\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport Velocity from \"../../velocity\";\r\nimport {Data} from \"../data\";\r\nimport {getNormalization} from \"../normalizations/normalizations\";\r\nimport {NoCacheNormalizations} from \"../normalizations/normalizationsObject\";\r\nimport {augmentDimension} from \"./augmentDimension\";\r\nimport {setPropertyValue} from \"./setPropertyValue\";\r\n\r\n/**\r\n * Get the width or height of an element, pulled out as it can be used when the\r\n * in two locations so don't want to repeat it.\r\n */\r\nfunction getWidthHeight(element: HTMLorSVGElement, property: \"width\" | \"height\"): string {\r\n\treturn (element.getBoundingClientRect()[property] + augmentDimension(element, property, true)) + \"px\";\r\n}\r\n\r\n// TODO: This is still a complete mess\r\nexport function computePropertyValue(element: HTMLorSVGElement, property: string): string {\r\n\tconst data = Data(element),\r\n\t\t// If computedStyle is cached, use it. If not then get the correct one\r\n\t\t// for the element to support cross-iframe boundaries.\r\n\t\tcomputedStyle = data.computedStyle ? data.computedStyle : data.window.getComputedStyle(element, null);\r\n\tlet computedValue: string | number = 0;\r\n\r\n\tif (!data.computedStyle) {\r\n\t\tdata.computedStyle = computedStyle;\r\n\t}\r\n\tif (computedStyle[\"display\"] === \"none\") {\r\n\t\tswitch (property) {\r\n\t\t\tcase \"width\":\r\n\t\t\tcase \"height\":\r\n\t\t\t\t// Browsers do not return height and width values for elements\r\n\t\t\t\t// that are set to display:\"none\". Thus, we temporarily toggle\r\n\t\t\t\t// display to the element type's default value.\r\n\t\t\t\tsetPropertyValue(element, \"display\", \"auto\");\r\n\t\t\t\tcomputedValue = getWidthHeight(element, property);\r\n\t\t\t\tsetPropertyValue(element, \"display\", \"none\");\r\n\r\n\t\t\t\treturn String(computedValue);\r\n\t\t}\r\n\t}\r\n\r\n\t/* IE and Firefox do not return a value for the generic borderColor -- they only return individual values for each border side's color.\r\n\t Also, in all browsers, when border colors aren't all the same, a compound value is returned that Velocity isn't setup to parse.\r\n\t So, as a polyfill for querying individual border side colors, we just return the top border's color and animate all borders from that value. */\r\n\t/* TODO: There is a borderColor normalisation in legacy/ - figure out where this is needed... */\r\n\r\n\tcomputedValue = computedStyle[property];\r\n\t/* Fall back to the property's style value (if defined) when computedValue returns nothing,\r\n\t which can happen when the element hasn't been painted. */\r\n\tif (!computedValue) {\r\n\t\tcomputedValue = element.style[property];\r\n\t}\r\n\t/* For top, right, bottom, and left (TRBL) values that are set to \"auto\" on elements of \"fixed\" or \"absolute\" position,\r\n\t defer to jQuery for converting \"auto\" to a numeric value. (For elements with a \"static\" or \"relative\" position, \"auto\" has the same\r\n\t effect as being set to 0, so no conversion is necessary.) */\r\n\t/* An example of why numeric conversion is necessary: When an element with \"position:absolute\" has an untouched \"left\"\r\n\t property, which reverts to \"auto\", left's value is 0 relative to its parent element, but is often non-zero relative\r\n\t to its *containing* (not parent) element, which is the nearest \"position:relative\" ancestor or the viewport (and always the viewport in the case of \"position:fixed\"). */\r\n\tif (computedValue === \"auto\") {\r\n\t\tswitch (property) {\r\n\t\t\tcase \"width\":\r\n\t\t\tcase \"height\":\r\n\t\t\t\tcomputedValue = getWidthHeight(element, property);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"top\":\r\n\t\t\tcase \"left\":\r\n\t\t\t\tconst topLeft = true;\r\n\t\t\tcase \"right\":\r\n\t\t\tcase \"bottom\":\r\n\t\t\t\tconst position = getPropertyValue(element, \"position\");\r\n\r\n\t\t\t\tif (position === \"fixed\" || (topLeft && position === \"absolute\")) {\r\n\t\t\t\t\t// Note: this has no pixel unit on its returned values,\r\n\t\t\t\t\t// we re-add it here to conform with\r\n\t\t\t\t\t// computePropertyValue's behavior.\r\n\t\t\t\t\tcomputedValue = element.getBoundingClientRect[property] + \"px\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t// Deliberate fallthrough!\r\n\t\t\tdefault:\r\n\t\t\t\tcomputedValue = \"0px\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\treturn computedValue ? String(computedValue) : \"\";\r\n}\r\n\r\n/**\r\n * Get a property value. This will grab via the cache if it exists, then\r\n * via any normalisations.\r\n */\r\nexport function getPropertyValue(element: HTMLorSVGElement, propertyName: string, fn?: VelocityNormalizationsFn, skipCache?: boolean): string {\r\n\tconst data = Data(element);\r\n\tlet propertyValue: string;\r\n\r\n\tif (NoCacheNormalizations.has(propertyName)) {\r\n\t\tskipCache = true;\r\n\t}\r\n\tif (!skipCache && data && data.cache[propertyName] != null) {\r\n\t\tpropertyValue = data.cache[propertyName];\r\n\t} else {\r\n\t\tfn = fn || getNormalization(element, propertyName);\r\n\t\tif (fn) {\r\n\t\t\tpropertyValue = fn(element);\r\n\t\t\tif (data) {\r\n\t\t\t\tdata.cache[propertyName] = propertyValue;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (Velocity.debug >= 2) {\r\n\t\tconsole.info(`Get \"${propertyName}\": \"${propertyValue}\"`, element);\r\n\t}\r\n\r\n\treturn propertyValue;\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Tweens\r\n */\r\n\r\n// Typedefs\r\nimport {\r\n\tAnimationCall, AnimationFlags, HTMLorSVGElement, Properties, Sequence,\r\n\tVelocityProperty, VelocityPropertyFn, VelocityPropertyValueFn, VelocityResult, VelocityTween,\r\n} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {isFunction, isNumber, isString} from \"../types\";\r\nimport {cloneArray, getValue} from \"../utility\";\r\nimport Velocity from \"../velocity\";\r\nimport {camelCase} from \"./camelCase\";\r\nimport {fixColors} from \"./css/fixColors\";\r\nimport {getPropertyValue} from \"./css/getPropertyValue\";\r\nimport {Data} from \"./data\";\r\nimport {defaults} from \"./defaults\";\r\nimport {Easings} from \"./easing/easings\";\r\nimport {getNormalization, getNormalizationUnit} from \"./normalizations/normalizations\";\r\nimport {validateEasing} from \"./options\";\r\nimport {State} from \"./state\";\r\n\r\n// Constants\r\nconst rxHex = /^#([A-f\\d]{3}){1,2}$/i,\r\n\tcommands: {\r\n\t\t[type: string]: (\r\n\t\t\tvalue: any,\r\n\t\t\telement: HTMLorSVGElement,\r\n\t\t\telements: VelocityResult,\r\n\t\t\telementArrayIndex: number,\r\n\t\t\tpropertyName: string,\r\n\t\t\ttween: VelocityTween) => string;\r\n\t} = {\r\n\t\tfunction: (value, element, elements, elementArrayIndex, propertyName, tween) => {\r\n\t\t\treturn (value as any as VelocityPropertyValueFn).call(element, elementArrayIndex, elements.length, propertyName);\r\n\t\t},\r\n\t\tnumber: (value, element, elements, elementArrayIndex, propertyName, tween) => {\r\n\t\t\treturn String(value) + getNormalizationUnit(tween.fn);\r\n\t\t},\r\n\t\tstring: (value, element, elements, elementArrayIndex, propertyName, tween) => {\r\n\t\t\treturn fixColors(value);\r\n\t\t},\r\n\t\tundefined: (value, element, elements, elementArrayIndex, propertyName, tween) => {\r\n\t\t\treturn fixColors(getPropertyValue(element, propertyName, tween.fn) || \"\");\r\n\t\t},\r\n\t};\r\n\r\n/**\r\n * Expand a VelocityProperty argument into a valid sparse Tween array. This\r\n * pre-allocates the array as it is then the correct size and slightly\r\n * faster to access.\r\n */\r\nexport function expandProperties(animation: AnimationCall, properties: Properties<VelocityProperty>) {\r\n\tconst tweens = animation.tweens = Object.create(null),\r\n\t\telements = animation.elements,\r\n\t\telement = animation.element,\r\n\t\telementArrayIndex = elements.indexOf(element as any),\r\n\t\tdata = Data(element),\r\n\t\tqueue = getValue(animation.queue, animation.options.queue),\r\n\t\tduration = getValue(animation.options.duration, defaults.duration);\r\n\r\n\tfor (const property in properties) {\r\n\t\tif (properties.hasOwnProperty(property)) {\r\n\t\t\tconst propertyName = camelCase(property),\r\n\t\t\t\tfn = getNormalization(element, propertyName);\r\n\t\t\tlet valueData = properties[property];\r\n\r\n\t\t\tif (!fn && propertyName !== \"tween\") {\r\n\t\t\t\tif (Velocity.debug) {\r\n\t\t\t\t\tconsole.log(`Skipping \"${property}\" due to a lack of browser support.`);\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (valueData == null) {\r\n\t\t\t\tif (Velocity.debug) {\r\n\t\t\t\t\tconsole.log(`Skipping \"${property}\" due to no value supplied.`);\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst tween: VelocityTween = tweens[propertyName] = {} as any;\r\n\t\t\tlet endValue: string,\r\n\t\t\t\tstartValue: string;\r\n\r\n\t\t\ttween.fn = fn;\r\n\t\t\tif (isFunction(valueData)) {\r\n\t\t\t\t// If we have a function as the main argument then resolve\r\n\t\t\t\t// it first, in case it returns an array that needs to be\r\n\t\t\t\t// split.\r\n\t\t\t\tvalueData = (valueData as VelocityPropertyFn).call(element, elementArrayIndex, elements.length, elements);\r\n\t\t\t}\r\n\t\t\tif (Array.isArray(valueData)) {\r\n\t\t\t\t// valueData is an array in the form of\r\n\t\t\t\t// [ endValue, [, easing] [, startValue] ]\r\n\t\t\t\tconst arr1 = valueData[1],\r\n\t\t\t\t\tarr2 = valueData[2];\r\n\r\n\t\t\t\tendValue = valueData[0] as any;\r\n\t\t\t\tif ((isString(arr1) && (/^[\\d-]/.test(arr1) || rxHex.test(arr1))) || isFunction(arr1) || isNumber(arr1)) {\r\n\t\t\t\t\tstartValue = arr1 as any;\r\n\t\t\t\t} else if ((isString(arr1) && Easings[arr1]) || Array.isArray(arr1)) {\r\n\t\t\t\t\ttween.easing = validateEasing(arr1, duration);\r\n\t\t\t\t\tstartValue = arr2 as any;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstartValue = arr1 || arr2 as any;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tendValue = valueData as any;\r\n\t\t\t}\r\n\t\t\ttween.end = commands[typeof endValue](endValue, element, elements, elementArrayIndex, propertyName, tween) as any;\r\n\t\t\tif (startValue != null || (queue === false || data.queueList[queue] === undefined)) {\r\n\t\t\t\ttween.start = commands[typeof startValue](startValue, element, elements, elementArrayIndex, propertyName, tween) as any;\r\n\t\t\t\texplodeTween(propertyName, tween, duration);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// TODO: Needs a better match for \"translate3d\" etc - a number must be preceded by some form of break...\r\nconst rxToken = /((?:[+\\-*/]=)?(?:[+-]?\\d*\\.\\d+|[+-]?\\d+)[a-z%]*|(?:.(?!$|[+-]?\\d|[+\\-*/]=[+-]?\\d))+.|.)/g,\r\n\trxNumber = /^([+\\-*/]=)?([+-]?\\d*\\.\\d+|[+-]?\\d+)(.*)$/;\r\n\r\n/**\r\n * Find a pattern between multiple strings, return a VelocitySequence with\r\n * the pattern and the tokenised values.\r\n *\r\n * If number then animate.\r\n * If a string then must match.\r\n * If units then convert between them by wrapping in a calc().\r\n * - If already in a calc then nest another layer.\r\n * If in an rgba() then the first three numbers are rounded.\r\n */\r\nexport function findPattern(parts: ReadonlyArray<string>, propertyName: string): Sequence {\r\n\tconst partsLength = parts.length,\r\n\t\ttokens: string[][] = [],\r\n\t\tindexes: number[] = [];\r\n\tlet numbers: boolean;\r\n\r\n\t// First tokenise the strings - these have all values, we will pull\r\n\t// numbers later.\r\n\tfor (let part = 0; part < partsLength; part++) {\r\n\t\tif (isString(parts[part])) {\r\n\t\t\tif (parts[part] === \"\") {\r\n\t\t\t\ttokens[part] = [\"\"];\r\n\t\t\t} else {\r\n\t\t\t\ttokens[part] = cloneArray(parts[part].match(rxToken));\r\n\t\t\t}\r\n\t\t\tindexes[part] = 0;\r\n\t\t\t// If it matches more than one thing then we've got a number.\r\n\t\t\tnumbers = numbers || tokens[part].length > 1;\r\n\t\t\t//console.log(`tokens:`, parts[part], tokens[part])\r\n\t\t} else {\r\n\t\t\t// We have an incomplete lineup, it will get tried again later...\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tconst sequence: Sequence = [] as any,\r\n\t\tpattern = (sequence.pattern = []) as (string | boolean)[],\r\n\t\taddString = (text: string) => {\r\n\t\t\tif (isString(pattern[pattern.length - 1])) {\r\n\t\t\t\tpattern[pattern.length - 1] += text;\r\n\t\t\t} else if (text) {\r\n\t\t\t\tpattern.push(text);\r\n\t\t\t\tfor (let part = 0; part < partsLength; part++) {\r\n\t\t\t\t\t(sequence[part] as any[]).push(null);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\treturnStringType = () => {\r\n\t\t\tif (numbers || pattern.length > 1) {\r\n\t\t\t\t//console.error(`Velocity: Trying to pattern match mis-matched strings \"${propertyName}\":`, parts);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst isDisplay = propertyName === \"display\",\r\n\t\t\t\tisVisibility = propertyName === \"visibility\";\r\n\r\n\t\t\tfor (let part = 0; part < partsLength; part++) {\r\n\t\t\t\tconst value = parts[part];\r\n\r\n\t\t\t\tsequence[part][0] = value;\r\n\t\t\t\t// Don't care about duration...\r\n\t\t\t\tsequence[part].easing = validateEasing((isDisplay && value === \"none\") || (isVisibility && value === \"hidden\") || (!isDisplay && !isVisibility) ? \"at-end\" : \"at-start\", 400);\r\n\t\t\t}\r\n\t\t\tpattern[0] = false;\r\n\r\n\t\t\treturn sequence;\r\n\t\t};\r\n\tlet more = true;\r\n\r\n\tfor (let part = 0; part < partsLength; part++) {\r\n\t\tsequence[part] = [];\r\n\t}\r\n\twhile (more) {\r\n\t\tconst bits: ([number, string] | [number, string, boolean])[] = [],\r\n\t\t\tunits: string[] = [];\r\n\t\tlet text: string,\r\n\t\t\tisUnitless = false,\r\n\t\t\thasNumbers = false;\r\n\r\n\t\tfor (let part = 0; part < partsLength; part++) {\r\n\t\t\tconst index = indexes[part]++,\r\n\t\t\t\ttoken = tokens[part][index];\r\n\r\n\t\t\tif (token) {\r\n\t\t\t\tconst num = token.match(rxNumber); // [ignore, change, number, unit]\r\n\r\n\t\t\t\tif (num) {\r\n\t\t\t\t\t// It's a number, possibly with a += change and unit.\r\n\t\t\t\t\tif (text) {\r\n\t\t\t\t\t\treturn returnStringType();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst digits = parseFloat(num[2]),\r\n\t\t\t\t\t\tunit = num[3],\r\n\t\t\t\t\t\tchange = num[1] ? num[1][0] + unit : undefined,\r\n\t\t\t\t\t\tchangeOrUnit = change || unit;\r\n\r\n\t\t\t\t\tif (digits && !units.includes(changeOrUnit)) {\r\n\t\t\t\t\t\t// Will be an empty string at the least.\r\n\t\t\t\t\t\tunits.push(changeOrUnit);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!unit) {\r\n\t\t\t\t\t\tif (digits) {\r\n\t\t\t\t\t\t\thasNumbers = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tisUnitless = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbits[part] = change ? [digits, changeOrUnit, true] : [digits, changeOrUnit];\r\n\t\t\t\t} else if (bits.length) {\r\n\t\t\t\t\treturn returnStringType();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// It's a string.\r\n\t\t\t\t\tif (!text) {\r\n\t\t\t\t\t\ttext = token;\r\n\t\t\t\t\t} else if (text !== token) {\r\n\t\t\t\t\t\treturn returnStringType();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (!part) {\r\n\t\t\t\tfor (; part < partsLength; part++) {\r\n\t\t\t\t\tconst index2 = indexes[part]++;\r\n\r\n\t\t\t\t\tif (tokens[part][index2]) {\r\n\t\t\t\t\t\treturn returnStringType();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// IMPORTANT: This is the exit point.\r\n\t\t\t\tmore = false;\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\t// Different\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (text) {\r\n\t\t\taddString(text);\r\n\t\t} else if (units.length) {\r\n\t\t\tif (units.length === 2 && isUnitless && !hasNumbers) {\r\n\t\t\t\t// If we only have two units, and one is empty, and it's only empty on \"0\", then treat us as having one unit\r\n\t\t\t\tunits.splice(units[0] ? 1 : 0, 1);\r\n\t\t\t}\r\n\t\t\tif (units.length === 1) {\r\n\t\t\t\t// All the same units, so append number then unit.\r\n\t\t\t\tconst unit = units[0],\r\n\t\t\t\t\tfirstLetter = unit[0];\r\n\r\n\t\t\t\tswitch (firstLetter) {\r\n\t\t\t\t\tcase \"+\":\r\n\t\t\t\t\tcase \"-\":\r\n\t\t\t\t\tcase \"*\":\r\n\t\t\t\t\tcase \"/\":\r\n\t\t\t\t\t\tif (propertyName) {\r\n\t\t\t\t\t\t\tconsole.error(`Velocity: The first property must not contain a relative function \"${propertyName}\":`, parts);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tpattern.push(false);\r\n\t\t\t\tfor (let part = 0; part < partsLength; part++) {\r\n\t\t\t\t\t(sequence[part] as any[]).push(bits[part][0]);\r\n\t\t\t\t}\r\n\t\t\t\taddString(unit);\r\n\t\t\t} else {\r\n\t\t\t\t// Multiple units, so must be inside a calc.\r\n\t\t\t\taddString(\"calc(\");\r\n\t\t\t\tconst patternCalc = pattern.length - 1; // Store the beginning of our calc.\r\n\r\n\t\t\t\tfor (let i = 0; i < units.length; i++) {\r\n\t\t\t\t\tconst unit = units[i],\r\n\t\t\t\t\t\tfirstLetter = unit[0],\r\n\t\t\t\t\t\tisComplex = firstLetter === \"*\" || firstLetter === \"/\",\r\n\t\t\t\t\t\tisMaths = isComplex || firstLetter === \"+\" || firstLetter === \"-\";\r\n\r\n\t\t\t\t\tif (isComplex) {\r\n\t\t\t\t\t\t// TODO: Not sure this should be done automatically!\r\n\t\t\t\t\t\tpattern[patternCalc] += \"(\";\r\n\t\t\t\t\t\taddString(\")\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (i) {\r\n\t\t\t\t\t\taddString(` ${isMaths ? firstLetter : \"+\"} `);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpattern.push(false);\r\n\t\t\t\t\tfor (let part = 0; part < partsLength; part++) {\r\n\t\t\t\t\t\tconst bit = bits[part],\r\n\t\t\t\t\t\t\tvalue = bit[1] === unit\r\n\t\t\t\t\t\t\t\t? bit[0]\r\n\t\t\t\t\t\t\t\t: bit.length === 3\r\n\t\t\t\t\t\t\t\t\t? sequence[part - 1][sequence[part - 1].length - 1]\r\n\t\t\t\t\t\t\t\t\t: isComplex ? 1 : 0;\r\n\r\n\t\t\t\t\t\t(sequence[part] as any[]).push(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddString(isMaths ? unit.substring(1) : unit);\r\n\t\t\t\t}\r\n\t\t\t\taddString(\")\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// We've got here, so a valid sequence - now check and fix RGB rounding\r\n\t// and calc() nesting...\r\n\t// TODO: Nested calc(a + calc(b + c)) -> calc(a + (b + c))\r\n\tfor (let i = 0, inRGB = 0; i < pattern.length; i++) {\r\n\t\tconst text = pattern[i];\r\n\r\n\t\tif (isString(text)) {\r\n\t\t\tif (inRGB && (text as string).indexOf(\",\") >= 0) {\r\n\t\t\t\tinRGB++;\r\n\t\t\t} else if ((text as string).indexOf(\"rgb\") >= 0) {\r\n\t\t\t\tinRGB = 1;\r\n\t\t\t}\r\n\t\t} else if (inRGB) {\r\n\t\t\tif (inRGB < 4) {\r\n\t\t\t\tpattern[i] = true;\r\n\t\t\t} else {\r\n\t\t\t\tinRGB = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn sequence;\r\n}\r\n\r\n/**\r\n * Convert a string-based tween with start and end strings, into a pattern\r\n * based tween with arrays.\r\n */\r\nfunction explodeTween(propertyName: string, tween: VelocityTween, duration: number, starting?: boolean) {\r\n\tconst startValue: string = tween.start,\r\n\t\tendValue: string = tween.end;\r\n\r\n\tif (!isString(endValue) || !isString(startValue)) {\r\n\t\treturn;\r\n\t}\r\n\tlet sequence: Sequence = findPattern([startValue, endValue], propertyName);\r\n\r\n\tif (!sequence && starting) {\r\n\t\t// This little piece will take a startValue, split out the\r\n\t\t// various numbers in it, then copy the endValue into the\r\n\t\t// startValue while replacing the numbers in it to match the\r\n\t\t// original start numbers as a repeating sequence.\r\n\t\t// Finally this function will run again with the new\r\n\t\t// startValue and a now matching pattern.\r\n\t\tconst startNumbers = startValue.match(/\\d\\.?\\d*/g) || [\"0\"],\r\n\t\t\tcount = startNumbers.length;\r\n\t\tlet index = 0;\r\n\r\n\t\tsequence = findPattern([endValue.replace(/\\d+\\.?\\d*/g, () => {\r\n\t\t\treturn startNumbers[index++ % count];\r\n\t\t}), endValue], propertyName);\r\n\t}\r\n\tif (sequence) {\r\n\t\tif (Velocity.debug) {\r\n\t\t\tconsole.log(`Velocity: Sequence found:`, sequence);\r\n\t\t}\r\n\t\tsequence[0].percent = 0;\r\n\t\tsequence[1].percent = 1;\r\n\t\ttween.sequence = sequence;\r\n\t\tswitch (tween.easing) {\r\n\t\t\tcase Easings[\"at-start\"]:\r\n\t\t\tcase Easings[\"during\"]:\r\n\t\t\tcase Easings[\"at-end\"]:\r\n\t\t\t\tsequence[0].easing = sequence[1].easing = tween.easing;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Expand all queued animations that haven't gone yet\r\n *\r\n * This will automatically expand the properties map for any recently added\r\n * animations so that the start and end values are correct.\r\n */\r\nexport function validateTweens(activeCall: AnimationCall) {\r\n\t// This might be called on an already-ready animation\r\n\tif (State.firstNew === activeCall) {\r\n\t\tState.firstNew = activeCall._next;\r\n\t}\r\n\t// Check if we're actually already ready\r\n\tif (activeCall._flags & AnimationFlags.EXPANDED) { // tslint:disable-line:no-bitwise\r\n\t\treturn;\r\n\t}\r\n\tconst element = activeCall.element,\r\n\t\ttweens = activeCall.tweens,\r\n\t\tduration = getValue(activeCall.options.duration, defaults.duration);\r\n\r\n\t// tslint:disable-next-line:forin\r\n\tfor (const propertyName in tweens) {\r\n\t\tconst tween = tweens[propertyName];\r\n\r\n\t\tif (tween.start == null) {\r\n\t\t\t// Get the start value as it's not been passed in\r\n\t\t\tconst startValue = getPropertyValue(activeCall.element, propertyName);\r\n\r\n\t\t\tif (isString(startValue)) {\r\n\t\t\t\ttween.start = fixColors(startValue) as any;\r\n\t\t\t\texplodeTween(propertyName, tween, duration, true);\r\n\t\t\t} else if (!Array.isArray(startValue)) {\r\n\t\t\t\tconsole.warn(`bad type`, tween, propertyName, startValue);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (Velocity.debug) {\r\n\t\t\tconsole.log(`tweensContainer \"${propertyName}\": ${JSON.stringify(tween)}`, element);\r\n\t\t}\r\n\t}\r\n\tactiveCall._flags |= AnimationFlags.EXPANDED; // tslint:disable-line:no-bitwise\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Tick\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, AnimationFlags, TweenStep} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {now} from \"../utility\";\r\nimport Velocity from \"../velocity\";\r\nimport {completeCall} from \"./complete\";\r\nimport {setPropertyValue} from \"./css/setPropertyValue\";\r\nimport {Data} from \"./data\";\r\nimport {defaults} from \"./defaults\";\r\nimport {linearEasing} from \"./easing/easings\";\r\nimport {freeAnimationCall} from \"./queue\";\r\nimport {State} from \"./state\";\r\nimport {validateTweens} from \"./tweens\";\r\n\r\n/**\r\n * Call the begin method of an animation in a separate function so it can\r\n * benefit from JIT compiling while still having a try/catch block.\r\n */\r\nexport function beginCall(activeCall: AnimationCall) {\r\n\tconst callback = activeCall.begin || activeCall.options.begin;\r\n\r\n\tif (callback) {\r\n\t\ttry {\r\n\t\t\tconst elements = activeCall.elements;\r\n\r\n\t\t\tcallback.call(elements, elements, activeCall);\r\n\t\t} catch (error) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthrow error;\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Call the progress method of an animation in a separate function so it can\r\n * benefit from JIT compiling while still having a try/catch block.\r\n */\r\nfunction progressCall(activeCall: AnimationCall) {\r\n\tconst callback = activeCall.progress || activeCall.options.progress;\r\n\r\n\tif (callback) {\r\n\t\ttry {\r\n\t\t\tconst elements = activeCall.elements,\r\n\t\t\t\tpercentComplete = activeCall.percentComplete,\r\n\t\t\t\toptions = activeCall.options,\r\n\t\t\t\ttweenValue = activeCall.tween;\r\n\r\n\t\t\tcallback.call(elements,\r\n\t\t\t\telements,\r\n\t\t\t\tpercentComplete,\r\n\t\t\t\tMath.max(0, activeCall.timeStart + (activeCall.duration != null ? activeCall.duration : options.duration != null ? options.duration : defaults.duration) - lastTick),\r\n\t\t\t\ttweenValue !== undefined ? tweenValue : String(percentComplete * 100),\r\n\t\t\t\tactiveCall);\r\n\t\t} catch (error) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthrow error;\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction asyncCallbacks() {\r\n\tfor (const activeCall of progressed) {\r\n\t\tprogressCall(activeCall);\r\n\t}\r\n\tprogressed.clear();\r\n\tfor (const activeCall of completed) {\r\n\t\tcompleteCall(activeCall);\r\n\t}\r\n\tcompleted.clear();\r\n}\r\n\r\n/**************\r\n Timing\r\n **************/\r\n\r\nconst FRAME_TIME = 1000 / 60,\r\n\t/**\r\n\t * Animations with a Complete callback.\r\n\t */\r\n\tcompleted = new Set<AnimationCall>(),\r\n\t/**\r\n\t * Animations with a Progress callback.\r\n\t */\r\n\tprogressed = new Set<AnimationCall>(),\r\n\t/**\r\n\t * Shim for window.performance in case it doesn't exist\r\n\t */\r\n\tperformance = (() => {\r\n\t\tconst perf = window.performance || {} as Performance;\r\n\r\n\t\tif (typeof perf.now !== \"function\") {\r\n\t\t\tconst nowOffset = perf.timing && perf.timing.navigationStart ? perf.timing.navigationStart : now();\r\n\r\n\t\t\tperf.now = () => {\r\n\t\t\t\treturn now() - nowOffset;\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn perf;\r\n\t})(),\r\n\t/**\r\n\t * Proxy function for when rAF is not available.\r\n\t *\r\n\t * This should hopefully never be used as the browsers often throttle\r\n\t * this to less than one frame per second in the background, making it\r\n\t * completely unusable.\r\n\t */\r\n\trAFProxy = (callback: FrameRequestCallback) => {\r\n\t\treturn setTimeout(callback, Math.max(0, FRAME_TIME - (performance.now() - lastTick)));\r\n\t},\r\n\t/**\r\n\t * Either requestAnimationFrame, or a shim for it.\r\n\t */\r\n\trAFShim = window.requestAnimationFrame || rAFProxy;\r\n\r\n/**\r\n * Set if we are currently inside a tick() to prevent double-calling.\r\n */\r\nlet ticking: boolean,\r\n\t/**\r\n\t * A background WebWorker that sends us framerate messages when we're in\r\n\t * the background. Without this we cannot maintain frame accuracy.\r\n\t */\r\n\tworker: Worker;\r\n\r\n/**\r\n * The time that the last animation frame ran at. Set from tick(), and used\r\n * for missing rAF (ie, when not in focus etc).\r\n */\r\nexport let lastTick: number = 0;\r\n\r\n/**\r\n * WebWorker background function.\r\n *\r\n * When we're in the background this will send us a msg every tick, when in\r\n * the foreground it won't.\r\n *\r\n * When running in the background the browser reduces allowed CPU etc, so\r\n * we raun at 30fps instead of 60fps.\r\n */\r\nfunction workerFn(this: Worker) {\r\n\tlet interval: any;\r\n\r\n\tthis.onmessage = (e) => {\r\n\t\tswitch (e.data) {\r\n\t\t\tcase true:\r\n\t\t\t\tif (!interval) {\r\n\t\t\t\t\tinterval = setInterval(() => {\r\n\t\t\t\t\t\tthis.postMessage(true);\r\n\t\t\t\t\t}, 1000 / 30);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase false:\r\n\t\t\t\tif (interval) {\r\n\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\tinterval = 0;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthis.postMessage(e.data);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n}\r\n\r\ntry {\r\n\t// Create the worker - this might not be supported, hence the try/catch.\r\n\tworker = new Worker(URL.createObjectURL(new Blob([`(${workerFn})()`])));\r\n\t// Whenever the worker sends a message we tick()\r\n\tworker.onmessage = (e: MessageEvent) => {\r\n\t\tif (e.data === true) {\r\n\t\t\ttick();\r\n\t\t} else {\r\n\t\t\tasyncCallbacks();\r\n\t\t}\r\n\t};\r\n\t// And watch for going to the background to start the WebWorker running.\r\n\tif (!State.isMobile && document.hidden !== undefined) {\r\n\t\tdocument.addEventListener(\"visibilitychange\", () => {\r\n\t\t\tworker.postMessage(State.isTicking && document.hidden);\r\n\t\t});\r\n\t}\r\n} catch (e) {\r\n\t/*\r\n\t * WebWorkers are not supported in this format. This can happen in IE10\r\n\t * where it can't create one from a blob this way. We fallback, but make\r\n\t * no guarantees towards accuracy in this case.\r\n\t */\r\n}\r\n\r\n/**\r\n * Called on every tick, preferably through rAF. This is reponsible for\r\n * initialising any new animations, then starting any that need starting.\r\n * Finally it will expand any tweens and set the properties relating to\r\n * them. If there are any callbacks relating to the animations then they\r\n * will attempt to call at the end (with the exception of \"begin\").\r\n */\r\nexport function tick(timestamp?: number | boolean) {\r\n\tif (ticking) {\r\n\t\t// Should never happen - but if we've swapped back from hidden to\r\n\t\t// visibile then we want to make sure\r\n\t\treturn;\r\n\t}\r\n\tticking = true;\r\n\t/* An empty timestamp argument indicates that this is the first tick occurence since ticking was turned on.\r\n\t We leverage this metadata to fully ignore the first tick pass since RAF's initial pass is fired whenever\r\n\t the browser's next tick sync time occurs, which results in the first elements subjected to Velocity\r\n\t calls being animated out of sync with any elements animated immediately thereafter. In short, we ignore\r\n\t the first RAF tick pass so that elements being immediately consecutively animated -- instead of simultaneously animated\r\n\t by the same Velocity call -- are properly batched into the same initial RAF tick and consequently remain in sync thereafter. */\r\n\tif (timestamp !== false) {\r\n\t\tconst timeCurrent = performance.now(),\r\n\t\t\tdeltaTime = lastTick ? timeCurrent - lastTick : FRAME_TIME,\r\n\t\t\tdefaultSpeed = defaults.speed,\r\n\t\t\tdefaultEasing = defaults.easing,\r\n\t\t\tdefaultDuration = defaults.duration;\r\n\t\tlet activeCall: AnimationCall,\r\n\t\t\tnextCall: AnimationCall;\r\n\r\n\t\tif (deltaTime >= defaults.minFrameTime || !lastTick) {\r\n\t\t\tlastTick = timeCurrent;\r\n\r\n\t\t\t/********************\r\n\t\t\t Call Iteration\r\n\t\t\t ********************/\r\n\r\n\t\t\t// Expand any tweens that might need it.\r\n\t\t\twhile (State.firstNew) {\r\n\t\t\t\tvalidateTweens(State.firstNew);\r\n\t\t\t}\r\n\t\t\t// Iterate through each active call.\r\n\t\t\tfor (activeCall = State.first; activeCall && activeCall !== State.firstNew; activeCall = activeCall._next) {\r\n\t\t\t\tconst element = activeCall.element,\r\n\t\t\t\t\tdata = Data(element);\r\n\r\n\t\t\t\t// Check to see if this element has been deleted midway\r\n\t\t\t\t// through the animation. If it's gone then end this\r\n\t\t\t\t// animation.\r\n\t\t\t\tif (!element.parentNode || !data) {\r\n\t\t\t\t\t// TODO: Remove safely - decrease count, delete data, remove from arrays\r\n\t\t\t\t\tfreeAnimationCall(activeCall);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// Don't bother getting until we can use these.\r\n\t\t\t\tconst options = activeCall.options,\r\n\t\t\t\t\tflags = activeCall._flags;\r\n\t\t\t\tlet timeStart = activeCall.timeStart;\r\n\r\n\t\t\t\t// If this is the first time that this call has been\r\n\t\t\t\t// processed by tick() then we assign timeStart now so that\r\n\t\t\t\t// it's value is as close to the real animation start time\r\n\t\t\t\t// as possible.\r\n\t\t\t\tif (!timeStart) {\r\n\t\t\t\t\tconst queue = activeCall.queue != null ? activeCall.queue : options.queue;\r\n\r\n\t\t\t\t\ttimeStart = timeCurrent - deltaTime;\r\n\t\t\t\t\tif (queue !== false) {\r\n\t\t\t\t\t\ttimeStart = Math.max(timeStart, data.lastFinishList[queue] || 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tactiveCall.timeStart = timeStart;\r\n\t\t\t\t}\r\n\t\t\t\t// If this animation is paused then skip processing unless\r\n\t\t\t\t// it has been set to resume.\r\n\t\t\t\tif (flags & AnimationFlags.PAUSED) { // tslint:disable-line:no-bitwise\r\n\t\t\t\t\t// Update the time start to accomodate the paused\r\n\t\t\t\t\t// completion amount.\r\n\t\t\t\t\tactiveCall.timeStart += deltaTime;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// Check if this animation is ready - if it's synced then it\r\n\t\t\t\t// needs to wait for all other animations in the sync\r\n\t\t\t\tif (!(flags & AnimationFlags.READY)) { // tslint:disable-line:no-bitwise\r\n\t\t\t\t\tactiveCall._flags |= AnimationFlags.READY; // tslint:disable-line:no-bitwise\r\n\t\t\t\t\toptions._ready++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Need to split the loop, as ready sync animations must all get\r\n\t\t\t// the same start time.\r\n\t\t\tfor (activeCall = State.first; activeCall && activeCall !== State.firstNew; activeCall = nextCall) {\r\n\t\t\t\tconst flags = activeCall._flags;\r\n\r\n\t\t\t\tnextCall = activeCall._next;\r\n\t\t\t\tif (!(flags & AnimationFlags.READY) || (flags & AnimationFlags.PAUSED)) { // tslint:disable-line:no-bitwise\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst options = activeCall.options;\r\n\r\n\t\t\t\tif ((flags & AnimationFlags.SYNC) && options._ready < options._total) { // tslint:disable-line:no-bitwise\r\n\t\t\t\t\tactiveCall.timeStart += deltaTime;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst speed = activeCall.speed != null ? activeCall.speed : options.speed != null ? options.speed : defaultSpeed;\r\n\t\t\t\tlet timeStart = activeCall.timeStart;\r\n\r\n\t\t\t\t// Don't bother getting until we can use these.\r\n\t\t\t\tif (!(flags & AnimationFlags.STARTED)) { // tslint:disable-line:no-bitwise\r\n\t\t\t\t\tconst delay = activeCall.delay != null ? activeCall.delay : options.delay;\r\n\r\n\t\t\t\t\t// Make sure anything we've delayed doesn't start\r\n\t\t\t\t\t// animating yet, there might still be an active delay\r\n\t\t\t\t\t// after something has been un-paused\r\n\t\t\t\t\tif (delay) {\r\n\t\t\t\t\t\tif (timeStart + (delay / speed) > timeCurrent) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tactiveCall.timeStart = timeStart += delay / (delay > 0 ? speed : 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tactiveCall._flags |= AnimationFlags.STARTED; // tslint:disable-line:no-bitwise\r\n\t\t\t\t\t// The begin callback is fired once per call, not once\r\n\t\t\t\t\t// per element, and is passed the full raw DOM element\r\n\t\t\t\t\t// set as both its context and its first argument.\r\n\t\t\t\t\tif (options._started++ === 0) {\r\n\t\t\t\t\t\toptions._first = activeCall;\r\n\t\t\t\t\t\tif (options.begin) {\r\n\t\t\t\t\t\t\t// Pass to an external fn with a try/catch block for optimisation\r\n\t\t\t\t\t\t\tbeginCall(activeCall);\r\n\t\t\t\t\t\t\t// Only called once, even if reversed or repeated\r\n\t\t\t\t\t\t\toptions.begin = undefined;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (speed !== 1) {\r\n\t\t\t\t\t// On the first frame we may have a shorter delta\r\n\t\t\t\t\t// const delta = Math.min(deltaTime, timeCurrent - timeStart);\r\n\t\t\t\t\tactiveCall.timeStart = timeStart += Math.min(deltaTime, timeCurrent - timeStart) * (1 - speed);\r\n\t\t\t\t}\r\n\t\t\t\tconst activeEasing = activeCall.easing != null ? activeCall.easing : options.easing != null ? options.easing : defaultEasing,\r\n\t\t\t\t\tmillisecondsEllapsed = activeCall.ellapsedTime = timeCurrent - timeStart,\r\n\t\t\t\t\tduration = activeCall.duration != null ? activeCall.duration : options.duration != null ? options.duration : defaultDuration,\r\n\t\t\t\t\tpercentComplete = activeCall.percentComplete = Velocity.mock ? 1 : Math.min(millisecondsEllapsed / duration, 1),\r\n\t\t\t\t\ttweens = activeCall.tweens,\r\n\t\t\t\t\treverse = flags & AnimationFlags.REVERSE; // tslint:disable-line:no-bitwise\r\n\r\n\t\t\t\tif (activeCall.progress || (options._first === activeCall && options.progress)) {\r\n\t\t\t\t\tprogressed.add(activeCall);\r\n\t\t\t\t}\r\n\t\t\t\tif (percentComplete === 1) {\r\n\t\t\t\t\tcompleted.add(activeCall);\r\n\t\t\t\t}\r\n\t\t\t\t// tslint:disable-next-line:forin\r\n\t\t\t\tfor (const property in tweens) {\r\n\t\t\t\t\t// For every element, iterate through each property.\r\n\t\t\t\t\tconst tween = tweens[property],\r\n\t\t\t\t\t\tsequence = tween.sequence,\r\n\t\t\t\t\t\tpattern = sequence.pattern;\r\n\t\t\t\t\tlet currentValue = \"\",\r\n\t\t\t\t\t\ti = 0;\r\n\r\n\t\t\t\t\tif (pattern) {\r\n\t\t\t\t\t\tconst easingComplete = (tween.easing || activeEasing)(percentComplete, 0, 1, property);\r\n\t\t\t\t\t\tlet best = 0;\r\n\r\n\t\t\t\t\t\tfor (let j = 0; j < sequence.length - 1; j++) {\r\n\t\t\t\t\t\t\tif (sequence[j].percent < easingComplete) {\r\n\t\t\t\t\t\t\t\tbest = j;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst tweenFrom: TweenStep = sequence[best],\r\n\t\t\t\t\t\t\ttweenTo: TweenStep = sequence[best + 1] || tweenFrom,\r\n\t\t\t\t\t\t\ttweenPercent = (percentComplete - tweenFrom.percent) / (tweenTo.percent - tweenFrom.percent),\r\n\t\t\t\t\t\t\teasing = tweenTo.easing || linearEasing;\r\n\r\n\t\t\t\t\t\tfor (; i < pattern.length; i++) {\r\n\t\t\t\t\t\t\tconst startValue = tweenFrom[i];\r\n\r\n\t\t\t\t\t\t\tif (startValue == null) {\r\n\t\t\t\t\t\t\t\tcurrentValue += pattern[i];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconst endValue = tweenTo[i];\r\n\r\n\t\t\t\t\t\t\t\tif (startValue === endValue) {\r\n\t\t\t\t\t\t\t\t\tcurrentValue += startValue;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// All easings must deal with numbers except for our internal ones.\r\n\t\t\t\t\t\t\t\t\tconst result = easing(reverse ? 1 - tweenPercent : tweenPercent, startValue as number, endValue as number, property);\r\n\r\n\t\t\t\t\t\t\t\t\tcurrentValue += pattern[i] === true ? Math.round(result) : result;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (property !== \"tween\") {\r\n\t\t\t\t\t\t\tif (percentComplete === 1 && currentValue.startsWith(\"calc(0 + \")) {\r\n\t\t\t\t\t\t\t\tcurrentValue = currentValue.replace(/^calc\\(0[^\\d]* \\+ ([^\\(\\)]+)\\)$/, \"$1\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// TODO: To solve an IE<=8 positioning bug, the unit type must be dropped when setting a property value of 0 - add normalisations to legacy\r\n\t\t\t\t\t\t\tsetPropertyValue(activeCall.element, property, currentValue, tween.fn);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Skip the fake 'tween' property as that is only\r\n\t\t\t\t\t\t\t// passed into the progress callback.\r\n\t\t\t\t\t\t\tactiveCall.tween = currentValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(`VelocityJS: Missing pattern:`, property, JSON.stringify(tween[property]));\r\n\t\t\t\t\t\tdelete tweens[property];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (progressed.size || completed.size) {\r\n\t\t\t\tif (!document.hidden) {\r\n\t\t\t\t\tasyncCallbacks();\r\n\t\t\t\t} else if (worker) {\r\n\t\t\t\t\tworker.postMessage(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(asyncCallbacks, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (State.first) {\r\n\t\tState.isTicking = true;\r\n\t\tif (!document.hidden) {\r\n\t\t\trAFShim(tick);\r\n\t\t} else if (!worker) {\r\n\t\t\trAFProxy(tick);\r\n\t\t} else if (timestamp === false) {\r\n\t\t\t// Make sure we turn on the messages.\r\n\t\t\tworker.postMessage(true);\r\n\t\t}\r\n\t} else {\r\n\t\tState.isTicking = false;\r\n\t\tlastTick = 0;\r\n\t\tif (document.hidden && worker) {\r\n\t\t\t// Make sure we turn off the messages.\r\n\t\t\tworker.postMessage(false);\r\n\t\t}\r\n\t}\r\n\tticking = false;\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Finish all animation.\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, AnimationFlags, VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isVelocityResult} from \"../../types\";\r\nimport {getValue} from \"../../utility\";\r\nimport {completeCall} from \"../complete\";\r\nimport {setPropertyValue} from \"../css/setPropertyValue\";\r\nimport {defaults} from \"../defaults\";\r\nimport {validateQueue} from \"../options\";\r\nimport {State} from \"../state\";\r\nimport {beginCall} from \"../tick\";\r\nimport {validateTweens} from \"../tweens\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n/**\r\n * Check if an animation should be finished, and if so we set the tweens to\r\n * the final value for it, then call complete.\r\n */\r\nfunction checkAnimationShouldBeFinished(animation: AnimationCall, queueName: false | string, defaultQueue: false | string) {\r\n\tvalidateTweens(animation);\r\n\tif (queueName === undefined || queueName === getValue(animation.queue, animation.options.queue, defaultQueue)) {\r\n\t\tif (!(animation._flags & AnimationFlags.STARTED)) { // tslint:disable-line:no-bitwise\r\n\t\t\t// Copied from tick.ts - ensure that the animation is completely\r\n\t\t\t// valid and run begin() before complete().\r\n\t\t\tconst options = animation.options;\r\n\r\n\t\t\t// The begin callback is fired once per call, not once per\r\n\t\t\t// element, and is passed the full raw DOM element set as both\r\n\t\t\t// its context and its first argument.\r\n\t\t\tif (options._started++ === 0) {\r\n\t\t\t\toptions._first = animation;\r\n\t\t\t\tif (options.begin) {\r\n\t\t\t\t\t// Pass to an external fn with a try/catch block for optimisation\r\n\t\t\t\t\tbeginCall(animation);\r\n\t\t\t\t\t// Only called once, even if reversed or repeated\r\n\t\t\t\t\toptions.begin = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tanimation._flags |= AnimationFlags.STARTED; // tslint:disable-line:no-bitwise\r\n\t\t}\r\n\t\t// tslint:disable-next-line:forin\r\n\t\tfor (const property in animation.tweens) {\r\n\t\t\tconst tween = animation.tweens[property],\r\n\t\t\t\tsequence = tween.sequence,\r\n\t\t\t\tpattern = sequence.pattern;\r\n\t\t\tlet currentValue = \"\",\r\n\t\t\t\ti = 0;\r\n\r\n\t\t\tif (pattern) {\r\n\t\t\t\tconst endValues = sequence[sequence.length - 1];\r\n\r\n\t\t\t\tfor (; i < pattern.length; i++) {\r\n\t\t\t\t\tconst endValue = endValues[i];\r\n\r\n\t\t\t\t\tcurrentValue += endValue == null ? pattern[i] : endValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsetPropertyValue(animation.element, property, currentValue, tween.fn);\r\n\t\t}\r\n\t\tcompleteCall(animation);\r\n\t}\r\n}\r\n\r\n/**\r\n * When the finish action is triggered, the elements' currently active call is\r\n * immediately finished. When an element is finished, the next item in its\r\n * animation queue is immediately triggered. If passed via a chained call\r\n * then this will only target the animations in that call, and not the\r\n * elements linked to it.\r\n *\r\n * A queue name may be passed in to specify that only animations on the\r\n * named queue are finished. The default queue is named \"\". In addition the\r\n * value of `false` is allowed for the queue name.\r\n *\r\n * An final argument may be passed in to clear an element's remaining queued\r\n * calls. This may only be the value `true`.\r\n */\r\nfunction finish(args: any[], elements: VelocityResult, promiseHandler?: VelocityPromise): void {\r\n\tconst queueName: string | false = validateQueue(args[0], true),\r\n\t\tdefaultQueue: false | string = defaults.queue,\r\n\t\tfinishAll = args[queueName === undefined ? 0 : 1] === true;\r\n\r\n\tif (isVelocityResult(elements) && elements.velocity.animations) {\r\n\t\tfor (const animation of elements.velocity.animations) {\r\n\t\t\tcheckAnimationShouldBeFinished(animation, queueName, defaultQueue);\r\n\t\t}\r\n\t} else {\r\n\t\twhile (State.firstNew) {\r\n\t\t\tvalidateTweens(State.firstNew);\r\n\t\t}\r\n\t\tfor (let activeCall = State.first, nextCall: AnimationCall; activeCall && (finishAll || activeCall !== State.firstNew); activeCall = nextCall || State.firstNew) {\r\n\t\t\tnextCall = activeCall._next;\r\n\t\t\tif (!elements || elements.includes(activeCall.element)) {\r\n\t\t\t\tcheckAnimationShouldBeFinished(activeCall, queueName, defaultQueue);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (promiseHandler) {\r\n\t\tif (isVelocityResult(elements) && elements.velocity.animations && elements.then) {\r\n\t\t\telements.then(promiseHandler._resolver);\r\n\t\t} else {\r\n\t\t\tpromiseHandler._resolver(elements);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"finish\", finish], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Get or set a value from one or more running animations.\r\n */\r\n\r\nimport {AnimationCall, AnimationFlags, VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\nimport {isVelocityResult} from \"../../types\";\r\nimport {getValue} from \"../../utility\";\r\nimport {defaults} from \"../defaults\";\r\nimport {\r\n\tvalidateBegin, validateCache, validateComplete, validateDelay, validateDuration,\r\n\tvalidateFpsLimit, validateLoop, validateQueue, validateRepeat,\r\n} from \"../options\";\r\nimport {State} from \"../state\";\r\nimport {lastTick} from \"../tick\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n/**\r\n * Used to map getters for the various AnimationFlags.\r\n */\r\nconst animationFlags: {[key: string]: number} = {\r\n\tisExpanded: AnimationFlags.EXPANDED,\r\n\tisReady: AnimationFlags.READY,\r\n\tisStarted: AnimationFlags.STARTED,\r\n\tisStopped: AnimationFlags.STOPPED,\r\n\tisPaused: AnimationFlags.PAUSED,\r\n\tisSync: AnimationFlags.SYNC,\r\n\tisReverse: AnimationFlags.REVERSE,\r\n};\r\n\r\n/**\r\n * Get or set an option or running AnimationCall data value. If there is no\r\n * value passed then it will get, otherwise we will set.\r\n *\r\n * NOTE: When using \"get\" this will not touch the Promise as it is never\r\n * returned to the user.\r\n */\r\nfunction option(args?: any[], elements?: VelocityResult, promiseHandler?: VelocityPromise, action?: string): any {\r\n\tconst key = args[0],\r\n\t\tqueue = action.indexOf(\".\") >= 0 ? action.replace(/^.*\\./, \"\") : undefined,\r\n\t\tqueueName = queue === \"false\" ? false : validateQueue(queue, true);\r\n\tlet animations: AnimationCall[],\r\n\t\tvalue = args[1];\r\n\r\n\tif (!key) {\r\n\t\tconsole.warn(`VelocityJS: Cannot access a non-existant key!`);\r\n\r\n\t\treturn null;\r\n\t}\r\n\t// If we're chaining the return value from Velocity then we are only\r\n\t// interested in the values related to that call\r\n\tif (isVelocityResult(elements) && elements.velocity.animations) {\r\n\t\tanimations = elements.velocity.animations;\r\n\t} else {\r\n\t\tanimations = [];\r\n\r\n\t\tfor (let activeCall = State.first; activeCall; activeCall = activeCall._next) {\r\n\t\t\tif (elements.indexOf(activeCall.element) >= 0 && getValue(activeCall.queue, activeCall.options.queue) === queueName) {\r\n\t\t\t\tanimations.push(activeCall);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// If we're dealing with multiple elements that are pointing at a\r\n\t\t// single running animation, then instead treat them as a single\r\n\t\t// animation.\r\n\t\tif (elements.length > 1 && animations.length > 1) {\r\n\t\t\tlet i = 1,\r\n\t\t\t\toptions = animations[0].options;\r\n\r\n\t\t\twhile (i < animations.length) {\r\n\t\t\t\tif (animations[i++].options !== options) {\r\n\t\t\t\t\toptions = null;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// TODO: this needs to check that they're actually a sync:true animation to merge the results, otherwise the individual values may be different\r\n\t\t\tif (options) {\r\n\t\t\t\tanimations = [animations[0]];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// GET\r\n\tif (value === undefined) {\r\n\t\tconst result = [],\r\n\t\t\tflag = animationFlags[key];\r\n\r\n\t\tfor (const animation of animations) {\r\n\t\t\tif (flag === undefined) {\r\n\t\t\t\t// A normal key to get.\r\n\t\t\t\tresult.push(getValue(animation[key], animation.options[key]));\r\n\t\t\t} else {\r\n\t\t\t\t// A flag that we're checking against.\r\n\t\t\t\tresult.push((animation._flags & flag) === 0); // tslint:disable-line:no-bitwise\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (elements.length === 1 && animations.length === 1) {\r\n\t\t\t// If only a single animation is found and we're only targetting a\r\n\t\t\t// single element, then return the value directly\r\n\t\t\treturn result[0];\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\t// SET\r\n\tlet isPercentComplete: boolean;\r\n\r\n\tswitch (key) {\r\n\t\tcase \"cache\":\r\n\t\t\tvalue = validateCache(value);\r\n\t\t\tbreak;\r\n\t\tcase \"begin\":\r\n\t\t\tvalue = validateBegin(value);\r\n\t\t\tbreak;\r\n\t\tcase \"complete\":\r\n\t\t\tvalue = validateComplete(value);\r\n\t\t\tbreak;\r\n\t\tcase \"delay\":\r\n\t\t\tvalue = validateDelay(value);\r\n\t\t\tbreak;\r\n\t\tcase \"duration\":\r\n\t\t\tvalue = validateDuration(value);\r\n\t\t\tbreak;\r\n\t\tcase \"fpsLimit\":\r\n\t\t\tvalue = validateFpsLimit(value);\r\n\t\t\tbreak;\r\n\t\tcase \"loop\":\r\n\t\t\tvalue = validateLoop(value);\r\n\t\t\tbreak;\r\n\t\tcase \"percentComplete\":\r\n\t\t\tisPercentComplete = true;\r\n\t\t\tvalue = parseFloat(value);\r\n\t\t\tbreak;\r\n\t\tcase \"repeat\":\r\n\t\tcase \"repeatAgain\":\r\n\t\t\tvalue = validateRepeat(value);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tif (key[0] !== \"_\") {\r\n\t\t\t\tconst num = parseFloat(value);\r\n\r\n\t\t\t\tif (value === String(num)) {\r\n\t\t\t\t\tvalue = num;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t// deliberate fallthrough\r\n\t\tcase \"queue\":\r\n\t\tcase \"promise\":\r\n\t\tcase \"promiseRejectEmpty\":\r\n\t\tcase \"easing\":\r\n\t\tcase \"started\":\r\n\t\t\tconsole.warn(`VelocityJS: Trying to set a read-only key:`, key);\r\n\r\n\t\t\treturn;\r\n\t}\r\n\tif (value === undefined || value !== value) {\r\n\t\tconsole.warn(`VelocityJS: Trying to set an invalid value:${key}=${value} (${args[1]})`);\r\n\r\n\t\treturn null;\r\n\t}\r\n\tfor (const animation of animations) {\r\n\t\tif (isPercentComplete) {\r\n\t\t\tanimation.timeStart = lastTick - (getValue(animation.duration, animation.options.duration, defaults.duration) * value);\r\n\t\t} else {\r\n\t\t\tanimation[key] = value;\r\n\t\t}\r\n\t}\r\n\tif (promiseHandler) {\r\n\t\tif (isVelocityResult(elements) && elements.velocity.animations && elements.then) {\r\n\t\t\telements.then(promiseHandler._resolver);\r\n\t\t} else {\r\n\t\t\tpromiseHandler._resolver(elements);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"option\", option], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Pause and resume animation.\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, AnimationFlags, VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isVelocityResult} from \"../../types\";\r\nimport {getValue} from \"../../utility\";\r\nimport {defaults} from \"../defaults\";\r\nimport {validateQueue} from \"../options\";\r\nimport {State} from \"../state\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n/**\r\n * Check if an animation should be paused / resumed.\r\n */\r\nfunction checkAnimation(animation: AnimationCall, queueName: false | string, defaultQueue: false | string, isPaused: boolean) {\r\n\tif (queueName === undefined || queueName === getValue(animation.queue, animation.options.queue, defaultQueue)) {\r\n\t\tif (isPaused) {\r\n\t\t\tanimation._flags |= AnimationFlags.PAUSED; // tslint:disable-line:no-bitwise\r\n\t\t} else {\r\n\t\t\tanimation._flags &= ~AnimationFlags.PAUSED; // tslint:disable-line:no-bitwise\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Pause and Resume are call-wide (not on a per element basis). Thus, calling pause or resume on a\r\n * single element will cause any calls that contain tweens for that element to be paused/resumed\r\n * as well.\r\n */\r\nfunction pauseResume(args?: any[], elements?: VelocityResult, promiseHandler?: VelocityPromise, action?: string) {\r\n\tconst isPaused = action.indexOf(\"pause\") === 0,\r\n\t\tqueue = action.indexOf(\".\") >= 0 ? action.replace(/^.*\\./, \"\") : undefined,\r\n\t\tqueueName = queue === \"false\" ? false : validateQueue(args[0]),\r\n\t\tdefaultQueue = defaults.queue;\r\n\r\n\tif (isVelocityResult(elements) && elements.velocity.animations) {\r\n\t\tfor (const animation of elements.velocity.animations) {\r\n\t\t\tcheckAnimation(animation, queueName, defaultQueue, isPaused);\r\n\t\t}\r\n\t} else {\r\n\t\tlet activeCall: AnimationCall = State.first;\r\n\r\n\t\twhile (activeCall) {\r\n\t\t\tif (!elements || elements.includes(activeCall.element)) {\r\n\t\t\t\tcheckAnimation(activeCall, queueName, defaultQueue, isPaused);\r\n\t\t\t}\r\n\t\t\tactiveCall = activeCall._next;\r\n\t\t}\r\n\t}\r\n\tif (promiseHandler) {\r\n\t\tif (isVelocityResult(elements) && elements.velocity.animations && elements.then) {\r\n\t\t\telements.then(promiseHandler._resolver);\r\n\t\t} else {\r\n\t\t\tpromiseHandler._resolver(elements);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"pause\", pauseResume], true);\r\nregisterAction([\"resume\", pauseResume], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Get or set a property from one or more elements.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isNumber, isPlainObject, isString, isVelocityResult} from \"../../types\";\r\nimport {fixColors} from \"../css/fixColors\";\r\nimport {getPropertyValue} from \"../css/getPropertyValue\";\r\nimport {setPropertyValue} from \"../css/setPropertyValue\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n/**\r\n * Get or set a style of Nomralised property value on one or more elements.\r\n * If there is no value passed then it will get, otherwise we will set.\r\n *\r\n * NOTE: When using \"get\" this will not touch the Promise as it is never\r\n * returned to the user.\r\n *\r\n * This can fail to set, and will reject the Promise if it does so.\r\n *\r\n * Velocity(elements, \"style\", \"property\", \"value\") => elements;\r\n * Velocity(elements, \"style\", {\"property\": \"value\", ...}) => elements;\r\n * Velocity(element, \"style\", \"property\") => \"value\";\r\n * Velocity(elements, \"style\", \"property\") => [\"value\", ...];\r\n */\r\nexport function propertyAction(args?: any[], elements?: VelocityResult, promiseHandler?: VelocityPromise, action?: string): any {\r\n\tconst property = args[0],\r\n\t\tvalue = args[1];\r\n\r\n\tif (!property) {\r\n\t\tconsole.warn(`VelocityJS: Cannot access a non-existant property!`);\r\n\r\n\t\treturn null;\r\n\t}\r\n\t// GET\r\n\tif (value === undefined && !isPlainObject(property)) {\r\n\t\tif (Array.isArray(property)) {\r\n\t\t\tif (elements.length === 1) {\r\n\t\t\t\tconst result = {};\r\n\r\n\t\t\t\tfor (const prop of property) {\r\n\t\t\t\t\tresult[prop] = fixColors(getPropertyValue(elements[0], prop));\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t} else {\r\n\t\t\t\tconst result = [];\r\n\r\n\t\t\t\tfor (const element of elements) {\r\n\t\t\t\t\tconst res = {};\r\n\r\n\t\t\t\t\tfor (const prop of property) {\r\n\t\t\t\t\t\tres[prop] = fixColors(getPropertyValue(element, prop));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult.push(res);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// If only a single animation is found and we're only targetting a\r\n\t\t\t// single element, then return the value directly\r\n\t\t\tif (elements.length === 1) {\r\n\t\t\t\treturn fixColors(getPropertyValue(elements[0], property));\r\n\t\t\t}\r\n\t\t\tconst result = [];\r\n\r\n\t\t\tfor (const element of elements) {\r\n\t\t\t\tresult.push(fixColors(getPropertyValue(element, property)));\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\t// SET\r\n\tconst error: string[] = [];\r\n\r\n\tif (isPlainObject(property)) {\r\n\t\tfor (const propertyName in property) {\r\n\t\t\tif (property.hasOwnProperty(propertyName)) {\r\n\t\t\t\tfor (const element of elements) {\r\n\t\t\t\t\tconst propertyValue = property[propertyName];\r\n\r\n\t\t\t\t\tif (isString(propertyValue) || isNumber(propertyValue)) {\r\n\t\t\t\t\t\tsetPropertyValue(element, propertyName, property[propertyName]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\terror.push(`Cannot set a property \"${propertyName}\" to an unknown type: ${typeof propertyValue}`);\r\n\t\t\t\t\t\tconsole.warn(`VelocityJS: Cannot set a property \"${propertyName}\" to an unknown type:`, propertyValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (isString(value) || isNumber(value)) {\r\n\t\tfor (const element of elements) {\r\n\t\t\tsetPropertyValue(element, property, String(value));\r\n\t\t}\r\n\t} else {\r\n\t\terror.push(`Cannot set a property \"${property}\" to an unknown type: ${typeof value}`);\r\n\t\tconsole.warn(`VelocityJS: Cannot set a property \"${property}\" to an unknown type:`, value);\r\n\t}\r\n\tif (promiseHandler) {\r\n\t\tif (error.length) {\r\n\t\t\tpromiseHandler._rejecter(error.join(\", \"));\r\n\t\t} else if (isVelocityResult(elements) && elements.velocity.animations && elements.then) {\r\n\t\t\telements.then(promiseHandler._resolver);\r\n\t\t} else {\r\n\t\t\tpromiseHandler._resolver(elements);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"property\", propertyAction], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Actions that can be performed by passing a string instead of a propertiesMap.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {registerAction} from \"./actions\";\r\n\r\nregisterAction([\"reverse\", (args?: any[], elements?: HTMLorSVGElement[] | VelocityResult, promiseHandler?: VelocityPromise, action?: string) => {\r\n\t// NOTE: Code needs to split out before here - but this is needed to prevent it being overridden\r\n\tthrow new SyntaxError(\"VelocityJS: The 'reverse' action is built in and private.\");\r\n}], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Stop animation.\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, AnimationFlags, VelocityPromise, VelocityResult} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isVelocityResult} from \"../../types\";\r\nimport {getValue} from \"../../utility\";\r\nimport {completeCall} from \"../complete\";\r\nimport {defaults} from \"../defaults\";\r\nimport {validateQueue} from \"../options\";\r\nimport {State} from \"../state\";\r\nimport {validateTweens} from \"../tweens\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n/**\r\n * Check if an animation should be stopped, and if so then set the STOPPED\r\n * flag on it, then call complete.\r\n */\r\nfunction checkAnimationShouldBeStopped(animation: AnimationCall, queueName: false | string, defaultQueue: false | string) {\r\n\tvalidateTweens(animation);\r\n\tif (queueName === undefined || queueName === getValue(animation.queue, animation.options.queue, defaultQueue)) {\r\n\t\tanimation._flags |= AnimationFlags.STOPPED; // tslint:disable-line:no-bitwise\r\n\t\tcompleteCall(animation);\r\n\t}\r\n}\r\n\r\n/**\r\n * When the stop action is triggered, the elements' currently active call is\r\n * immediately stopped. When an element is stopped, the next item in its\r\n * animation queue is immediately triggered. If passed via a chained call\r\n * then this will only target the animations in that call, and not the\r\n * elements linked to it.\r\n *\r\n * A queue name may be passed in to specify that only animations on the\r\n * named queue are stopped. The default queue is named \"\". In addition the\r\n * value of `false` is allowed for the queue name.\r\n *\r\n * An final argument may be passed in to clear an element's remaining queued\r\n * calls. This may only be the value `true`.\r\n *\r\n * Note: The stop command runs prior to Velocity's Queueing phase since its\r\n * behavior is intended to take effect *immediately*, regardless of the\r\n * element's current queue state.\r\n */\r\nfunction stop(args: any[], elements: VelocityResult, promiseHandler?: VelocityPromise, action?: string): void {\r\n\tconst queueName: string | false = validateQueue(args[0], true),\r\n\t\tdefaultQueue: false | string = defaults.queue,\r\n\t\tfinishAll = args[queueName === undefined ? 0 : 1] === true;\r\n\r\n\tif (isVelocityResult(elements) && elements.velocity.animations) {\r\n\t\tfor (const animation of elements.velocity.animations) {\r\n\t\t\tcheckAnimationShouldBeStopped(animation, queueName, defaultQueue);\r\n\t\t}\r\n\t} else {\r\n\t\twhile (State.firstNew) {\r\n\t\t\tvalidateTweens(State.firstNew);\r\n\t\t}\r\n\t\tfor (let activeCall = State.first, nextCall: AnimationCall; activeCall && (finishAll || activeCall !== State.firstNew); activeCall = nextCall || State.firstNew) {\r\n\t\t\tnextCall = activeCall._next;\r\n\t\t\tif (!elements || elements.includes(activeCall.element)) {\r\n\t\t\t\tcheckAnimationShouldBeStopped(activeCall, queueName, defaultQueue);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (promiseHandler) {\r\n\t\tif (isVelocityResult(elements) && elements.velocity.animations && elements.then) {\r\n\t\t\telements.then(promiseHandler._resolver);\r\n\t\t} else {\r\n\t\t\tpromiseHandler._resolver(elements);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"stop\", stop], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Get or set a property from one or more elements.\r\n */\r\n\r\n// Project\r\nimport {registerAction} from \"./actions\";\r\nimport {propertyAction} from \"./property\";\r\n\r\nregisterAction([\"style\", propertyAction], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Get or set a property from one or more elements.\r\n */\r\n\r\n// Typedefs\r\nimport {\r\n\tAnimationCall, HTMLorSVGElement, Properties, Sequence, SequenceList,\r\n\tTweenStep, VelocityEasingType, VelocityPromise, VelocityProperty, VelocityResult,\r\n} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {isNumber, isPlainObject, isString} from \"../../types\";\r\nimport {getValue} from \"../../utility\";\r\nimport {defaults} from \"../defaults\";\r\nimport {linearEasing} from \"../easing/easings\";\r\nimport {validateEasing} from \"../options\";\r\nimport {expandSequence} from \"../sequences\";\r\nimport {SequencesObject} from \"../sequencesObject\";\r\nimport {expandProperties} from \"../tweens\";\r\nimport {registerAction} from \"./actions\";\r\n\r\n// Constants\r\nimport {DEFAULT_DURATION} from \"../../constants\";\r\n\r\n/**\r\n *\r\n */\r\nfunction tweenAction(args?: any[], elements?: VelocityResult, promiseHandler?: VelocityPromise, action?: string): any {\r\n\tlet requireForcefeeding: boolean;\r\n\r\n\tif (!elements) {\r\n\t\tif (!args.length) {\r\n\t\t\tconsole.info(`Velocity(<element>, \\\"tween\\\", percentComplete, property, end | [end, <easing>, <start>], <easing>) => value\r\nVelocity(<element>, \\\"tween\\\", percentComplete, {property: end | [end, <easing>, <start>], ...}, <easing>) => {property: value, ...}`);\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\telements = [document.body];\r\n\t\trequireForcefeeding = true;\r\n\t} else if (elements.length !== 1) {\r\n\t\t// TODO: Allow more than a single element to return an array of results\r\n\t\tthrow new Error(\"VelocityJS: Cannot tween more than one element!\");\r\n\t}\r\n\tconst percentComplete: number = args[0],\r\n\t\tfakeAnimation = {\r\n\t\t\telements,\r\n\t\t\telement: elements[0],\r\n\t\t\tqueue: false,\r\n\t\t\toptions: {\r\n\t\t\t\tduration: 1000,\r\n\t\t\t},\r\n\t\t\ttweens: null as {[property: string]: Sequence},\r\n\t\t} as any as AnimationCall,\r\n\t\tresult: {[property: string]: string} = {};\r\n\tlet properties: Properties<string> = args[1],\r\n\t\tsingleResult: boolean,\r\n\t\tmaybeSequence: SequenceList,\r\n\t\teasing: VelocityEasingType = args[2],\r\n\t\tcount = 0;\r\n\r\n\tif (isString(args[1])) {\r\n\t\tif (SequencesObject && SequencesObject[args[1]]) {\r\n\t\t\tmaybeSequence = SequencesObject[args[1]];\r\n\t\t\tproperties = {};\r\n\t\t\teasing = args[2];\r\n\t\t} else {\r\n\t\t\tsingleResult = true;\r\n\t\t\tproperties = {\r\n\t\t\t\t[args[1]]: args[2],\r\n\t\t\t};\r\n\t\t\teasing = args[3];\r\n\t\t}\r\n\t} else if (Array.isArray(args[1])) {\r\n\t\tsingleResult = true;\r\n\t\tproperties = {\r\n\t\t\ttween: args[1],\r\n\t\t} as any;\r\n\t\teasing = args[2];\r\n\t}\r\n\tif (!isNumber(percentComplete) || percentComplete < 0 || percentComplete > 1) {\r\n\t\tthrow new Error(\"VelocityJS: Must tween a percentage from 0 to 1!\");\r\n\t}\r\n\tif (!isPlainObject(properties)) {\r\n\t\tthrow new Error(\"VelocityJS: Cannot tween an invalid property!\");\r\n\t}\r\n\tif (requireForcefeeding) {\r\n\t\tfor (const property in properties) {\r\n\t\t\tif (properties.hasOwnProperty(property) && (!Array.isArray(properties[property]) || properties[property].length < 2)) {\r\n\t\t\t\tthrow new Error(\"VelocityJS: When not supplying an element you must force-feed values: \" + property);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconst activeEasing = validateEasing(getValue(easing, defaults.easing), DEFAULT_DURATION);\r\n\r\n\tif (maybeSequence) {\r\n\t\texpandSequence(fakeAnimation, maybeSequence);\r\n\t} else {\r\n\t\texpandProperties(fakeAnimation as AnimationCall, properties);\r\n\t}\r\n\t// tslint:disable-next-line:forin\r\n\tfor (const property in fakeAnimation.tweens) {\r\n\t\t// For every element, iterate through each property.\r\n\t\tconst propertyTween = fakeAnimation.tweens[property],\r\n\t\t\tsequence = propertyTween.sequence,\r\n\t\t\tpattern = sequence.pattern;\r\n\t\tlet currentValue = \"\",\r\n\t\t\ti = 0;\r\n\r\n\t\tcount++;\r\n\t\tif (pattern) {\r\n\t\t\tconst easingComplete = (propertyTween.easing || activeEasing)(percentComplete, 0, 1, property);\r\n\t\t\tlet best = 0;\r\n\r\n\t\t\tfor (let j = 0; j < sequence.length - 1; j++) {\r\n\t\t\t\tif (sequence[j].percent < easingComplete) {\r\n\t\t\t\t\tbest = j;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst tweenFrom: TweenStep = sequence[best],\r\n\t\t\t\ttweenTo: TweenStep = sequence[best + 1] || tweenFrom,\r\n\t\t\t\ttweenPercent = (percentComplete - tweenFrom.percent) / (tweenTo.percent - tweenFrom.percent),\r\n\t\t\t\ttweenEasing = tweenTo.easing || linearEasing;\r\n\r\n\t\t\tfor (; i < pattern.length; i++) {\r\n\t\t\t\tconst startValue = tweenFrom[i];\r\n\r\n\t\t\t\tif (startValue == null) {\r\n\t\t\t\t\tcurrentValue += pattern[i];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst endValue = tweenTo[i];\r\n\r\n\t\t\t\t\tif (startValue === endValue) {\r\n\t\t\t\t\t\tcurrentValue += startValue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// All easings must deal with numbers except for our internal ones.\r\n\t\t\t\t\t\tconst value = tweenEasing(tweenPercent, startValue as number, endValue as number, property);\r\n\r\n\t\t\t\t\t\tcurrentValue += pattern[i] === true ? Math.round(value) : value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresult[property] = currentValue;\r\n\t\t}\r\n\t}\r\n\r\n\tif (singleResult && count === 1) {\r\n\t\tfor (const property in result) {\r\n\t\t\tif (result.hasOwnProperty(property)) {\r\n\t\t\t\treturn result[property];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nregisterAction([\"tween\", tweenAction], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Project\r\nimport {ColorNames} from \"./fixColors\";\r\n\r\n/**\r\n * Converting from hex as it makes for a smaller file.\r\n */\r\nconst colorValues = {\r\n\taliceblue: 0xF0F8FF,\r\n\tantiquewhite: 0xFAEBD7,\r\n\taqua: 0x00FFFF,\r\n\taquamarine: 0x7FFFD4,\r\n\tazure: 0xF0FFFF,\r\n\tbeige: 0xF5F5DC,\r\n\tbisque: 0xFFE4C4,\r\n\tblack: 0x000000,\r\n\tblanchedalmond: 0xFFEBCD,\r\n\tblue: 0x0000FF,\r\n\tblueviolet: 0x8A2BE2,\r\n\tbrown: 0xA52A2A,\r\n\tburlywood: 0xDEB887,\r\n\tcadetblue: 0x5F9EA0,\r\n\tchartreuse: 0x7FFF00,\r\n\tchocolate: 0xD2691E,\r\n\tcoral: 0xFF7F50,\r\n\tcornflowerblue: 0x6495ED,\r\n\tcornsilk: 0xFFF8DC,\r\n\tcrimson: 0xDC143C,\r\n\tcyan: 0x00FFFF,\r\n\tdarkblue: 0x00008B,\r\n\tdarkcyan: 0x008B8B,\r\n\tdarkgoldenrod: 0xB8860B,\r\n\tdarkgray: 0xA9A9A9,\r\n\tdarkgrey: 0xA9A9A9,\r\n\tdarkgreen: 0x006400,\r\n\tdarkkhaki: 0xBDB76B,\r\n\tdarkmagenta: 0x8B008B,\r\n\tdarkolivegreen: 0x556B2F,\r\n\tdarkorange: 0xFF8C00,\r\n\tdarkorchid: 0x9932CC,\r\n\tdarkred: 0x8B0000,\r\n\tdarksalmon: 0xE9967A,\r\n\tdarkseagreen: 0x8FBC8F,\r\n\tdarkslateblue: 0x483D8B,\r\n\tdarkslategray: 0x2F4F4F,\r\n\tdarkslategrey: 0x2F4F4F,\r\n\tdarkturquoise: 0x00CED1,\r\n\tdarkviolet: 0x9400D3,\r\n\tdeeppink: 0xFF1493,\r\n\tdeepskyblue: 0x00BFFF,\r\n\tdimgray: 0x696969,\r\n\tdimgrey: 0x696969,\r\n\tdodgerblue: 0x1E90FF,\r\n\tfirebrick: 0xB22222,\r\n\tfloralwhite: 0xFFFAF0,\r\n\tforestgreen: 0x228B22,\r\n\tfuchsia: 0xFF00FF,\r\n\tgainsboro: 0xDCDCDC,\r\n\tghostwhite: 0xF8F8FF,\r\n\tgold: 0xFFD700,\r\n\tgoldenrod: 0xDAA520,\r\n\tgray: 0x808080,\r\n\tgrey: 0x808080,\r\n\tgreen: 0x008000,\r\n\tgreenyellow: 0xADFF2F,\r\n\thoneydew: 0xF0FFF0,\r\n\thotpink: 0xFF69B4,\r\n\tindianred: 0xCD5C5C,\r\n\tindigo: 0x4B0082,\r\n\tivory: 0xFFFFF0,\r\n\tkhaki: 0xF0E68C,\r\n\tlavender: 0xE6E6FA,\r\n\tlavenderblush: 0xFFF0F5,\r\n\tlawngreen: 0x7CFC00,\r\n\tlemonchiffon: 0xFFFACD,\r\n\tlightblue: 0xADD8E6,\r\n\tlightcoral: 0xF08080,\r\n\tlightcyan: 0xE0FFFF,\r\n\tlightgoldenrodyellow: 0xFAFAD2,\r\n\tlightgray: 0xD3D3D3,\r\n\tlightgrey: 0xD3D3D3,\r\n\tlightgreen: 0x90EE90,\r\n\tlightpink: 0xFFB6C1,\r\n\tlightsalmon: 0xFFA07A,\r\n\tlightseagreen: 0x20B2AA,\r\n\tlightskyblue: 0x87CEFA,\r\n\tlightslategray: 0x778899,\r\n\tlightslategrey: 0x778899,\r\n\tlightsteelblue: 0xB0C4DE,\r\n\tlightyellow: 0xFFFFE0,\r\n\tlime: 0x00FF00,\r\n\tlimegreen: 0x32CD32,\r\n\tlinen: 0xFAF0E6,\r\n\tmagenta: 0xFF00FF,\r\n\tmaroon: 0x800000,\r\n\tmediumaquamarine: 0x66CDAA,\r\n\tmediumblue: 0x0000CD,\r\n\tmediumorchid: 0xBA55D3,\r\n\tmediumpurple: 0x9370DB,\r\n\tmediumseagreen: 0x3CB371,\r\n\tmediumslateblue: 0x7B68EE,\r\n\tmediumspringgreen: 0x00FA9A,\r\n\tmediumturquoise: 0x48D1CC,\r\n\tmediumvioletred: 0xC71585,\r\n\tmidnightblue: 0x191970,\r\n\tmintcream: 0xF5FFFA,\r\n\tmistyrose: 0xFFE4E1,\r\n\tmoccasin: 0xFFE4B5,\r\n\tnavajowhite: 0xFFDEAD,\r\n\tnavy: 0x000080,\r\n\toldlace: 0xFDF5E6,\r\n\tolive: 0x808000,\r\n\tolivedrab: 0x6B8E23,\r\n\torange: 0xFFA500,\r\n\torangered: 0xFF4500,\r\n\torchid: 0xDA70D6,\r\n\tpalegoldenrod: 0xEEE8AA,\r\n\tpalegreen: 0x98FB98,\r\n\tpaleturquoise: 0xAFEEEE,\r\n\tpalevioletred: 0xDB7093,\r\n\tpapayawhip: 0xFFEFD5,\r\n\tpeachpuff: 0xFFDAB9,\r\n\tperu: 0xCD853F,\r\n\tpink: 0xFFC0CB,\r\n\tplum: 0xDDA0DD,\r\n\tpowderblue: 0xB0E0E6,\r\n\tpurple: 0x800080,\r\n\trebeccapurple: 0x663399,\r\n\tred: 0xFF0000,\r\n\trosybrown: 0xBC8F8F,\r\n\troyalblue: 0x4169E1,\r\n\tsaddlebrown: 0x8B4513,\r\n\tsalmon: 0xFA8072,\r\n\tsandybrown: 0xF4A460,\r\n\tseagreen: 0x2E8B57,\r\n\tseashell: 0xFFF5EE,\r\n\tsienna: 0xA0522D,\r\n\tsilver: 0xC0C0C0,\r\n\tskyblue: 0x87CEEB,\r\n\tslateblue: 0x6A5ACD,\r\n\tslategray: 0x708090,\r\n\tslategrey: 0x708090,\r\n\tsnow: 0xFFFAFA,\r\n\tspringgreen: 0x00FF7F,\r\n\tsteelblue: 0x4682B4,\r\n\ttan: 0xD2B48C,\r\n\tteal: 0x008080,\r\n\tthistle: 0xD8BFD8,\r\n\ttomato: 0xFF6347,\r\n\tturquoise: 0x40E0D0,\r\n\tviolet: 0xEE82EE,\r\n\twheat: 0xF5DEB3,\r\n\twhite: 0xFFFFFF,\r\n\twhitesmoke: 0xF5F5F5,\r\n\tyellow: 0xFFFF00,\r\n\tyellowgreen: 0x9ACD32,\r\n};\r\n\r\nfor (const name in colorValues) {\r\n\tif (colorValues.hasOwnProperty(name)) {\r\n\t\tconst color = colorValues[name];\r\n\r\n\t\tColorNames[name] = `${Math.floor(color / 65536)},${Math.floor(color / 256 % 256)},${(color % 256)}`;\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Back easings, based on code from https://github.com/yuichiroharai/easeplus-velocity\r\n */\r\n\r\n// Project\r\nimport {registerEasing} from \"./easings\";\r\n\r\nexport function registerBackIn(name: string, amount: number) {\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn Math.pow(percentComplete, 2) * ((amount + 1) * percentComplete - amount) * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nexport function registerBackOut(name: string, amount: number) {\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn (Math.pow(--percentComplete, 2) * ((amount + 1) * percentComplete + amount) + 1) * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nexport function registerBackInOut(name: string, amount: number) {\r\n\tamount *= 1.525;\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\t\tpercentComplete *= 2;\r\n\r\n\t\treturn (percentComplete < 1\r\n\t\t\t? (Math.pow(percentComplete, 2) * ((amount + 1) * percentComplete - amount))\r\n\t\t\t: (Math.pow(percentComplete - 2, 2) * ((amount + 1) * (percentComplete - 2) + amount) + 2)\r\n\t\t) * 0.5 * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nregisterBackIn(\"easeInBack\", 1.7);\r\nregisterBackOut(\"easeOutBack\", 1.7);\r\nregisterBackInOut(\"easeInOutBack\", 1.7);\r\n\r\n// TODO: Expose these as actions to register custom easings?\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Bounce easings, based on code from https://github.com/yuichiroharai/easeplus-velocity\r\n */\r\n\r\n// Project\r\nimport {registerEasing} from \"./easings\";\r\n\r\nfunction easeOutBouncePercent(percentComplete: number): number {\r\n\tif (percentComplete < 1 / 2.75) {\r\n\t\treturn (7.5625 * percentComplete * percentComplete);\r\n\t}\r\n\tif (percentComplete < 2 / 2.75) {\r\n\t\treturn (7.5625 * (percentComplete -= 1.5 / 2.75) * percentComplete + 0.75);\r\n\t}\r\n\tif (percentComplete < 2.5 / 2.75) {\r\n\t\treturn (7.5625 * (percentComplete -= 2.25 / 2.75) * percentComplete + 0.9375);\r\n\t}\r\n\r\n\treturn (7.5625 * (percentComplete -= 2.625 / 2.75) * percentComplete + 0.984375);\r\n}\r\n\r\nfunction easeInBouncePercent(percentComplete: number): number {\r\n\treturn 1 - easeOutBouncePercent(1 - percentComplete);\r\n}\r\n\r\nexport function easeInBounce(percentComplete: number, startValue: number, endValue: number): number {\r\n\tif (percentComplete === 0) {\r\n\t\treturn startValue;\r\n\t}\r\n\tif (percentComplete === 1) {\r\n\t\treturn endValue;\r\n\t}\r\n\r\n\treturn easeInBouncePercent(percentComplete) * (endValue - startValue);\r\n}\r\n\r\nexport function easeOutBounce(percentComplete: number, startValue: number, endValue: number): number {\r\n\tif (percentComplete === 0) {\r\n\t\treturn startValue;\r\n\t}\r\n\tif (percentComplete === 1) {\r\n\t\treturn endValue;\r\n\t}\r\n\r\n\treturn easeOutBouncePercent(percentComplete) * (endValue - startValue);\r\n}\r\n\r\nexport function easeInOutBounce(percentComplete: number, startValue: number, endValue: number): number {\r\n\tif (percentComplete === 0) {\r\n\t\treturn startValue;\r\n\t}\r\n\tif (percentComplete === 1) {\r\n\t\treturn endValue;\r\n\t}\r\n\r\n\treturn (percentComplete < 0.5\r\n\t\t? easeInBouncePercent(percentComplete * 2) * 0.5\r\n\t\t: easeOutBouncePercent(percentComplete * 2 - 1) * 0.5 + 0.5\r\n\t) * (endValue - startValue);\r\n}\r\n\r\nregisterEasing([\"easeInBounce\", easeInBounce]);\r\nregisterEasing([\"easeOutBounce\", easeOutBounce]);\r\nregisterEasing([\"easeInOutBounce\", easeInOutBounce]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Elastic easings, based on code from https://github.com/yuichiroharai/easeplus-velocity\r\n */\r\n\r\n// Project\r\nimport {registerEasing} from \"./easings\";\r\n\r\n// Constants\r\nconst PI2 = Math.PI * 2;\r\n\r\nexport function registerElasticIn(name: string, amplitude: number, period: number) {\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn -(amplitude * Math.pow(2, 10 * (percentComplete -= 1)) * Math.sin((percentComplete - (period / PI2 * Math.asin(1 / amplitude))) * PI2 / period)) * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nexport function registerElasticOut(name: string, amplitude: number, period: number) {\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\r\n\t\treturn (amplitude * Math.pow(2, -10 * percentComplete) * Math.sin((percentComplete - (period / PI2 * Math.asin(1 / amplitude))) * PI2 / period) + 1) * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nexport function registerElasticInOut(name: string, amplitude: number, period: number) {\r\n\tregisterEasing([name, (percentComplete: number, startValue: number, endValue: number): number => {\r\n\t\tif (percentComplete === 0) {\r\n\t\t\treturn startValue;\r\n\t\t}\r\n\t\tif (percentComplete === 1) {\r\n\t\t\treturn endValue;\r\n\t\t}\r\n\t\tconst s = period / PI2 * Math.asin(1 / amplitude);\r\n\r\n\t\tpercentComplete = percentComplete * 2 - 1;\r\n\r\n\t\treturn (percentComplete < 0\r\n\t\t\t? -0.5 * (amplitude * Math.pow(2, 10 * percentComplete) * Math.sin((percentComplete - s) * PI2 / period))\r\n\t\t\t: amplitude * Math.pow(2, -10 * percentComplete) * Math.sin((percentComplete - s) * PI2 / period) * 0.5 + 1\r\n\t\t) * (endValue - startValue);\r\n\t}]);\r\n}\r\n\r\nregisterElasticIn(\"easeInElastic\", 1, 0.3);\r\nregisterElasticOut(\"easeOutElastic\", 1, 0.3);\r\nregisterElasticInOut(\"easeInOutElastic\", 1, 0.3 * 1.5);\r\n\r\n// TODO: Expose these as actions to register custom easings?\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Easings to act on strings, either set at the start or at the end depending on\r\n * need.\r\n */\r\n\r\n// Project\r\nimport {registerEasing} from \"./easings\";\r\n\r\n/**\r\n * Easing function that sets to the specified value immediately after the\r\n * animation starts.\r\n */\r\nexport function atStart(percentComplete: number, startValue: any, endValue: any): any {\r\n\treturn percentComplete === 0\r\n\t\t? startValue\r\n\t\t: endValue;\r\n}\r\n\r\n/**\r\n * Easing function that sets to the specified value while the animation is\r\n * running.\r\n */\r\nexport function during(percentComplete: number, startValue: any, endValue: any): any {\r\n\treturn percentComplete === 0 || percentComplete === 1\r\n\t\t? startValue\r\n\t\t: endValue;\r\n}\r\n\r\n/**\r\n * Easing function that sets to the specified value when the animation ends.\r\n */\r\nexport function atEnd(percentComplete: number, startValue: any, endValue: any): any {\r\n\treturn percentComplete === 1\r\n\t\t? endValue\r\n\t\t: startValue;\r\n}\r\n\r\nregisterEasing([\"at-start\", atStart]);\r\nregisterEasing([\"during\", during]);\r\nregisterEasing([\"at-end\", atEnd]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {augmentDimension} from \"../css/augmentDimension\";\r\nimport {setPropertyValue} from \"../css/setPropertyValue\";\r\nimport {registerNormalization} from \"./normalizations\";\r\n\r\n/**\r\n * Get/set the inner/outer dimension.\r\n */\r\nfunction getDimension(name: \"width\" | \"height\", wantInner: boolean) {\r\n\treturn ((element: HTMLorSVGElement, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue === undefined) {\r\n\t\t\treturn augmentDimension(element, name, wantInner) + \"px\";\r\n\t\t}\r\n\t\tsetPropertyValue(element, name, (parseFloat(propertyValue) - augmentDimension(element, name, wantInner)) + \"px\");\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\nregisterNormalization([\"Element\", \"innerWidth\", getDimension(\"width\", true)]);\r\nregisterNormalization([\"Element\", \"innerHeight\", getDimension(\"height\", true)]);\r\nregisterNormalization([\"Element\", \"outerWidth\", getDimension(\"width\", false)]);\r\nregisterNormalization([\"Element\", \"outerHeight\", getDimension(\"height\", false)]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {computePropertyValue} from \"../css/getPropertyValue\";\r\nimport {Data} from \"../data\";\r\nimport {registerNormalization} from \"./normalizations\";\r\n\r\n// Constants\r\nexport const inlineRx = /^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|let|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i,\r\n\tlistItemRx = /^(li)$/i,\r\n\ttableRowRx = /^(tr)$/i,\r\n\ttableRx = /^(table)$/i,\r\n\ttableRowGroupRx = /^(tbody)$/i;\r\n\r\n/**\r\n * Display has an extra value of \"auto\" that works out the correct value\r\n * based on the type of element.\r\n */\r\nfunction display(element: HTMLorSVGElement): string;\r\nfunction display(element: HTMLorSVGElement, propertyValue: string): void;\r\nfunction display(element: HTMLorSVGElement, propertyValue?: string): string | void {\r\n\tconst style = element.style;\r\n\r\n\tif (propertyValue === undefined) {\r\n\t\treturn computePropertyValue(element, \"display\");\r\n\t}\r\n\tif (propertyValue === \"auto\") {\r\n\t\tconst nodeName = element && element.nodeName,\r\n\t\t\tdata = Data(element);\r\n\r\n\t\tif (inlineRx.test(nodeName)) {\r\n\t\t\tpropertyValue = \"inline\";\r\n\t\t} else if (listItemRx.test(nodeName)) {\r\n\t\t\tpropertyValue = \"list-item\";\r\n\t\t} else if (tableRowRx.test(nodeName)) {\r\n\t\t\tpropertyValue = \"table-row\";\r\n\t\t} else if (tableRx.test(nodeName)) {\r\n\t\t\tpropertyValue = \"table\";\r\n\t\t} else if (tableRowGroupRx.test(nodeName)) {\r\n\t\t\tpropertyValue = \"table-row-group\";\r\n\t\t} else {\r\n\t\t\t// Default to \"block\" when no match is found.\r\n\t\t\tpropertyValue = \"block\";\r\n\t\t}\r\n\t\t// IMPORTANT: We need to do this as getPropertyValue bypasses the\r\n\t\t// Normalisation when it exists in the cache.\r\n\t\tdata.cache[\"display\"] = propertyValue;\r\n\t}\r\n\tstyle.display = propertyValue;\r\n}\r\n\r\nregisterNormalization([\"Element\", \"display\", display]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {getPropertyValue} from \"../css/getPropertyValue\";\r\nimport {registerNormalization} from \"./normalizations\";\r\n\r\n/**\r\n * Get the scrollWidth of an element.\r\n */\r\nfunction clientWidth(element: HTMLorSVGElement): string;\r\nfunction clientWidth(element: HTMLorSVGElement, propertyValue: string): void;\r\nfunction clientWidth(element: HTMLorSVGElement, propertyValue?: string): string | void {\r\n\tif (propertyValue == null) {\r\n\t\treturn element.clientWidth + \"px\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Get the scrollWidth of an element.\r\n */\r\nfunction scrollWidth(element: HTMLorSVGElement): string;\r\nfunction scrollWidth(element: HTMLorSVGElement, propertyValue: string): void;\r\nfunction scrollWidth(element: HTMLorSVGElement, propertyValue?: string): string | void {\r\n\tif (propertyValue == null) {\r\n\t\treturn element.scrollWidth + \"px\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Get the scrollHeight of an element.\r\n */\r\nfunction clientHeight(element: HTMLorSVGElement): string;\r\nfunction clientHeight(element: HTMLorSVGElement, propertyValue: string): void;\r\nfunction clientHeight(element: HTMLorSVGElement, propertyValue?: string): string | void {\r\n\tif (propertyValue == null) {\r\n\t\treturn element.clientHeight + \"px\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Get the scrollHeight of an element.\r\n */\r\nfunction scrollHeight(element: HTMLorSVGElement): string;\r\nfunction scrollHeight(element: HTMLorSVGElement, propertyValue: string): void;\r\nfunction scrollHeight(element: HTMLorSVGElement, propertyValue?: string): string | void {\r\n\tif (propertyValue == null) {\r\n\t\treturn element.scrollHeight + \"px\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Scroll an element.\r\n */\r\nfunction scroll(direction: \"Height\", end: \"Top\"): VelocityNormalizationsFn;\r\nfunction scroll(direction: \"Width\", end: \"Left\"): VelocityNormalizationsFn;\r\nfunction scroll(direction: \"Height\" | \"Width\", end: \"Top\" | \"Left\"): VelocityNormalizationsFn {\r\n\treturn ((element: HTMLorSVGElement, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue == null) {\r\n\t\t\t// Make sure we have these values cached.\r\n\t\t\tgetPropertyValue(element, \"client\" + direction, null, true);\r\n\t\t\tgetPropertyValue(element, \"scroll\" + direction, null, true);\r\n\r\n\t\t\treturn element[\"scroll\" + end] + \"px\";\r\n\t\t}\r\n\t\tconst value = parseFloat(propertyValue),\r\n\t\t\tunit = propertyValue.replace(String(value), \"\");\r\n\r\n\t\tswitch (unit) {\r\n\t\t\tcase \"\":\r\n\t\t\tcase \"px\":\r\n\t\t\t\telement[\"scroll\" + end] = value;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"%\":\r\n\t\t\t\tconst client = parseFloat(getPropertyValue(element, \"client\" + direction)),\r\n\t\t\t\t\tscrollValue = parseFloat(getPropertyValue(element, \"scroll\" + direction));\r\n\r\n\t\t\t\telement[\"scroll\" + end] = Math.max(0, scrollValue - client) * value / 100;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\nregisterNormalization([\"HTMLElement\", \"scroll\", scroll(\"Height\", \"Top\"), false]);\r\nregisterNormalization([\"HTMLElement\", \"scrollTop\", scroll(\"Height\", \"Top\"), false]);\r\nregisterNormalization([\"HTMLElement\", \"scrollLeft\", scroll(\"Width\", \"Left\"), false]);\r\nregisterNormalization([\"HTMLElement\", \"scrollWidth\", scrollWidth]);\r\nregisterNormalization([\"HTMLElement\", \"clientWidth\", clientWidth]);\r\nregisterNormalization([\"HTMLElement\", \"scrollHeight\", scrollHeight]);\r\nregisterNormalization([\"HTMLElement\", \"clientHeight\", clientHeight]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * This handles all CSS style properties. With browser prefixed properties it\r\n * will register a version that handles setting (and getting) both the prefixed\r\n * and non-prefixed version.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {ALL_VENDOR_PREFIXES} from \"../../constants\";\r\nimport {isString} from \"../../types\";\r\nimport {computePropertyValue} from \"../css/getPropertyValue\";\r\nimport {State} from \"../state\";\r\nimport {hasNormalization, registerNormalization} from \"./normalizations\";\r\n\r\n/**\r\n * An RegExp pattern for the following list of css words using\r\n * http://kemio.com.ar/tools/lst-trie-re.php to generate:\r\n *\r\n * blockSize\r\n * borderBottomLeftRadius\r\n * borderBottomRightRadius\r\n * borderBottomWidth\r\n * borderImageOutset\r\n * borderImageWidth\r\n * borderLeftWidth\r\n * borderRadius\r\n * borderRightWidth\r\n * borderSpacing\r\n * borderTopLeftRadius\r\n * borderTopRightRadius\r\n * borderTopWidth\r\n * borderWidth\r\n * bottom\r\n * columnGap\r\n * columnRuleWidth\r\n * columnWidth\r\n * flexBasis\r\n * fontSize\r\n * gridColumnGap\r\n * gridGap\r\n * gridRowGap\r\n * height\r\n * inlineSize\r\n * left\r\n * letterSpacing\r\n * margin\r\n * marginBottom\r\n * marginLeft\r\n * marginRight\r\n * marginTop\r\n * maxBlockSize\r\n * maxHeight\r\n * maxInlineSize\r\n * maxWidth\r\n * minBlockSize\r\n * minHeight\r\n * minInlineSize\r\n * minWidth\r\n * objectPosition\r\n * outlineOffset\r\n * outlineWidth\r\n * padding\r\n * paddingBottom\r\n * paddingLeft\r\n * paddingRight\r\n * paddingTop\r\n * perspective\r\n * right\r\n * shapeMargin\r\n * strokeDashoffset\r\n * strokeWidth\r\n * textIndent\r\n * top\r\n * transformOrigin\r\n * width\r\n * wordSpacing\r\n */\r\n// tslint:disable-next-line:max-line-length\r\nconst rxAddPx = /^(b(lockSize|o(rder(Bottom(LeftRadius|RightRadius|Width)|Image(Outset|Width)|LeftWidth|R(adius|ightWidth)|Spacing|Top(LeftRadius|RightRadius|Width)|Width)|ttom))|column(Gap|RuleWidth|Width)|f(lexBasis|ontSize)|grid(ColumnGap|Gap|RowGap)|height|inlineSize|le(ft|tterSpacing)|m(a(rgin(Bottom|Left|Right|Top)|x(BlockSize|Height|InlineSize|Width))|in(BlockSize|Height|InlineSize|Width))|o(bjectPosition|utline(Offset|Width))|p(adding(Bottom|Left|Right|Top)|erspective)|right|s(hapeMargin|troke(Dashoffset|Width))|t(extIndent|op|ransformOrigin)|w(idth|ordSpacing))$/;\r\n\r\n/**\r\n * Return a Normalisation that can be used to set / get a prefixed style\r\n * property.\r\n */\r\nfunction getSetPrefixed(propertyName: string, unprefixed: string) {\r\n\treturn ((element: HTMLorSVGElement, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue === undefined) {\r\n\t\t\treturn computePropertyValue(element, propertyName) || computePropertyValue(element, unprefixed);\r\n\t\t}\r\n\t\telement.style[propertyName] = element.style[unprefixed] = propertyValue;\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\n/**\r\n * Return a Normalisation that can be used to set / get a style property.\r\n */\r\nfunction getSetStyle(propertyName: string) {\r\n\treturn ((element: HTMLorSVGElement, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue === undefined) {\r\n\t\t\treturn computePropertyValue(element, propertyName);\r\n\t\t}\r\n\t\telement.style[propertyName] = propertyValue;\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\n/**\r\n * Vendor prefixes. Chrome / Safari, Firefox, IE / Edge, Opera.\r\n */\r\nconst rxVendors = /^(webkit|moz|ms|o)[A-Z]/,\r\n\tprefixElement = State.prefixElement;\r\n\r\nif (prefixElement) {\r\n\tfor (const propertyName in prefixElement.style) {\r\n\t\tif (rxVendors.test(propertyName)) {\r\n\t\t\tconst unprefixed = propertyName.replace(/^[a-z]+([A-Z])/, ($, letter: string) => letter.toLowerCase());\r\n\r\n\t\t\tif (ALL_VENDOR_PREFIXES || isString(prefixElement.style[unprefixed])) {\r\n\t\t\t\tconst addUnit = rxAddPx.test(unprefixed) ? \"px\" : undefined;\r\n\r\n\t\t\t\tregisterNormalization([\"Element\", unprefixed, getSetPrefixed(propertyName, unprefixed), addUnit]);\r\n\t\t\t}\r\n\t\t} else if (!hasNormalization([\"Element\", propertyName])) {\r\n\t\t\tconst addUnit = rxAddPx.test(propertyName) ? \"px\" : undefined;\r\n\r\n\t\t\tregisterNormalization([\"Element\", propertyName, getSetStyle(propertyName), addUnit]);\r\n\t\t}\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {VelocityNormalizationsFn} from \"../../../../velocity.d\";\r\n\r\n// Project\r\nimport {isFunction, isString} from \"../../../types\";\r\nimport {registerNormalization} from \"../normalizations\";\r\n\r\n/**\r\n * Get/set an attribute.\r\n */\r\nfunction getAttribute(name: string) {\r\n\treturn ((element: Element, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue === undefined) {\r\n\t\t\treturn element.getAttribute(name);\r\n\t\t}\r\n\t\telement.setAttribute(name, propertyValue);\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\nconst base = document.createElement(\"div\"),\r\n\trxSubtype = /^SVG(.*)Element$/,\r\n\trxElement = /Element$/;\r\n\r\nObject.getOwnPropertyNames(window)\r\n\t.forEach((property) => {\r\n\t\tconst subtype = rxSubtype.exec(property);\r\n\r\n\t\tif (subtype && subtype[1] !== \"SVG\") { // Don't do SVGSVGElement.\r\n\t\t\ttry {\r\n\t\t\t\tconst element = subtype[1] ? document.createElementNS(\"http://www.w3.org/2000/svg\", (subtype[1] || \"svg\").toLowerCase()) : document.createElement(\"svg\");\r\n\r\n\t\t\t\t// tslint:disable-next-line:forin\r\n\t\t\t\tfor (const attribute in element) {\r\n\t\t\t\t\t// Although this isn't a tween without prototypes, we do\r\n\t\t\t\t\t// want to get hold of all attributes and not just own ones.\r\n\t\t\t\t\tconst value = element[attribute];\r\n\r\n\t\t\t\t\tif (isString(attribute)\r\n\t\t\t\t\t\t&& !(attribute[0] === \"o\" && attribute[1] === \"n\")\r\n\t\t\t\t\t\t&& attribute !== attribute.toUpperCase()\r\n\t\t\t\t\t\t&& !rxElement.test(attribute)\r\n\t\t\t\t\t\t&& !(attribute in base)\r\n\t\t\t\t\t\t&& !isFunction(value)) {\r\n\t\t\t\t\t\t// TODO: Should this all be set on the generic SVGElement, it would save space and time, but not as powerful\r\n\t\t\t\t\t\tregisterNormalization([property, attribute, getAttribute(attribute)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(`VelocityJS: Error when trying to identify SVG attributes on ${property}.`, e);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement, VelocityNormalizationsFn} from \"../../../../velocity.d\";\r\n\r\n// Project\r\nimport {registerNormalization} from \"../normalizations\";\r\n\r\n/**\r\n * Get/set the width or height.\r\n */\r\nfunction getDimension(name: string) {\r\n\treturn ((element: HTMLorSVGElement, propertyValue?: string): string | void => {\r\n\t\tif (propertyValue === undefined) {\r\n\t\t\t// Firefox throws an error if .getBBox() is called on an SVG that isn't attached to the DOM.\r\n\t\t\ttry {\r\n\t\t\t\treturn (element as SVGGraphicsElement).getBBox()[name] + \"px\";\r\n\t\t\t} catch (e) {\r\n\t\t\t\treturn \"0px\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telement.setAttribute(name, propertyValue);\r\n\t}) as VelocityNormalizationsFn;\r\n}\r\n\r\nregisterNormalization([\"SVGElement\", \"width\", getDimension(\"width\")]);\r\nregisterNormalization([\"SVGElement\", \"height\", getDimension(\"height\")]);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {HTMLorSVGElement} from \"../../../velocity.d\";\r\n\r\n// Project\r\nimport {registerNormalization} from \"./normalizations\";\r\n\r\n/**\r\n * A fake normalization used to allow the \"tween\" property easy access.\r\n */\r\nfunction getSetTween(element: HTMLorSVGElement, propertyValue?: string) {\r\n\tif (propertyValue === undefined) {\r\n\t\treturn \"\";\r\n\t}\r\n}\r\n\r\nregisterNormalization([\"Element\", \"tween\", getSetTween]);\r\n","/*\n * velocity-animate (C) 2014-2017 Julian Shapiro.\n *\n * Licensed under the MIT license. See LICENSE file in the project root for details.\n */\n\n// Automatically generated\nexport const VERSION = \"2.0.5\";\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Extended Velocity members.\r\n */\r\n\r\n// Typedefs\r\nimport {\r\n\tSequenceList, StrictVelocityOptions, Velocity as VelocityPublic,\r\n\tVelocityActionFn, VelocityEasingFn, VelocityState,\r\n} from \"./../velocity.d\";\r\n\r\n// Project\r\nimport {defineProperty} from \"./utility\";\r\nimport {Actions as ActionsObject} from \"./Velocity/actions/actions\";\r\nimport {defaults as DefaultObject} from \"./Velocity/defaults\";\r\nimport {Easings as EasingsObject} from \"./Velocity/easing/easings\";\r\nimport {patch as patchFn} from \"./Velocity/patch\";\r\nimport {SequencesObject} from \"./Velocity/sequencesObject\";\r\nimport {State as StateObject} from \"./Velocity/state\";\r\nimport {Velocity as VelocityFn} from \"./velocityFn\";\r\n\r\n// Build the entire library, even optional bits.\r\nimport \"./Velocity/_all\";\r\n\r\n// Constants\r\nimport {VERSION} from \"../version\";\r\nconst Velocity: VelocityPublic = VelocityFn as any;\r\n\r\n/**\r\n * These parts of Velocity absolutely must be included, even if they're unused!\r\n */\r\nnamespace VelocityStatic {\r\n\t/**\r\n\t * Actions cannot be replaced if they are internal (hasOwnProperty is false\r\n\t * but they still exist). Otherwise they can be replaced by users.\r\n\t *\r\n\t * All external method calls should be using actions rather than sub-calls\r\n\t * of Velocity itself.\r\n\t */\r\n\texport const Actions: {[name: string]: VelocityActionFn} = ActionsObject;\r\n\r\n\t/**\r\n\t * Our known easing functions.\r\n\t */\r\n\texport const Easings: {[name: string]: VelocityEasingFn} = EasingsObject;\r\n\r\n\t/**\r\n\t * The currently registered sequences.\r\n\t */\r\n\texport const Sequences: {[name: string]: SequenceList} = SequencesObject;\r\n\r\n\t/**\r\n\t * Current internal state of Velocity.\r\n\t */\r\n\texport const State: VelocityState = StateObject; // tslint:disable-line:no-shadowed-variable\r\n\r\n\t/**\r\n\t * Velocity option defaults, which can be overriden by the user.\r\n\t */\r\n\texport const defaults: StrictVelocityOptions & {reset?: () => void} = DefaultObject as any;\r\n\r\n\t/**\r\n\t * Used to patch any object to allow Velocity chaining. In order to chain an\r\n\t * object must either be treatable as an array - with a <code>.length</code>\r\n\t * property, and each member a Node, or a Node directly.\r\n\t *\r\n\t * By default Velocity will try to patch <code>window</code>,\r\n\t * <code>jQuery</code>, <code>Zepto</code>, and several classes that return\r\n\t * Nodes or lists of Nodes.\r\n\t */\r\n\texport const patch = patchFn;\r\n\r\n\t/**\r\n\t * Set to true, 1 or 2 (most verbose) to output debug info to console.\r\n\t */\r\n\texport let debug: boolean | 1 | 2 = false;\r\n\r\n\t/**\r\n\t * In mock mode, all animations are forced to complete immediately upon the\r\n\t * next rAF tick. If there are further animations queued then they will each\r\n\t * take one single frame in turn. Loops and repeats will be disabled while\r\n\t * <code>mock = true</code>.\r\n\t */\r\n\texport let mock: boolean = false;\r\n\r\n\t/**\r\n\t * Save our version number somewhere visible.\r\n\t */\r\n\texport const version = VERSION;\r\n\r\n\t/**\r\n\t * Added as a fallback for \"import {Velocity} from 'velocity-animate';\".\r\n\t */\r\n\texport const Velocity: VelocityPublic = VelocityFn as any; // tslint:disable-line:no-shadowed-variable\r\n}\r\n\r\n/* IE detection. Gist: https://gist.github.com/julianshapiro/9098609 */\r\nconst IE = (() => {\r\n\tinterface IEDocument extends Document {\r\n\t\tdocumentMode: any; // IE\r\n\t}\r\n\r\n\tif ((document as IEDocument).documentMode) {\r\n\t\treturn (document as IEDocument).documentMode;\r\n\t} else {\r\n\t\tfor (let i = 7; i > 4; i--) {\r\n\t\t\tlet div = document.createElement(\"div\");\r\n\r\n\t\t\tdiv.innerHTML = `<!${\"--\"}[if IE ${i}]><span></span><![endif]-->`;\r\n\t\t\tif (div.getElementsByTagName(\"span\").length) {\r\n\t\t\t\tdiv = null;\r\n\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn undefined;\r\n})();\r\n\r\n/******************\r\n Unsupported\r\n ******************/\r\n\r\nif (IE <= 8) {\r\n\tthrow new Error(\"VelocityJS cannot run on Internet Explorer 8 or earlier\");\r\n}\r\n\r\n/******************\r\n Frameworks\r\n ******************/\r\n\r\nif (window) {\r\n\t/*\r\n\t * Both jQuery and Zepto allow their $.fn object to be extended to allow\r\n\t * wrapped elements to be subjected to plugin calls. If either framework is\r\n\t * loaded, register a \"velocity\" extension pointing to Velocity's core\r\n\t * animate() method. Velocity also registers itself onto a global container\r\n\t * (window.jQuery || window.Zepto || window) so that certain features are\r\n\t * accessible beyond just a per-element scope. Accordingly, Velocity can\r\n\t * both act on wrapped DOM elements and stand alone for targeting raw DOM\r\n\t * elements.\r\n\t */\r\n\tconst jQuery: {fn: any} = (window as any).jQuery,\r\n\t\tZepto: {fn: any} = (window as any).Zepto;\r\n\r\n\tpatchFn(window, true);\r\n\tpatchFn(Element && Element.prototype);\r\n\tpatchFn(NodeList && NodeList.prototype);\r\n\tpatchFn(HTMLCollection && HTMLCollection.prototype);\r\n\r\n\tpatchFn(jQuery, true);\r\n\tpatchFn(jQuery && jQuery.fn);\r\n\r\n\tpatchFn(Zepto, true);\r\n\tpatchFn(Zepto && Zepto.fn);\r\n}\r\n\r\n// Make sure that the values within Velocity are read-only and upatchable.\r\nfor (const property in VelocityStatic) {\r\n\tif (VelocityStatic.hasOwnProperty(property)) {\r\n\t\tswitch (typeof property) {\r\n\t\t\tcase \"number\":\r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tdefineProperty(Velocity, property, {\r\n\t\t\t\t\tget() {\r\n\t\t\t\t\t\treturn VelocityStatic[property];\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset(value) {\r\n\t\t\t\t\t\tVelocityStatic[property] = value;\r\n\t\t\t\t\t},\r\n\t\t\t\t}, true);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tdefineProperty(Velocity, property, VelocityStatic[property], true);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObject.freeze(Velocity);\r\n\r\nexport default Velocity; // tslint:disable-line:no-default-export\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Typedefs\r\nimport {AnimationCall, SequenceList, VelocitySequence, VelocityTween} from \"../../velocity.d\";\r\n\r\n// Project\r\nimport {isNumber, isPlainObject, isString} from \"../types\";\r\nimport Velocity from \"../velocity\";\r\nimport {registerAction} from \"./actions/actions\";\r\nimport {camelCase} from \"./camelCase\";\r\nimport {getNormalization} from \"./normalizations/normalizations\";\r\nimport {validateDuration, validateEasing} from \"./options\";\r\nimport {SequencesObject} from \"./sequencesObject\";\r\nimport {findPattern} from \"./tweens\";\r\n\r\n// Constants\r\nimport {DEFAULT_DURATION} from \"../constants\";\r\n\r\nconst rxPercents = /(\\d*\\.\\d+|\\d+\\.?|from|to)/g;\r\n\r\nexport function expandSequence(animation: AnimationCall, sequence: SequenceList) {\r\n\tconst tweens = animation.tweens = Object.create(null),\r\n\t\telement = animation.element;\r\n\r\n\tfor (const propertyName in sequence.tweens) {\r\n\t\tif (sequence.tweens.hasOwnProperty(propertyName)) {\r\n\t\t\tconst fn = getNormalization(element, propertyName);\r\n\r\n\t\t\tif (!fn && propertyName !== \"tween\") {\r\n\t\t\t\tif (Velocity.debug) {\r\n\t\t\t\t\tconsole.log(`Skipping [${propertyName}] due to a lack of browser support.`);\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttweens[propertyName] = {\r\n\t\t\t\tfn,\r\n\t\t\t\tsequence: sequence.tweens[propertyName],\r\n\t\t\t} as VelocityTween;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Used to register a sequence. This should never be called by users\r\n * directly, instead it should be called via an action:<br/>\r\n * <code>Velocity(\"registerSequence\", \"\"name\", VelocitySequence);</code>\r\n */\r\nexport function registerSequence(args?: [string, VelocitySequence] | [{[name: string]: VelocitySequence}]) {\r\n\tif (isPlainObject(args[0])) {\r\n\t\tfor (const name in (args[0] as {[name: string]: VelocitySequence})) {\r\n\t\t\tif (args[0].hasOwnProperty(name)) {\r\n\t\t\t\tregisterSequence([name, args[0][name]]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (isString(args[0])) {\r\n\t\tconst name = args[0] as string,\r\n\t\t\tsequence = args[1] as VelocitySequence;\r\n\r\n\t\tif (!isString(name)) {\r\n\t\t\tconsole.warn(`VelocityJS: Trying to set 'registerSequence' name to an invalid value:`, name);\r\n\t\t} else if (!isPlainObject(sequence)) {\r\n\t\t\tconsole.warn(`VelocityJS: Trying to set 'registerSequence' sequence to an invalid value:`, name, sequence);\r\n\t\t} else {\r\n\t\t\tif (SequencesObject[name]) {\r\n\t\t\t\tconsole.warn(`VelocityJS: Replacing named sequence:`, name);\r\n\t\t\t}\r\n\t\t\tconst percents: {[key: string]: string[]} = {},\r\n\t\t\t\tsteps: string[] = new Array(100),\r\n\t\t\t\tproperties: string[] = [],\r\n\t\t\t\tpercentages: string[] = [],\r\n\t\t\t\tsequenceList: SequenceList = SequencesObject[name] = {} as any,\r\n\t\t\t\tduration = validateDuration((sequence as any).duration);\r\n\r\n\t\t\tsequenceList.tweens = {};\r\n\t\t\tif (isNumber(duration)) {\r\n\t\t\t\tsequenceList.duration = duration;\r\n\t\t\t}\r\n\t\t\tfor (const part in sequence) {\r\n\t\t\t\tif (sequence.hasOwnProperty(part)) {\r\n\t\t\t\t\tconst keys = String(part)\r\n\t\t\t\t\t\t.match(rxPercents);\r\n\r\n\t\t\t\t\tif (keys) {\r\n\t\t\t\t\t\tpercentages.push(part);\r\n\t\t\t\t\t\tfor (const key of keys) {\r\n\t\t\t\t\t\t\tconst percent = key === \"from\"\r\n\t\t\t\t\t\t\t\t? 0\r\n\t\t\t\t\t\t\t\t: key === \"to\"\r\n\t\t\t\t\t\t\t\t\t? 100\r\n\t\t\t\t\t\t\t\t\t: parseFloat(key);\r\n\r\n\t\t\t\t\t\t\tif (percent < 0 || percent > 100) {\r\n\t\t\t\t\t\t\t\tconsole.warn(`VelocityJS: Trying to use an invalid value as a percentage (0 <= n <= 100):`, name, percent);\r\n\t\t\t\t\t\t\t} else if (isNaN(percent)) {\r\n\t\t\t\t\t\t\t\tconsole.warn(`VelocityJS: Trying to use an invalid number as a percentage:`, name, part, key);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (!percents[String(percent)]) {\r\n\t\t\t\t\t\t\t\t\tpercents[String(percent)] = [];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tpercents[String(percent)].push(part);\r\n\t\t\t\t\t\t\t\tfor (const property in sequence[part]) {\r\n\t\t\t\t\t\t\t\t\tif (!properties.includes(property)) {\r\n\t\t\t\t\t\t\t\t\t\tproperties.push(property);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst orderedPercents = Object.keys(percents)\r\n\t\t\t\t.sort((a, b) => {\r\n\t\t\t\t\tconst a1 = parseFloat(a),\r\n\t\t\t\t\t\tb1 = parseFloat(b);\r\n\r\n\t\t\t\t\treturn a1 > b1 ? 1 : a1 < b1 ? -1 : 0;\r\n\t\t\t\t});\r\n\r\n\t\t\torderedPercents.forEach((key) => {\r\n\t\t\t\tsteps.push.apply(percents[key]);\r\n\t\t\t});\r\n\t\t\tfor (const property of properties) {\r\n\t\t\t\tconst parts: string[] = [],\r\n\t\t\t\t\tpropertyName = camelCase(property);\r\n\r\n\t\t\t\tfor (const key of orderedPercents) {\r\n\t\t\t\t\tfor (const value of percents[key]) {\r\n\t\t\t\t\t\tconst stepProperties = sequence[value];\r\n\r\n\t\t\t\t\t\tif (stepProperties[propertyName]) {\r\n\t\t\t\t\t\t\tparts.push(isString(stepProperties[propertyName])\r\n\t\t\t\t\t\t\t\t? stepProperties[propertyName]\r\n\t\t\t\t\t\t\t\t: stepProperties[propertyName][0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (parts.length) {\r\n\t\t\t\t\tconst realSequence = findPattern(parts, propertyName);\r\n\t\t\t\t\tlet index = 0;\r\n\r\n\t\t\t\t\tif (realSequence) {\r\n\t\t\t\t\t\tfor (const key of orderedPercents) {\r\n\t\t\t\t\t\t\tfor (const value of percents[key]) {\r\n\t\t\t\t\t\t\t\tconst originalProperty = sequence[value][propertyName];\r\n\r\n\t\t\t\t\t\t\t\tif (originalProperty) {\r\n\t\t\t\t\t\t\t\t\tif (Array.isArray(originalProperty) && originalProperty.length > 1 && (isString(originalProperty[1]) || Array.isArray(originalProperty[1]))) {\r\n\t\t\t\t\t\t\t\t\t\trealSequence[index].easing = validateEasing(originalProperty[1], sequenceList.duration || DEFAULT_DURATION);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\trealSequence[index++].percent = parseFloat(key) / 100;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsequenceList.tweens[propertyName] = realSequence;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nregisterAction([\"registerSequence\", registerSequence], true);\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Core \"Velocity\" function.\r\n */\r\n\r\n// Typedefs\r\nimport {\r\n\tAnimationCall, AnimationFlags, HTMLorSVGElement, Properties, StrictVelocityOptions,\r\n\tVelocityElements, VelocityObjectArgs, VelocityOptionFn, VelocityOptions, VelocityPromise,\r\n\tVelocityProperty, VelocityResult,\r\n} from \"./../velocity.d\";\r\n\r\n// Project\r\nimport {isBoolean, isFunction, isNode, isNumber, isPlainObject, isString, isVelocityResult, isWrapped} from \"./types\";\r\nimport {cloneArray, defineProperty, getValue} from \"./utility\";\r\nimport {Data} from \"./Velocity/data\";\r\nimport {\r\n\tvalidateBegin, validateComplete, validateDelay, validateDuration, validateEasing,\r\n\tvalidateLoop, validateProgress, validateQueue, validateRepeat, validateSpeed, validateSync,\r\n} from \"./Velocity/options\";\r\nimport {patch as patchFn} from \"./Velocity/patch\";\r\nimport {queue} from \"./Velocity/queue\";\r\nimport {expandSequence} from \"./Velocity/sequences\";\r\nimport {tick} from \"./Velocity/tick\";\r\nimport {expandProperties} from \"./Velocity/tweens\";\r\n\r\nimport {Actions as ActionsObject} from \"./Velocity/actions/actions\";\r\nimport {defaults as DefaultObject} from \"./Velocity/defaults\";\r\nimport {SequencesObject} from \"./Velocity/sequencesObject\";\r\nimport {State as StateObject} from \"./Velocity/state\";\r\n\r\nlet globalPromise: PromiseConstructor;\r\n\r\ntry {\r\n\tglobalPromise = Promise;\r\n} catch {/**/}\r\n\r\nconst noPromiseOption = \", if that is deliberate then pass `promiseRejectEmpty:false` as an option\";\r\n\r\n/**\r\n * Patch a VelocityResult with a Promise.\r\n */\r\nfunction patchPromise(promiseObject: Promise<any>, result: VelocityResult) {\r\n\tdefineProperty(result, \"promise\", promiseObject);\r\n\tdefineProperty(result, \"then\", promiseObject.then.bind(promiseObject));\r\n\tdefineProperty(result, \"catch\", promiseObject.catch.bind(promiseObject));\r\n\tif ((promiseObject as any).finally) {\r\n\t\t// Semi-standard\r\n\t\tdefineProperty(result, \"finally\", (promiseObject as any).finally.bind(promiseObject));\r\n\t}\r\n}\r\n\r\n/* tslint:disable:max-line-length */\r\n/**\r\n * The main Velocity function. Acts as a gateway to everything else.\r\n */\r\nexport function Velocity(options: VelocityObjectArgs): VelocityResult;\r\nexport function Velocity(elements: VelocityElements, propertyMap: string | Properties<VelocityProperty>, options?: VelocityOptions): VelocityResult;\r\nexport function Velocity(elements: VelocityElements, propertyMap: string | Properties<VelocityProperty>, duration?: number | \"fast\" | \"normal\" | \"slow\", complete?: () => void): VelocityResult;\r\nexport function Velocity(elements: VelocityElements, propertyMap: string | Properties<VelocityProperty>, complete?: () => void): VelocityResult;\r\nexport function Velocity(elements: VelocityElements, propertyMap: string | Properties<VelocityProperty>, easing?: string | number[], complete?: () => void): VelocityResult;\r\nexport function Velocity(elements: VelocityElements, propertyMap: string | Properties<VelocityProperty>, duration?: number | \"fast\" | \"normal\" | \"slow\", easing?: string | number[], complete?: () => void): VelocityResult;\r\nexport function Velocity(this: VelocityElements, propertyMap: string | Properties<VelocityProperty>, duration?: number | \"fast\" | \"normal\" | \"slow\", complete?: () => void): VelocityResult;\r\nexport function Velocity(this: VelocityElements, propertyMap: string | Properties<VelocityProperty>, complete?: () => void): VelocityResult;\r\nexport function Velocity(this: VelocityElements, propertyMap: string | Properties<VelocityProperty>, easing?: string | number[], complete?: () => void): VelocityResult;\r\nexport function Velocity(this: VelocityElements, propertyMap: string | Properties<VelocityProperty>, duration?: number | \"fast\" | \"normal\" | \"slow\", easing?: string | number[], complete?: () => void): VelocityResult;\r\n/* tslint:enable:max-line-length */\r\nexport function Velocity(this: VelocityElements | void, ...argsList: any[]): VelocityResult {\r\n\tconst\r\n\t\t/**\r\n\t\t * A shortcut to the default options.\r\n\t\t */\r\n\t\tdefaults = DefaultObject,\r\n\t\t/**\r\n\t\t * Shortcut to arguments for file size.\r\n\t\t */\r\n\t\targs = arguments,\r\n\t\t/**\r\n\t\t * Cache of the first argument - this is used often enough to be saved.\r\n\t\t */\r\n\t\targs0 = args[0] as VelocityObjectArgs,\r\n\t\t/**\r\n\t\t * To allow for expressive CoffeeScript code, Velocity supports an\r\n\t\t * alternative syntax in which \"elements\" (or \"e\"), \"properties\" (or\r\n\t\t * \"p\"), and \"options\" (or \"o\") objects are defined on a container\r\n\t\t * object that's passed in as Velocity's sole argument.\r\n\t\t *\r\n\t\t * Note: Some browsers automatically populate arguments with a\r\n\t\t * \"properties\" object. We detect it by checking for its default\r\n\t\t * \"names\" property.\r\n\t\t */\r\n\t\t// TODO: Confirm which browsers - if <=IE8 the we can drop completely\r\n\t\tsyntacticSugar = isPlainObject(args0) && (args0.p || ((isPlainObject(args0.properties) && !(args0.properties as any).names) || isString(args0.properties)));\r\n\tlet\r\n\t\t/**\r\n\t\t *  When Velocity is called via the utility function (Velocity()),\r\n\t\t * elements are explicitly passed in as the first parameter. Thus,\r\n\t\t * argument positioning varies.\r\n\t\t */\r\n\t\targumentIndex: number = 0,\r\n\t\t/**\r\n\t\t * The list of elements, extended with Promise and Velocity.\r\n\t\t */\r\n\t\telements: VelocityResult,\r\n\t\t/**\r\n\t\t * The properties being animated. This can be a string, in which case it\r\n\t\t * is either a function for these elements, or it is a \"named\" animation\r\n\t\t * sequence to use instead. Named sequences start with either \"callout.\"\r\n\t\t * or \"transition.\". When used as a callout the values will be reset\r\n\t\t * after finishing. When used as a transtition then there is no special\r\n\t\t * handling after finishing.\r\n\t\t */\r\n\t\tpropertiesMap: string | Properties<VelocityProperty>,\r\n\t\t/**\r\n\t\t * Options supplied, this will be mapped and validated into\r\n\t\t * <code>options</code>.\r\n\t\t */\r\n\t\toptionsMap: VelocityOptions,\r\n\t\t/**\r\n\t\t * If called via a chain then this contains the <b>last</b> calls\r\n\t\t * animations. If this does not have a value then any access to the\r\n\t\t * element's animations needs to be to the currently-running ones.\r\n\t\t */\r\n\t\tanimations: AnimationCall[],\r\n\t\t/**\r\n\t\t * The promise that is returned.\r\n\t\t */\r\n\t\tpromise: Promise<VelocityResult>,\r\n\t\t// Used when the animation is finished\r\n\t\tresolver: (value?: VelocityResult) => void,\r\n\t\t// Used when there was an issue with one or more of the Velocity arguments\r\n\t\trejecter: (reason: any) => void;\r\n\r\n\t//console.log(`Velocity`, _arguments)\r\n\t// First get the elements, and the animations connected to the last call if\r\n\t// this is chained.\r\n\t// TODO: Clean this up a bit\r\n\t// TODO: Throw error if the chain is called with elements as the first argument. isVelocityResult(this) && ( (isNode(arg0) || isWrapped(arg0)) && arg0 == this)\r\n\tif (isNode(this)) {\r\n\t\t// This is from a chain such as document.getElementById(\"\").velocity(...)\r\n\t\telements = [this as HTMLorSVGElement] as VelocityResult;\r\n\t} else if (isWrapped(this)) {\r\n\t\t// This might be a chain from something else, but if chained from a\r\n\t\t// previous Velocity() call then grab the animations it's related to.\r\n\t\telements = cloneArray(this as HTMLorSVGElement[]) as VelocityResult;\r\n\t\tif (isVelocityResult(this)) {\r\n\t\t\tanimations = (this as VelocityResult).velocity.animations;\r\n\t\t}\r\n\t} else if (syntacticSugar) {\r\n\t\telements = cloneArray(args0.elements || args0.e) as VelocityResult;\r\n\t\targumentIndex++;\r\n\t} else if (isNode(args0)) {\r\n\t\telements = cloneArray([args0]) as VelocityResult;\r\n\t\targumentIndex++;\r\n\t} else if (isWrapped(args0)) {\r\n\t\telements = cloneArray(args0) as VelocityResult;\r\n\t\targumentIndex++;\r\n\t}\r\n\t// Allow elements to be chained.\r\n\tif (elements) {\r\n\t\tdefineProperty(elements, \"velocity\", Velocity.bind(elements));\r\n\t\tif (animations) {\r\n\t\t\tdefineProperty(elements.velocity, \"animations\", animations);\r\n\t\t}\r\n\t}\r\n\t// Next get the propertiesMap and options.\r\n\tif (syntacticSugar) {\r\n\t\tpropertiesMap = getValue(args0.properties, args0.p);\r\n\t} else {\r\n\t\t// TODO: Should be possible to call Velocity(\"pauseAll\") - currently not possible\r\n\t\tpropertiesMap = args[argumentIndex++] as string | Properties<VelocityProperty>;\r\n\t}\r\n\t// Get any options map passed in as arguments first, expand any direct\r\n\t// options if possible.\r\n\tconst isReverse = propertiesMap === \"reverse\",\r\n\t\tisAction = !isReverse && isString(propertiesMap),\r\n\t\tmaybeSequence = isAction && SequencesObject[propertiesMap as string],\r\n\t\topts = syntacticSugar ? getValue(args0.options, args0.o) : args[argumentIndex];\r\n\r\n\tif (isPlainObject(opts)) {\r\n\t\toptionsMap = opts;\r\n\t}\r\n\t// Create the promise if supported and wanted.\r\n\tif (globalPromise && getValue(optionsMap && optionsMap.promise, defaults.promise)) {\r\n\t\tpromise = new globalPromise((resolve, reject) => {\r\n\t\t\trejecter = reject;\r\n\t\t\t// IMPORTANT:\r\n\t\t\t// If a resolver tries to run on a Promise then it will wait until\r\n\t\t\t// that Promise resolves - but in this case we're running on our own\r\n\t\t\t// Promise, so need to make sure it's not seen as one. Removing\r\n\t\t\t// these values for the duration of the resolve.\r\n\t\t\t// Due to being an async call, they should be back to \"normal\"\r\n\t\t\t// before the <code>.then()</code> function gets called.\r\n\t\t\tresolver = (result: VelocityResult) => {\r\n\t\t\t\tif (isVelocityResult(result) && result.promise) {\r\n\t\t\t\t\tdelete result.then;\r\n\t\t\t\t\tdelete result.catch;\r\n\t\t\t\t\tdelete (result as any).finally;\r\n\t\t\t\t\tresolve(result);\r\n\t\t\t\t\tpatchPromise(result.promise, result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(result);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t\tif (elements) {\r\n\t\t\tpatchPromise(promise, elements);\r\n\t\t}\r\n\t}\r\n\tif (promise) {\r\n\t\tconst optionPromiseRejectEmpty = optionsMap && optionsMap.promiseRejectEmpty,\r\n\t\t\tpromiseRejectEmpty: boolean = getValue(optionPromiseRejectEmpty, defaults.promiseRejectEmpty);\r\n\r\n\t\tif (!elements && !isAction) {\r\n\t\t\tif (promiseRejectEmpty) {\r\n\t\t\t\trejecter(`Velocity: No elements supplied${isBoolean(optionPromiseRejectEmpty) ? \"\" : noPromiseOption}. Aborting.`);\r\n\t\t\t} else {\r\n\t\t\t\tresolver();\r\n\t\t\t}\r\n\t\t} else if (!propertiesMap) {\r\n\t\t\tif (promiseRejectEmpty) {\r\n\t\t\t\trejecter(`Velocity: No properties supplied${isBoolean(optionPromiseRejectEmpty) ? \"\" : noPromiseOption}. Aborting.`);\r\n\t\t\t} else {\r\n\t\t\t\tresolver();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif ((!elements && !isAction) || !propertiesMap) {\r\n\t\treturn promise as any;\r\n\t}\r\n\r\n\t// NOTE: Can't use isAction here due to type inference - there are callbacks\r\n\t// between so the type isn't considered safe.\r\n\tif (isAction) {\r\n\t\tconst actionArgs: any[] = [],\r\n\t\t\tpromiseHandler: VelocityPromise = promise && {\r\n\t\t\t\t_promise: promise,\r\n\t\t\t\t_resolver: resolver,\r\n\t\t\t\t_rejecter: rejecter,\r\n\t\t\t};\r\n\r\n\t\twhile (argumentIndex < args.length) {\r\n\t\t\tactionArgs.push(args[argumentIndex++]);\r\n\t\t}\r\n\r\n\t\t// Velocity's behavior is categorized into \"actions\". If a string is\r\n\t\t// passed in instead of a propertiesMap then that will call a function\r\n\t\t// to do something special to the animation linked.\r\n\t\t// There is one special case - \"reverse\" - which is handled differently,\r\n\t\t// by being stored on the animation and then expanded when the animation\r\n\t\t// starts.\r\n\t\tconst action = (propertiesMap as string).replace(/\\..*$/, \"\"),\r\n\t\t\tcallback = ActionsObject[action];\r\n\r\n\t\tif (callback) {\r\n\t\t\tconst result = callback(actionArgs, elements, promiseHandler, propertiesMap as string);\r\n\r\n\t\t\tif (result !== undefined) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\r\n\t\t\treturn elements || promise as any;\r\n\t\t} else if (!maybeSequence) {\r\n\t\t\tconsole.error(`VelocityJS: First argument (${propertiesMap}) was not a property map, a known action, or a registered redirect. Aborting.`);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tlet hasValidDuration: boolean;\r\n\r\n\tif (isPlainObject(propertiesMap) || isReverse || maybeSequence) {\r\n\t\t/**\r\n\t\t * The options for this set of animations.\r\n\t\t */\r\n\t\tconst options: StrictVelocityOptions = {};\r\n\t\tlet isSync = defaults.sync;\r\n\r\n\t\t// Private options first - set as non-enumerable, and starting with an\r\n\t\t// underscore so we can filter them out.\r\n\t\tif (promise) {\r\n\t\t\tdefineProperty(options, \"_promise\", promise);\r\n\t\t\tdefineProperty(options, \"_rejecter\", rejecter);\r\n\t\t\tdefineProperty(options, \"_resolver\", resolver);\r\n\t\t}\r\n\t\tdefineProperty(options, \"_ready\", 0);\r\n\t\tdefineProperty(options, \"_started\", 0);\r\n\t\tdefineProperty(options, \"_completed\", 0);\r\n\t\tdefineProperty(options, \"_total\", 0);\r\n\r\n\t\t// Now check the optionsMap\r\n\t\tif (isPlainObject(optionsMap)) {\r\n\t\t\tconst validDuration = validateDuration(optionsMap.duration);\r\n\r\n\t\t\thasValidDuration = validDuration !== undefined;\r\n\t\t\toptions.duration = getValue(validDuration, defaults.duration);\r\n\t\t\toptions.delay = getValue(validateDelay(optionsMap.delay), defaults.delay);\r\n\t\t\t// Need the extra fallback here in case it supplies an invalid\r\n\t\t\t// easing that we need to overrride with the default.\r\n\t\t\toptions.easing = validateEasing(getValue(optionsMap.easing, defaults.easing), options.duration) || validateEasing(defaults.easing, options.duration);\r\n\t\t\toptions.loop = getValue(validateLoop(optionsMap.loop), defaults.loop);\r\n\t\t\toptions.repeat = options.repeatAgain = getValue(validateRepeat(optionsMap.repeat), defaults.repeat);\r\n\t\t\tif (optionsMap.speed != null) {\r\n\t\t\t\toptions.speed = getValue(validateSpeed(optionsMap.speed), 1);\r\n\t\t\t}\r\n\t\t\tif (isBoolean(optionsMap.promise)) {\r\n\t\t\t\toptions.promise = optionsMap.promise;\r\n\t\t\t}\r\n\t\t\toptions.queue = getValue(validateQueue(optionsMap.queue), defaults.queue);\r\n\t\t\tif (optionsMap.mobileHA && !StateObject.isGingerbread) {\r\n\t\t\t\t/* When set to true, and if this is a mobile device, mobileHA automatically enables hardware acceleration (via a null transform hack)\r\n\t\t\t\t on animating elements. HA is removed from the element at the completion of its animation. */\r\n\t\t\t\t/* Note: Android Gingerbread doesn't support HA. If a null transform hack (mobileHA) is in fact set, it will prevent other tranform subproperties from taking effect. */\r\n\t\t\t\t/* Note: You can read more about the use of mobileHA in Velocity's documentation: velocity-animate/#mobileHA. */\r\n\t\t\t\toptions.mobileHA = true;\r\n\t\t\t}\r\n\t\t\tif (optionsMap.drag === true) {\r\n\t\t\t\toptions.drag = true;\r\n\t\t\t}\r\n\t\t\tif (isNumber(optionsMap.stagger) || isFunction(optionsMap.stagger)) {\r\n\t\t\t\toptions.stagger = optionsMap.stagger;\r\n\t\t\t}\r\n\t\t\tif (!isReverse) {\r\n\t\t\t\tif (optionsMap[\"display\"] != null) {\r\n\t\t\t\t\t(propertiesMap as Properties<VelocityProperty>).display = optionsMap[\"display\"] as string;\r\n\t\t\t\t\tconsole.error(`Deprecated \"options.display\" used, this is now a property:`, optionsMap[\"display\"]);\r\n\t\t\t\t}\r\n\t\t\t\tif (optionsMap[\"visibility\"] != null) {\r\n\t\t\t\t\t(propertiesMap as Properties<VelocityProperty>).visibility = optionsMap[\"visibility\"] as string;\r\n\t\t\t\t\tconsole.error(`Deprecated \"options.visibility\" used, this is now a property:`, optionsMap[\"visibility\"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// TODO: Allow functional options for different options per element\r\n\t\t\tconst optionsBegin = validateBegin(optionsMap.begin),\r\n\t\t\t\toptionsComplete = validateComplete(optionsMap.complete),\r\n\t\t\t\toptionsProgress = validateProgress(optionsMap.progress),\r\n\t\t\t\toptionsSync = validateSync(optionsMap.sync);\r\n\r\n\t\t\tif (optionsBegin != null) {\r\n\t\t\t\toptions.begin = optionsBegin;\r\n\t\t\t}\r\n\t\t\tif (optionsComplete != null) {\r\n\t\t\t\toptions.complete = optionsComplete;\r\n\t\t\t}\r\n\t\t\tif (optionsProgress != null) {\r\n\t\t\t\toptions.progress = optionsProgress;\r\n\t\t\t}\r\n\t\t\tif (optionsSync != null) {\r\n\t\t\t\tisSync = optionsSync;\r\n\t\t\t}\r\n\t\t} else if (!syntacticSugar) {\r\n\t\t\t// Expand any direct options if possible.\r\n\t\t\tlet offset = 0;\r\n\r\n\t\t\toptions.duration = validateDuration(args[argumentIndex], true);\r\n\t\t\tif (options.duration === undefined) {\r\n\t\t\t\toptions.duration = defaults.duration;\r\n\t\t\t} else {\r\n\t\t\t\thasValidDuration = true;\r\n\t\t\t\toffset++;\r\n\t\t\t}\r\n\t\t\tif (!isFunction(args[argumentIndex + offset])) {\r\n\t\t\t\t// Despite coming before Complete, we can't pass a fn easing\r\n\t\t\t\tconst easing = validateEasing(args[argumentIndex + offset], getValue(options && validateDuration(options.duration), defaults.duration) as number, true);\r\n\r\n\t\t\t\tif (easing !== undefined) {\r\n\t\t\t\t\toffset++;\r\n\t\t\t\t\toptions.easing = easing;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst complete = validateComplete(args[argumentIndex + offset], true);\r\n\r\n\t\t\tif (complete !== undefined) {\r\n\t\t\t\toptions.complete = complete;\r\n\t\t\t}\r\n\t\t\toptions.delay = defaults.delay;\r\n\t\t\toptions.loop = defaults.loop;\r\n\t\t\toptions.repeat = options.repeatAgain = defaults.repeat;\r\n\t\t}\r\n\r\n\t\tif (isReverse && options.queue === false) {\r\n\t\t\tthrow new Error(\"VelocityJS: Cannot reverse a queue:false animation.\");\r\n\t\t}\r\n\r\n\t\tif (!hasValidDuration && maybeSequence && maybeSequence.duration) {\r\n\t\t\toptions.duration = maybeSequence.duration;\r\n\t\t}\r\n\r\n\t\t// When a set of elements is targeted by a Velocity call, the set is\r\n\t\t// broken up and each element has the current Velocity call individually\r\n\t\t// queued onto it. In this way, each element's existing queue is\r\n\t\t// respected; some elements may already be animating and accordingly\r\n\t\t// should not have this current Velocity call triggered immediately\r\n\t\t// unless the sync:true option is used.\r\n\r\n\t\tconst rootAnimation: AnimationCall = {\r\n\t\t\toptions,\r\n\t\t\telements,\r\n\t\t\t_prev: undefined,\r\n\t\t\t_next: undefined,\r\n\t\t\t_flags: isSync ? AnimationFlags.SYNC : 0,\r\n\t\t\tpercentComplete: 0,\r\n\t\t\tellapsedTime: 0,\r\n\t\t\ttimeStart: 0,\r\n\t\t};\r\n\r\n\t\tanimations = [];\r\n\t\tfor (let index = 0; index < elements.length; index++) {\r\n\t\t\tconst element = elements[index];\r\n\t\t\tlet flags = 0;\r\n\r\n\t\t\tif (isNode(element)) { // TODO: This needs to check for valid animation targets, not just Elements\r\n\t\t\t\tif (isReverse) {\r\n\t\t\t\t\tconst lastAnimation = Data(element).lastAnimationList[options.queue as string];\r\n\r\n\t\t\t\t\tpropertiesMap = lastAnimation && lastAnimation.tweens as any;\r\n\t\t\t\t\tif (!propertiesMap) {\r\n\t\t\t\t\t\tconsole.error(`VelocityJS: Attempting to reverse an animation on an element with no previous animation:`, element);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tflags |= AnimationFlags.REVERSE & ~(lastAnimation._flags & AnimationFlags.REVERSE); // tslint:disable-line:no-bitwise\r\n\t\t\t\t}\r\n\t\t\t\tconst animation: AnimationCall = {\r\n\t\t\t\t\t...rootAnimation,\r\n\t\t\t\t\telement,\r\n\t\t\t\t\t_flags: rootAnimation._flags | flags, // tslint:disable-line:no-bitwise\r\n\t\t\t\t};\r\n\r\n\t\t\t\toptions._total++;\r\n\t\t\t\tanimations.push(animation);\r\n\t\t\t\tif (options.stagger) {\r\n\t\t\t\t\tif (isFunction(options.stagger)) {\r\n\t\t\t\t\t\tconst num = optionCallback(options.stagger, element, index, elements.length, elements, \"stagger\");\r\n\r\n\t\t\t\t\t\tif (isNumber(num)) {\r\n\t\t\t\t\t\t\tanimation.delay = options.delay + num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tanimation.delay = options.delay + (options.stagger * index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (options.drag) {\r\n\t\t\t\t\tanimation.duration = options.duration - (options.duration * Math.max(1 - (index + 1) / elements.length, 0.75));\r\n\t\t\t\t}\r\n\t\t\t\tif (maybeSequence) {\r\n\t\t\t\t\texpandSequence(animation, maybeSequence);\r\n\t\t\t\t} else if (isReverse) {\r\n\t\t\t\t\t// In this case we're using the previous animation, so\r\n\t\t\t\t\t// it will be expanded correctly when that one runs.\r\n\t\t\t\t\tanimation.tweens = propertiesMap as any;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimation.tweens = Object.create(null);\r\n\t\t\t\t\texpandProperties(animation, propertiesMap);\r\n\t\t\t\t}\r\n\t\t\t\tqueue(element, animation, options.queue);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (StateObject.isTicking === false) {\r\n\t\t\t// If the animation tick isn't running, start it. (Velocity shuts it\r\n\t\t\t// off when there are no active calls to process.)\r\n\t\t\ttick(false);\r\n\t\t}\r\n\t\tif (animations) {\r\n\t\t\tdefineProperty(elements.velocity, \"animations\", animations);\r\n\t\t}\r\n\t}\r\n\t/***************\r\n\t Chaining\r\n\t ***************/\r\n\r\n\t/* Return the elements back to the call chain, with wrapped elements taking precedence in case Velocity was called via the $.fn. extension. */\r\n\treturn elements || promise as any;\r\n}\r\n\r\n/**\r\n * Call an option callback in a try/catch block and report an error if needed.\r\n */\r\nfunction optionCallback<T>(fn: VelocityOptionFn<T>, element: HTMLorSVGElement, index: number, length: number, elements: HTMLorSVGElement[], option: string): T {\r\n\ttry {\r\n\t\treturn fn.call(element, index, length, elements, option);\r\n\t} catch (e) {\r\n\t\tconsole.error(`VelocityJS: Exception when calling '${option}' callback:`, e);\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n */\r\n\r\n// Project\r\nimport {defineProperty} from \"../utility\";\r\nimport {Velocity} from \"../velocityFn\";\r\n\r\n/**\r\n * Used to patch any object to allow Velocity chaining. In order to chain an\r\n * object must either be treatable as an array - with a <code>.length</code>\r\n * property, and each member a Node, or a Node directly.\r\n *\r\n * By default Velocity will try to patch <code>window</code>,\r\n * <code>jQuery</code>, <code>Zepto</code>, and several classes that return\r\n * Nodes or lists of Nodes.\r\n */\r\nexport function patch(proto: any, global?: boolean) {\r\n\ttry {\r\n\t\tdefineProperty(proto, (global ? \"V\" : \"v\") + \"elocity\", Velocity);\r\n\t} catch (e) {\r\n\t\tconsole.warn(`VelocityJS: Error when trying to add prototype.`, e);\r\n\t}\r\n}\r\n","/*\r\n * velocity-animate (C) 2014-2018 Julian Shapiro.\r\n *\r\n * Licensed under the MIT license. See LICENSE file in the project root for details.\r\n *\r\n * Extended Velocity members.\r\n */\r\n\r\n// Typedefs\r\nimport {\r\n\tSequenceList, StrictVelocityOptions, Velocity as VelocityPublic,\r\n\tVelocityActionFn, VelocityEasingFn, VelocityState,\r\n} from \"./../velocity.d\";\r\n\r\n// Project\r\nimport {defineProperty} from \"./utility\";\r\nimport {Actions as ActionsObject} from \"./Velocity/actions/actions\";\r\nimport {defaults as DefaultObject} from \"./Velocity/defaults\";\r\nimport {Easings as EasingsObject} from \"./Velocity/easing/easings\";\r\nimport {patch as patchFn} from \"./Velocity/patch\";\r\nimport {SequencesObject} from \"./Velocity/sequencesObject\";\r\nimport {State as StateObject} from \"./Velocity/state\";\r\nimport {Velocity as VelocityFn} from \"./velocityFn\";\r\n\r\n// Build the entire library, even optional bits.\r\nimport \"./Velocity/_all\";\r\n\r\n// Constants\r\nimport {VERSION} from \"../version\";\r\nconst Velocity: VelocityPublic = VelocityFn as any;\r\n\r\n/**\r\n * These parts of Velocity absolutely must be included, even if they're unused!\r\n */\r\nnamespace VelocityStatic {\r\n\t/**\r\n\t * Actions cannot be replaced if they are internal (hasOwnProperty is false\r\n\t * but they still exist). Otherwise they can be replaced by users.\r\n\t *\r\n\t * All external method calls should be using actions rather than sub-calls\r\n\t * of Velocity itself.\r\n\t */\r\n\texport const Actions: {[name: string]: VelocityActionFn} = ActionsObject;\r\n\r\n\t/**\r\n\t * Our known easing functions.\r\n\t */\r\n\texport const Easings: {[name: string]: VelocityEasingFn} = EasingsObject;\r\n\r\n\t/**\r\n\t * The currently registered sequences.\r\n\t */\r\n\texport const Sequences: {[name: string]: SequenceList} = SequencesObject;\r\n\r\n\t/**\r\n\t * Current internal state of Velocity.\r\n\t */\r\n\texport const State: VelocityState = StateObject; // tslint:disable-line:no-shadowed-variable\r\n\r\n\t/**\r\n\t * Velocity option defaults, which can be overriden by the user.\r\n\t */\r\n\texport const defaults: StrictVelocityOptions & {reset?: () => void} = DefaultObject as any;\r\n\r\n\t/**\r\n\t * Used to patch any object to allow Velocity chaining. In order to chain an\r\n\t * object must either be treatable as an array - with a <code>.length</code>\r\n\t * property, and each member a Node, or a Node directly.\r\n\t *\r\n\t * By default Velocity will try to patch <code>window</code>,\r\n\t * <code>jQuery</code>, <code>Zepto</code>, and several classes that return\r\n\t * Nodes or lists of Nodes.\r\n\t */\r\n\texport const patch = patchFn;\r\n\r\n\t/**\r\n\t * Set to true, 1 or 2 (most verbose) to output debug info to console.\r\n\t */\r\n\texport let debug: boolean | 1 | 2 = false;\r\n\r\n\t/**\r\n\t * In mock mode, all animations are forced to complete immediately upon the\r\n\t * next rAF tick. If there are further animations queued then they will each\r\n\t * take one single frame in turn. Loops and repeats will be disabled while\r\n\t * <code>mock = true</code>.\r\n\t */\r\n\texport let mock: boolean = false;\r\n\r\n\t/**\r\n\t * Save our version number somewhere visible.\r\n\t */\r\n\texport const version = VERSION;\r\n\r\n\t/**\r\n\t * Added as a fallback for \"import {Velocity} from 'velocity-animate';\".\r\n\t */\r\n\texport const Velocity: VelocityPublic = VelocityFn as any; // tslint:disable-line:no-shadowed-variable\r\n}\r\n\r\n/* IE detection. Gist: https://gist.github.com/julianshapiro/9098609 */\r\nconst IE = (() => {\r\n\tinterface IEDocument extends Document {\r\n\t\tdocumentMode: any; // IE\r\n\t}\r\n\r\n\tif ((document as IEDocument).documentMode) {\r\n\t\treturn (document as IEDocument).documentMode;\r\n\t} else {\r\n\t\tfor (let i = 7; i > 4; i--) {\r\n\t\t\tlet div = document.createElement(\"div\");\r\n\r\n\t\t\tdiv.innerHTML = `<!${\"--\"}[if IE ${i}]><span></span><![endif]-->`;\r\n\t\t\tif (div.getElementsByTagName(\"span\").length) {\r\n\t\t\t\tdiv = null;\r\n\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn undefined;\r\n})();\r\n\r\n/******************\r\n Unsupported\r\n ******************/\r\n\r\nif (IE <= 8) {\r\n\tthrow new Error(\"VelocityJS cannot run on Internet Explorer 8 or earlier\");\r\n}\r\n\r\n/******************\r\n Frameworks\r\n ******************/\r\n\r\nif (window) {\r\n\t/*\r\n\t * Both jQuery and Zepto allow their $.fn object to be extended to allow\r\n\t * wrapped elements to be subjected to plugin calls. If either framework is\r\n\t * loaded, register a \"velocity\" extension pointing to Velocity's core\r\n\t * animate() method. Velocity also registers itself onto a global container\r\n\t * (window.jQuery || window.Zepto || window) so that certain features are\r\n\t * accessible beyond just a per-element scope. Accordingly, Velocity can\r\n\t * both act on wrapped DOM elements and stand alone for targeting raw DOM\r\n\t * elements.\r\n\t */\r\n\tconst jQuery: {fn: any} = (window as any).jQuery,\r\n\t\tZepto: {fn: any} = (window as any).Zepto;\r\n\r\n\tpatchFn(window, true);\r\n\tpatchFn(Element && Element.prototype);\r\n\tpatchFn(NodeList && NodeList.prototype);\r\n\tpatchFn(HTMLCollection && HTMLCollection.prototype);\r\n\r\n\tpatchFn(jQuery, true);\r\n\tpatchFn(jQuery && jQuery.fn);\r\n\r\n\tpatchFn(Zepto, true);\r\n\tpatchFn(Zepto && Zepto.fn);\r\n}\r\n\r\n// Make sure that the values within Velocity are read-only and upatchable.\r\nfor (const property in VelocityStatic) {\r\n\tif (VelocityStatic.hasOwnProperty(property)) {\r\n\t\tswitch (typeof property) {\r\n\t\t\tcase \"number\":\r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tdefineProperty(Velocity, property, {\r\n\t\t\t\t\tget() {\r\n\t\t\t\t\t\treturn VelocityStatic[property];\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset(value) {\r\n\t\t\t\t\t\tVelocityStatic[property] = value;\r\n\t\t\t\t\t},\r\n\t\t\t\t}, true);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tdefineProperty(Velocity, property, VelocityStatic[property], true);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObject.freeze(Velocity);\r\n\r\nexport default Velocity; // tslint:disable-line:no-default-export\r\n"],"names":["variable","Object","prototype","toString","call","nodeType","proto","getPrototypeOf","hasOwnProperty","constructor","isNumber","length","isFunction","velocity","window","isString","isNode","obj","property","propertyIsEnumerable","element","className","Element","classList","add","arrayLike","Array","slice","name","value","readonly","defineProperty","args","arguments","arg","undefined","now","Date","getTime","remove","replace","RegExp","Actions","internal","callback","warn","registerAction","DURATION_FAST","DURATION_NORMAL","DURATION_SLOW","FUZZY_MS_PER_SECOND","DEFAULT_CACHE","DEFAULT_DELAY","DEFAULT_DURATION","DEFAULT_EASING","DEFAULT_FPSLIMIT","DEFAULT_LOOP","DEFAULT_PROMISE","DEFAULT_PROMISE_REJECT_EMPTY","DEFAULT_QUEUE","DEFAULT_REPEAT","DEFAULT_SPEED","DEFAULT_SYNC","CLASSNAME","Duration","Easings","registerEasing","percentComplete","startValue","endValue","Math","cos","PI","exp","linearEasing","swingEasing","springEasing","num","min","max","aA1","aA2","aT","A","B","C","mX1","mY1","mX2","mY2","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","i","isNaN","isFinite","fixRange","mSampleValues","Float32Array","aX","aGuessT","currentSlope","getSlope","currentX","calcBezier","aA","aB","currentT","abs","lastSample","intervalStart","currentSample","dist","guessForT","initialSlope","newtonRaphsonIterate","binarySubdivide","precomputed","str","f","getTForX","getControlPoints","x","y","easeIn","generateBezier","easeOut","easeInOut","state","tension","friction","v","initialState","dt","derivative","dx","dv","springAccelerationForState","a","b","springEvaluateStateWithDerivative","c","d","dxdt","dvdt","duration","initState","parseFloat","path","tolerance","DT","haveDuration","timeLapsed","lastState","generateSpringRK4","springIntegrateState","push","floor","cache","steps","fn","round","def","toLowerCase","parseDuration","isBoolean","noError","parsed","error","isArray","generateStep","apply","parseInt","begin","complete","delay","easing","fpsLimit","loop","mobileHA","minFrameTime","promise","promiseRejectEmpty","queue","repeat","speed","sync","validateEasing","validateCache","validateBegin","validateComplete","validateDelay","validateDuration","validateFpsLimit","validateLoop","validatePromise","validatePromiseRejectEmpty","validateQueue","validateRepeat","validateSpeed","validateSync","freeze","defaults","reset","Normalizations","NormalizationUnits","NoCacheNormalizations","Set","constructors","constructorCache","Map","dataName","data","ownerDocument","defaultView","types","index","newData","isClient","windowScrollAnchor","pageYOffset","State","test","navigator","userAgent","document","createElement","documentElement","body","parentNode","animation","prev","last","_prev","_next","first","firstNew","Data","count","queueName","lastAnimationList","queueList","skip","next","options","SequencesObject","activeCall","elements","getValue","isLoop","isRepeat","isStopped","_flags","repeatAgain","lastFinishList","timeStart","ellapsedTime","_completed","_total","resolver","_resolver","indexOf","nextArg","has","get","set","unit","units","includes","propertyName","registerNormalization","hasNormalization","propertyValue","noCache","getNormalization","Velocity","debug","info","fixed","$","letter","toUpperCase","rxColor6","rxColor3","rxColorName","rxRGB","rxSpaces","ColorNames","ignore","r","g","makeRGBA","$0","$1","$2","wantInner","isBorderBox","getPropertyValue","sides","fields","augment","field","getBoundingClientRect","augmentDimension","computedStyle","getComputedStyle","computedValue","getWidthHeight","String","style","position","topLeft","skipCache","rxHex","commands","elementArrayIndex","tween","getNormalizationUnit","fixColors","properties","tweens","create","camelCase","valueData","log","arr1","arr2","end","start","rxToken","rxNumber","parts","partsLength","tokens","indexes","numbers","part","cloneArray","match","sequence","pattern","addString","text","returnStringType","isDisplay","isVisibility","more","bits","isUnitless","hasNumbers","token","digits","change","changeOrUnit","index2","splice","firstLetter","patternCalc","isComplex","isMaths","bit","substring","inRGB","starting","findPattern","startNumbers","percent","JSON","stringify","progress","tweenValue","lastTick","progressed","clear","completed","FRAME_TIME","performance","perf","nowOffset","timing","navigationStart","rAFProxy","setTimeout","rAFShim","requestAnimationFrame","ticking","worker","interval","onmessage","e","setInterval","postMessage","Worker","URL","createObjectURL","Blob","workerFn","isMobile","hidden","addEventListener","isTicking","timestamp","timeCurrent","deltaTime","defaultSpeed","defaultEasing","defaultDuration","nextCall","flags","_ready","_started","_first","activeEasing","millisecondsEllapsed","mock","reverse","currentValue","easingComplete","best","j","tweenFrom","tweenTo","tweenPercent","result","startsWith","size","asyncCallbacks","tick","defaultQueue","endValues","promiseHandler","finishAll","isVelocityResult","animations","then","finish","animationFlags","isReady","isStarted","isPaused","isSync","isReverse","action","key","flag","isPercentComplete","option","pauseResume","isPlainObject","prop","res","_rejecter","join","propertyAction","SyntaxError","stop","requireForcefeeding","Error","fakeAnimation","singleResult","maybeSequence","propertyTween","tweenEasing","tweenAction","colorValues","color","amount","pow","registerBackIn","registerBackOut","registerBackInOut","easeOutBouncePercent","easeInBouncePercent","easeInBounce","easeOutBounce","easeInOutBounce","PI2","amplitude","period","sin","asin","s","registerElasticIn","registerElasticOut","registerElasticInOut","atStart","during","atEnd","getDimension","inlineRx","listItemRx","tableRowRx","tableRx","tableRowGroupRx","computePropertyValue","nodeName","display","clientWidth","scrollWidth","clientHeight","scrollHeight","direction","client","scrollValue","scroll","rxAddPx","unprefixed","rxVendors","prefixElement","addUnit","getSetPrefixed","getSetStyle","getAttribute","setAttribute","base","rxSubtype","rxElement","getOwnPropertyNames","forEach","subtype","exec","createElementNS","attribute","getBBox","getSetTween","VERSION","VelocityFn","VelocityStatic","ActionsObject","EasingsObject","StateObject","DefaultObject","patchFn","IE","documentMode","div","innerHTML","getElementsByTagName","jQuery","Zepto","NodeList","HTMLCollection","rxPercents","percents","percentages","keys","orderedPercents","sort","a1","b1","stepProperties","realSequence","originalProperty","sequenceList","registerSequence","globalPromise","Promise","_a","noPromiseOption","promiseObject","bind","catch","finally","argsList","args0","p","names","isWrapped","syntacticSugar","argumentIndex","propertiesMap","isAction","opts","o","optionsMap","resolve","reject","optionPromiseRejectEmpty","actionArgs","rejecter","hasValidDuration","validDuration","isGingerbread","drag","stagger","visibility","optionsBegin","optionsComplete","optionsProgress","validateProgress","optionsSync","offset","rootAnimation","lastAnimation","optionCallback","global"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWA;;;AAGA,mBAA0BA;WAClBA,aAAa,IAAb,IAAqBA,aAAa,KAAzC;;AAGD;;;AAgBA,oBAA2BA;WACnBC,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,QAA/B,MAA6C,mBAApD;;;;;AAMD,gBAAuBA;WACf,CAAC,EAAEA,YAAaA,SAAqBK,QAApC,CAAR;;;;;AAMD,kBAAyBL;WACjB,OAAOA,QAAP,KAAoB,QAA3B;;AAGD;;;AAUA,uBAA8BA;QACzB,CAACA,QAAD,IAAa,QAAOA,QAAP,yCAAOA,QAAP,OAAoB,QAAjC,IAA8CA,SAAqBK,QAAnE,IAA+EJ,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,QAA/B,MAA6C,iBAAhI,EAAmJ;eAC3I,KAAP;;QAEKM,QAAQL,OAAOM,cAAP,CAAsBP,QAAtB,CAAd;WAEO,CAACM,KAAD,IAAWA,MAAME,cAAN,CAAqB,aAArB,KAAuCF,MAAMG,WAAN,KAAsBR,MAA/E;;AAGD;;;AAUA,kBAAyBD;WACjB,OAAOA,QAAP,KAAoB,QAA3B;;;;;AAMD,0BAAiCA;WACzBA,YAAYU,SAAUV,SAA4BW,MAAtC,CAAZ,IAA6DC,WAAYZ,SAA4Ba,QAAxC,CAApE;;;;;;AAQD,mBAA0Bb;WAClBA,YACHA,aAAac,MADV,IAEHJ,SAAUV,SAAgCW,MAA1C,CAFG,IAGH,CAACI,SAASf,QAAT,CAHE,IAIH,CAACY,WAAWZ,QAAX,CAJE,IAKH,CAACgB,OAAOhB,QAAP,CALE,KAMDA,SAAgCW,MAAhC,KAA2C,CAA3C,IAAgDK,OAAOhB,SAAS,CAAT,CAAP,CAN/C,CAAP;;;;;AAYD,8BAAqCiB,KAAaC;WAC1CjB,OAAOC,SAAP,CAAiBiB,oBAAjB,CAAsCf,IAAtC,CAA2Ca,GAA3C,EAAgDC,QAAhD,CAAP;;;ACtGD;AACA;;;AAKA,kBAAyBE,SAA2BC;QAC/CD,mBAAmBE,OAAvB,EAAgC;YAC3BF,QAAQG,SAAZ,EAAuB;oBACdA,SAAR,CAAkBC,GAAlB,CAAsBH,SAAtB;SADD,MAEO;wBACMD,OAAZ,EAAqBC,SAArB;oBACiBA,SAAhB,IAA6B,CAACD,QAAQC,SAAR,CAAkBV,MAAlB,GAA2B,GAA3B,GAAiC,EAAlC,IAAwCU,SAArE;;;;;;;AAQJ,oBAAoCI;WAC5BC,MAAMxB,SAAN,CAAgByB,KAAhB,CAAsBvB,IAAtB,CAA2BqB,SAA3B,EAAsC,CAAtC,CAAP;;;;;;AAOD,0BAA+BnB,OAAYsB,MAAcC,OAAYC;QAChExB,KAAJ,EAAW;eACHyB,cAAP,CAAsBzB,KAAtB,EAA6BsB,IAA7B,EAAmC;0BACpB,CAACE,QADmB;sBAExB,CAACA,QAFuB;;SAAnC;;;;;;;AAYF;sCAA+BE;;;;;;;;;6BACZC,SAAlB,8HAA6B;gBAAlBC,GAAkB;;gBACxBA,QAAQC,SAAR,IAAqBD,QAAQA,GAAjC,EAAsC;uBAC9BA,GAAP;;;;;;;;;;;;;;;;;;;;;;;AAUH,IAAaE,MAAMC,KAAKD,GAAL,GAAWC,KAAKD,GAAhB,GAAsB;WAChC,IAAIC,IAAJ,EAAD,CAAaC,OAAb,EAAP;CADM;;;;AAOP,qBAA4BlB,SAA2BC;QAClDD,mBAAmBE,OAAvB,EAAgC;YAC3BF,QAAQG,SAAZ,EAAuB;oBACdA,SAAR,CAAkBgB,MAAlB,CAAyBlB,SAAzB;SADD,MAEO;;oBAEWA,SAAhB,GAA4BD,QAAQC,SAAR,CAAkBmB,OAAlB,CAA0B,IAAIC,MAAJ,aAAqBpB,SAArB,cAAyC,IAAzC,CAA1B,EAA0E,GAA1E,CAA5B;;;;;AClEJ;AACA;AAIA,IAAaqB,UAA8C,EAApD;;;;;;AAOP,wBAA+BV,MAAmCW;QAC3Df,OAAeI,KAAK,CAAL,CAArB;QACCY,WAAWZ,KAAK,CAAL,CADZ;QAGI,CAACjB,SAASa,IAAT,CAAL,EAAqB;gBACZiB,IAAR,yEAAqFjB,IAArF;KADD,MAEO,IAAI,CAAChB,WAAWgC,QAAX,CAAL,EAA2B;gBACzBC,IAAR,6EAAyFjB,IAAzF,EAA+FgB,QAA/F;KADM,MAEA,IAAIF,QAAQd,IAAR,KAAiB,CAACT,qBAAqBuB,OAArB,EAA8Bd,IAA9B,CAAtB,EAA2D;gBACzDiB,IAAR,sEAAkFjB,IAAlF;KADM,MAEA,IAAIe,aAAa,IAAjB,EAAuB;yBACdD,OAAf,EAAwBd,IAAxB,EAA8BgB,QAA9B;KADM,MAEA;gBACEhB,IAAR,IAAgBgB,QAAhB;;;AAIFE,eAAe,CAAC,gBAAD,EAAmBA,cAAnB,CAAf,EAA0D,IAA1D;;AC/BA;;;;AAIA,IAEaC,gBAAgB,GAAtB;AACP,IAAaC,kBAAkB,GAAxB;AACP,IAAaC,gBAAgB,GAAtB;AAEP,IAAaC,sBAAsB,GAA5B;AAEP,IAAaC,gBAAgB,IAAtB;AACP,IAAaC,gBAAgB,CAAtB;AACP,IAAaC,mBAAmBL,eAAzB;AACP,IAAaM,iBAAiB,OAAvB;AACP,IAAaC,mBAAmB,EAAzB;AACP,IAAaC,eAAe,CAArB;AACP,IAAaC,kBAAkB,IAAxB;AACP,IAAaC,+BAA+B,IAArC;AACP,IAAaC,gBAAgB,EAAtB;AACP,IAAaC,iBAAiB,CAAvB;AACP,IAAaC,gBAAgB,CAAtB;AACP,IAAaC,eAAe,IAArB;AAEP,IAAaC,YAAY,oBAAlB;AAEP,IAAaC,WAAW;QACjBjB,aADiB;UAEfC,eAFe;QAGjBC;CAHA;;AC3BP;AACA;AAIA,IAAagB,UAA8C,EAApD;;;;;;AAOP,wBAA+BjC;QACxBJ,OAAeI,KAAK,CAAL,CAArB;QACCY,WAAWZ,KAAK,CAAL,CADZ;QAGI,CAACjB,SAASa,IAAT,CAAL,EAAqB;gBACZiB,IAAR,yEAAqFjB,IAArF;KADD,MAEO,IAAI,CAAChB,WAAWgC,QAAX,CAAL,EAA2B;gBACzBC,IAAR,6EAAyFjB,IAAzF,EAA+FgB,QAA/F;KADM,MAEA,IAAIqB,QAAQrC,IAAR,CAAJ,EAAmB;gBACjBiB,IAAR,6DAAyEjB,IAAzE;KADM,MAEA;gBACEA,IAAR,IAAgBgB,QAAhB;;;AAIFE,eAAe,CAAC,gBAAD,EAAmBoB,cAAnB,CAAf,EAAmD,IAAnD;;;;;AAMA,sBAA6BC,iBAAiBC,YAAYC,UAAUnD;WAC5DkD,aAAaD,mBAAmBE,WAAWD,UAA9B,CAApB;;;;;AAMD,qBAA4BD,iBAAiBC,YAAYC;WACjDD,aAAa,CAAC,MAAME,KAAKC,GAAL,CAASJ,kBAAkBG,KAAKE,EAAhC,IAAsC,CAA7C,KAAmDH,WAAWD,UAA9D,CAApB;;;;;AAMD,sBAA6BD,iBAAiBC,YAAYC;WAClDD,aAAa,CAAC,IAAKE,KAAKC,GAAL,CAASJ,kBAAkB,GAAlB,GAAwBG,KAAKE,EAAtC,IAA4CF,KAAKG,GAAL,CAAS,CAACN,eAAD,GAAmB,CAA5B,CAAlD,KAAsFE,WAAWD,UAAjG,CAApB;;AAGDF,eAAe,CAAC,QAAD,EAAWQ,YAAX,CAAf;AACAR,eAAe,CAAC,OAAD,EAAUS,WAAV,CAAf;AACAT,eAAe,CAAC,QAAD,EAAWU,YAAX,CAAf;;ACnDA;AACA;;;AAKA,iBAAA,CAAkBC,GAAlB;WACQP,KAAKQ,GAAL,CAASR,KAAKS,GAAL,CAASF,GAAT,EAAc,CAAd,CAAT,EAA2B,CAA3B,CAAP;;AAGD,UAAA,CAAWG,GAAX,EAAgBC,GAAhB;WACQ,IAAI,IAAIA,GAAR,GAAc,IAAID,GAAzB;;AAGD,UAAA,CAAWA,GAAX,EAAgBC,GAAhB;WACQ,IAAIA,GAAJ,GAAU,IAAID,GAArB;;AAGD,UAAA,CAAWA,GAAX;WACQ,IAAIA,GAAX;;AAGD,mBAAA,CAAoBE,EAApB,EAAwBF,GAAxB,EAA6BC,GAA7B;WACQ,CAAC,CAACE,EAAEH,GAAF,EAAOC,GAAP,IAAcC,EAAd,GAAmBE,EAAEJ,GAAF,EAAOC,GAAP,CAApB,IAAmCC,EAAnC,GAAwCG,EAAEL,GAAF,CAAzC,IAAmDE,EAA1D;;AAGD,iBAAA,CAAkBA,EAAlB,EAAsBF,GAAtB,EAA2BC,GAA3B;WACQ,IAAIE,EAAEH,GAAF,EAAOC,GAAP,CAAJ,GAAkBC,EAAlB,GAAuBA,EAAvB,GAA4B,IAAIE,EAAEJ,GAAF,EAAOC,GAAP,CAAJ,GAAkBC,EAA9C,GAAmDG,EAAEL,GAAF,CAA1D;;AAGD,wBAA+BM,KAAaC,KAAaC,KAAaC;QAC/DC,oBAAoB,CAA1B;QACCC,mBAAmB,KADpB;QAECC,wBAAwB,SAFzB;QAGCC,6BAA6B,EAH9B;QAICC,mBAAmB,EAJpB;QAKCC,kBAAkB,KAAKD,mBAAmB,CAAxB,CALnB;QAMCE,wBAAwB,kBAAkBlF,MAN3C;;QASImB,UAAUtB,MAAV,KAAqB,CAAzB,EAA4B;;;;SAKvB,IAAIsF,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuB,EAAEA,CAAzB,EAA4B;YACvB,OAAOhE,UAAUgE,CAAV,CAAP,KAAwB,QAAxB,IAAoCC,MAAMjE,UAAUgE,CAAV,CAAN,CAApC,IAA2D,CAACE,SAASlE,UAAUgE,CAAV,CAAT,CAAhE,EAAwF;;;;;UAMnFG,SAASd,GAAT,CAAN;UACMc,SAASZ,GAAT,CAAN;QAEMa,gBAAgBL,wBAAwB,IAAIM,YAAJ,CAAiBR,gBAAjB,CAAxB,GAA6D,IAAIpE,KAAJ,CAAUoE,gBAAV,CAAnF;iCAEA,CAA8BS,EAA9B,EAAkCC,OAAlC;aACM,IAAIP,KAAI,CAAb,EAAgBA,KAAIP,iBAApB,EAAuC,EAAEO,EAAzC,EAA4C;gBACrCQ,eAAeC,SAASF,OAAT,EAAkBlB,GAAlB,EAAuBE,GAAvB,CAArB;gBAEIiB,iBAAiB,CAArB,EAAwB;uBAChBD,OAAP;;gBAGKG,WAAWC,WAAWJ,OAAX,EAAoBlB,GAApB,EAAyBE,GAAzB,IAAgCe,EAAjD;uBACWI,WAAWF,YAAtB;;eAGMD,OAAP;;6BAGD;aACM,IAAIP,MAAI,CAAb,EAAgBA,MAAIH,gBAApB,EAAsC,EAAEG,GAAxC,EAA2C;0BAC5BA,GAAd,IAAmBW,WAAWX,MAAIF,eAAf,EAAgCT,GAAhC,EAAqCE,GAArC,CAAnB;;;4BAIF,CAAyBe,EAAzB,EAA6BM,EAA7B,EAAiCC,EAAjC;YACKH,iBAAJ;YAAcI,iBAAd;YAAwBd,IAAI,CAA5B;WAEG;uBACSY,KAAK,CAACC,KAAKD,EAAN,IAAY,CAA5B;uBACWD,WAAWG,QAAX,EAAqBzB,GAArB,EAA0BE,GAA1B,IAAiCe,EAA5C;gBACII,WAAW,CAAf,EAAkB;qBACZI,QAAL;aADD,MAEO;qBACDA,QAAL;;SANF,QAQSzC,KAAK0C,GAAL,CAASL,QAAT,IAAqBf,qBAArB,IAA8C,EAAEK,CAAF,GAAMJ,0BAR7D;eAUOkB,QAAP;;qBAGD,CAAkBR,EAAlB;YACOU,aAAanB,mBAAmB,CAAtC;YACIoB,gBAAgB,CAApB;YACCC,gBAAgB,CADjB;eAGOA,kBAAkBF,UAAlB,IAAgCZ,cAAcc,aAAd,KAAgCZ,EAAvE,EAA2E,EAAEY,aAA7E,EAA4F;6BAC1EpB,eAAjB;;UAGCoB,aAAF;YAEMC,OAAO,CAACb,KAAKF,cAAcc,aAAd,CAAN,KAAuCd,cAAcc,gBAAgB,CAA9B,IAAmCd,cAAcc,aAAd,CAA1E,CAAb;YACCE,YAAYH,gBAAgBE,OAAOrB,eADpC;YAECuB,eAAeZ,SAASW,SAAT,EAAoB/B,GAApB,EAAyBE,GAAzB,CAFhB;YAII8B,gBAAgB3B,gBAApB,EAAsC;mBAC9B4B,qBAAqBhB,EAArB,EAAyBc,SAAzB,CAAP;SADD,MAEO,IAAIC,iBAAiB,CAArB,EAAwB;mBACvBD,SAAP;SADM,MAEA;mBACCG,gBAAgBjB,EAAhB,EAAoBW,aAApB,EAAmCA,gBAAgBnB,eAAnD,CAAP;;;QAIE0B,cAAc,KAAlB;uBAEA;sBACe,IAAd;YACInC,QAAQC,GAAR,IAAeC,QAAQC,GAA3B,EAAgC;;;;QAK3BiC,0BAAwB,CAACpC,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,GAAhB,CAAxB,MAAN;QACCkC,IAAI,SAAJA,CAAI,CAACxD,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C,EAAgEnD,QAAhE;YACC,CAACuG,WAAL,EAAkB;;;YAGdtD,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;YAEGiB,QAAQC,GAAR,IAAeC,QAAQC,GAA3B,EAAgC;mBACxBrB,aAAaD,mBAAmBE,WAAWD,UAA9B,CAApB;;eAGMA,aAAawC,WAAWgB,SAASzD,eAAT,CAAX,EAAsCoB,GAAtC,EAA2CE,GAA3C,KAAmDpB,WAAWD,UAA9D,CAApB;KAfF;MAkBWyD,gBAAV,GAA6B;eACtB,CAAC,EAACC,GAAGxC,GAAJ,EAASyC,GAAGxC,GAAZ,EAAD,EAAmB,EAACuC,GAAGtC,GAAJ,EAASuC,GAAGtC,GAAZ,EAAnB,CAAP;KADA;MAGCtF,QAAF,GAAa;eACLuH,GAAP;KADD;WAIOC,CAAP;;;AAID,IAAMK,SAASC,eAAe,IAAf,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,CAAf;IACCC,UAAUD,eAAe,CAAf,EAAkB,CAAlB,EAAqB,IAArB,EAA2B,CAA3B,CADX;IAECE,YAAYF,eAAe,IAAf,EAAqB,CAArB,EAAwB,IAAxB,EAA8B,CAA9B,CAFb;AAIA/D,eAAe,CAAC,MAAD,EAAS+D,eAAe,IAAf,EAAqB,GAArB,EAA0B,IAA1B,EAAgC,CAAhC,CAAT,CAAf;AACA/D,eAAe,CAAC,QAAD,EAAW8D,MAAX,CAAf;AACA9D,eAAe,CAAC,SAAD,EAAY8D,MAAZ,CAAf;AACA9D,eAAe,CAAC,SAAD,EAAYgE,OAAZ,CAAf;AACAhE,eAAe,CAAC,UAAD,EAAagE,OAAb,CAAf;AACAhE,eAAe,CAAC,WAAD,EAAciE,SAAd,CAAf;AACAjE,eAAe,CAAC,aAAD,EAAgBiE,SAAhB,CAAf;AACAjE,eAAe,CAAC,YAAD,EAAe+D,eAAe,IAAf,EAAqB,CAArB,EAAwB,KAAxB,EAA+B,KAA/B,CAAf,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,IAAf,EAAqB,KAArB,EAA4B,KAA5B,EAAmC,CAAnC,CAAhB,CAAf;AACA/D,eAAe,CAAC,eAAD,EAAkB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,IAAlC,CAAlB,CAAf;AACA/D,eAAe,CAAC,YAAD,EAAe+D,eAAe,IAAf,EAAqB,KAArB,EAA4B,IAA5B,EAAkC,IAAlC,CAAf,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,IAAf,EAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC,CAAhB,CAAf;AACA/D,eAAe,CAAC,eAAD,EAAkB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,KAA5B,EAAmC,KAAnC,CAAlB,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,IAAf,EAAqB,KAArB,EAA4B,KAA5B,EAAmC,IAAnC,CAAhB,CAAf;AACA/D,eAAe,CAAC,cAAD,EAAiB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,KAA5B,EAAmC,CAAnC,CAAjB,CAAf;AACA/D,eAAe,CAAC,gBAAD,EAAmB+D,eAAe,KAAf,EAAsB,KAAtB,EAA6B,KAA7B,EAAoC,CAApC,CAAnB,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,KAA5B,EAAmC,IAAnC,CAAhB,CAAf;AACA/D,eAAe,CAAC,cAAD,EAAiB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,CAAlC,CAAjB,CAAf;AACA/D,eAAe,CAAC,gBAAD,EAAmB+D,eAAe,IAAf,EAAqB,CAArB,EAAwB,KAAxB,EAA+B,CAA/B,CAAnB,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,KAA5B,EAAmC,IAAnC,CAAhB,CAAf;AACA/D,eAAe,CAAC,cAAD,EAAiB+D,eAAe,IAAf,EAAqB,CAArB,EAAwB,IAAxB,EAA8B,CAA9B,CAAjB,CAAf;AACA/D,eAAe,CAAC,gBAAD,EAAmB+D,eAAe,IAAf,EAAqB,CAArB,EAAwB,IAAxB,EAA8B,CAA9B,CAAnB,CAAf;AACA/D,eAAe,CAAC,YAAD,EAAe+D,eAAe,IAAf,EAAqB,IAArB,EAA2B,KAA3B,EAAkC,KAAlC,CAAf,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,IAAf,EAAqB,CAArB,EAAwB,IAAxB,EAA8B,CAA9B,CAAhB,CAAf;AACA/D,eAAe,CAAC,eAAD,EAAkB+D,eAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAlB,CAAf;AACA/D,eAAe,CAAC,YAAD,EAAe+D,eAAe,GAAf,EAAoB,IAApB,EAA0B,IAA1B,EAAgC,KAAhC,CAAf,CAAf;AACA/D,eAAe,CAAC,aAAD,EAAgB+D,eAAe,KAAf,EAAsB,IAAtB,EAA4B,KAA5B,EAAmC,CAAnC,CAAhB,CAAf;AACA/D,eAAe,CAAC,eAAD,EAAkB+D,eAAe,KAAf,EAAsB,KAAtB,EAA6B,IAA7B,EAAmC,IAAnC,CAAlB,CAAf;;ACjLA;;;AAGA,mCAAA,CAAoCG,KAApC;WACS,CAACA,MAAMC,OAAP,GAAiBD,MAAMN,CAAxB,GAA8BM,MAAME,QAAN,GAAiBF,MAAMG,CAA5D;;AAGD,0CAAA,CAA2CC,YAA3C,EAAsEC,EAAtE,EAAkFC,UAAlF;QACON,QAAQ;WACVI,aAAaV,CAAb,GAAiBY,WAAWC,EAAX,GAAgBF,EADvB;WAEVD,aAAaD,CAAb,GAAiBG,WAAWE,EAAX,GAAgBH,EAFvB;iBAGJD,aAAaH,OAHT;kBAIHG,aAAaF;KAJxB;WAOO;YACFF,MAAMG,CADJ;YAEFM,2BAA2BT,KAA3B;KAFL;;AAMD,6BAAA,CAA8BA,KAA9B,EAAkDK,EAAlD;QACOK,IAAI;YACLV,MAAMG,CADD;YAELM,2BAA2BT,KAA3B;KAFL;QAICW,IAAIC,kCAAkCZ,KAAlC,EAAyCK,KAAK,GAA9C,EAAmDK,CAAnD,CAJL;QAKCG,IAAID,kCAAkCZ,KAAlC,EAAyCK,KAAK,GAA9C,EAAmDM,CAAnD,CALL;QAMCG,IAAIF,kCAAkCZ,KAAlC,EAAyCK,EAAzC,EAA6CQ,CAA7C,CANL;QAOCE,OAAO,IAAI,CAAJ,IAASL,EAAEH,EAAF,GAAO,KAAKI,EAAEJ,EAAF,GAAOM,EAAEN,EAAd,CAAP,GAA2BO,EAAEP,EAAtC,CAPR;QAQCS,OAAO,IAAI,CAAJ,IAASN,EAAEF,EAAF,GAAO,KAAKG,EAAEH,EAAF,GAAOK,EAAEL,EAAd,CAAP,GAA2BM,EAAEN,EAAtC,CARR;UAUMd,CAAN,GAAUM,MAAMN,CAAN,GAAUqB,OAAOV,EAA3B;UACMF,CAAN,GAAUH,MAAMG,CAAN,GAAUa,OAAOX,EAA3B;WAEOL,KAAP;;AAKD,2BAAkCC,SAAiBC,UAAkBe;QAC9DC,YAAyB;WAC3B,CAAC,CAD0B;WAE3B,CAF2B;iBAGrBC,WAAWlB,OAAX,KAA8B,GAHT;kBAIpBkB,WAAWjB,QAAX,KAA+B;KAJ1C;QAMCkB,OAAO,CAAC,CAAD,CANR;QAOCC,YAAY,IAAI,KAPjB;QAQCC,KAAK,KAAK,IARX;QASCC,eAAeN,YAAY,IAT5B;QAUIO,aAAa,CAAjB;QACCnB,WADD;QAECoB,kBAFD;;QAKIF,YAAJ,EAAkB;;qBAEJG,kBAAkBR,UAAUjB,OAA5B,EAAqCiB,UAAUhB,QAA/C,CAAb;;aAEMsB,aAAwBP,QAAxB,GAAmCK,EAAzC;KAJD,MAKO;aACDA,EAAL;;WAGM,IAAP,EAAa;;oBAEAK,qBAAqBF,aAAaP,SAAlC,EAA6Cb,EAA7C,CAAZ;;aAEKuB,IAAL,CAAU,IAAIH,UAAU/B,CAAxB;sBACc,EAAd;;YAEI,EAAExD,KAAK0C,GAAL,CAAS6C,UAAU/B,CAAnB,IAAwB2B,SAAxB,IAAqCnF,KAAK0C,GAAL,CAAS6C,UAAUtB,CAAnB,IAAwBkB,SAA/D,CAAJ,EAA+E;;;;;;WAOzE,CAACE,YAAD,GAAgBC,UAAhB,GAA6B,UAACzF,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YAC/BF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGMD,aAAaoF,KAAKlF,KAAK2F,KAAL,CAAW9F,mBAAmBqF,KAAK7I,MAAL,GAAc,CAAjC,CAAX,CAAL,KAAyD0D,WAAWD,UAApE,CAApB;KARD;;;ACzFD;AACA,IAAM8F,QAA6C,EAAnD;AAEA,sBAA6BC;QACtBC,KAAKF,MAAMC,KAAN,CAAX;QAEIC,EAAJ,EAAQ;eACAA,EAAP;;WAGMF,MAAMC,KAAN,IAAe,UAAChG,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGMD,aAAaE,KAAK+F,KAAL,CAAWlG,kBAAkBgG,KAA7B,KAAuC,IAAIA,KAA3C,KAAqD9F,WAAWD,UAAhE,CAApB;KARD;;;ACRD;AACA;;;;AAWA,uBAA8BiF,UAA+CiB;QACxE5J,SAAS2I,QAAT,CAAJ,EAAwB;eAChBA,QAAP;;QAEGtI,SAASsI,QAAT,CAAJ,EAAwB;eAChBrF,SAASqF,SAASkB,WAAT,EAAT,KACHhB,WAAWF,SAAS7G,OAAT,CAAiB,IAAjB,EAAuB,EAAvB,EACZA,OADY,CACJ,GADI,EACC,KADD,CAAX,CADJ;;WAKM8H,OAAO,IAAP,GAAcnI,SAAd,GAA0BqI,cAAcF,GAAd,CAAjC;;;;;AAMD,uBAA8BzI;QACzB4I,UAAU5I,KAAV,CAAJ,EAAsB;eACdA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACVgB,IAAR,2DAAuEhB,KAAvE;;;;;;AAOF,uBAA8BA;QACzBjB,WAAWiB,KAAX,CAAJ,EAAuB;eACfA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACVgB,IAAR,2DAAuEhB,KAAvE;;;;;;AAOF,0BAAiCA,OAA2B6I;QACvD9J,WAAWiB,KAAX,CAAJ,EAAuB;eACfA,KAAP;;QAEGA,SAAS,IAAT,IAAiB,CAAC6I,OAAtB,EAA+B;gBACtB7H,IAAR,8DAA0EhB,KAA1E;;;;;;AAOF,uBAA8BA;QACvB8I,SAASH,cAAc3I,KAAd,CAAf;QAEI,CAACqE,MAAMyE,MAAN,CAAL,EAAoB;eACZA,MAAP;;QAEG9I,SAAS,IAAb,EAAmB;gBACV+I,KAAR,2DAAwE/I,KAAxE;;;;;;AAOF,0BAAiCA,OAA4C6I;QACtEC,SAASH,cAAc3I,KAAd,CAAf;QAEI,CAACqE,MAAMyE,MAAN,CAAD,IAAkBA,UAAU,CAAhC,EAAmC;eAC3BA,MAAP;;QAEG9I,SAAS,IAAT,IAAiB,CAAC6I,OAAtB,EAA+B;gBACtBE,KAAR,8DAA2E/I,KAA3E;;;;;;AAOF,wBAA+BA,OAA2BwH,UAAkBqB;QACvE3J,SAASc,KAAT,CAAJ,EAAqB;;eAEboC,QAAQpC,KAAR,CAAP;;QAEGjB,WAAWiB,KAAX,CAAJ,EAAuB;eACfA,KAAP;;;QAGGH,MAAMmJ,OAAN,CAAchJ,KAAd,CAAJ,EAA0B;YACrBA,MAAMlB,MAAN,KAAiB,CAArB,EAAwB;;mBAEhBmK,aAAajJ,MAAM,CAAN,CAAb,CAAP;;YAEGA,MAAMlB,MAAN,KAAiB,CAArB,EAAwB;;;;;mBAKhBmJ,kBAAkBjI,MAAM,CAAN,CAAlB,EAA4BA,MAAM,CAAN,CAA5B,EAAsCwH,QAAtC,CAAP;;YAEGxH,MAAMlB,MAAN,KAAiB,CAArB,EAAwB;;;mBAGhBsH,eAAe8C,KAAf,CAAqB,IAArB,EAA2BlJ,KAA3B,KAAqC,KAA5C;;;QAGEA,SAAS,IAAT,IAAiB,CAAC6I,OAAtB,EAA+B;gBACtBE,KAAR,4DAAyE/I,KAAzE;;;;;;AAOF,0BAAiCA;QAC5BA,UAAU,KAAd,EAAqB;eACb,CAAP;KADD,MAEO;YACA8I,SAASK,SAASnJ,KAAT,EAAuB,EAAvB,CAAf;YAEI,CAACqE,MAAMyE,MAAN,CAAD,IAAkBA,UAAU,CAAhC,EAAmC;mBAC3BrG,KAAKQ,GAAL,CAAS6F,MAAT,EAAiB,EAAjB,CAAP;;;QAGE9I,SAAS,IAAb,EAAmB;gBACVgB,IAAR,8DAA0EhB,KAA1E;;;;;;AAOF,sBAA6BA;YACpBA,KAAR;aACM,KAAL;mBACQ,CAAP;aAEI,IAAL;mBACQ,IAAP;;gBAGM8I,SAASK,SAASnJ,KAAT,EAAuB,EAAvB,CAAf;gBAEI,CAACqE,MAAMyE,MAAN,CAAD,IAAkBA,UAAU,CAAhC,EAAmC;uBAC3BA,MAAP;;;;QAIC9I,SAAS,IAAb,EAAmB;gBACVgB,IAAR,0DAAsEhB,KAAtE;;;;;;AAOF,0BAAiCA;QAC5BjB,WAAWiB,KAAX,CAAJ,EAAuB;eACfA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACVgB,IAAR,8DAA0EhB,KAA1E;;;;;;AAOF,yBAAgCA;QAC3B4I,UAAU5I,KAAV,CAAJ,EAAsB;eACdA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACVgB,IAAR,6DAAyEhB,KAAzE;;;;;;AAOF,oCAA2CA;QACtC4I,UAAU5I,KAAV,CAAJ,EAAsB;eACdA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACVgB,IAAR,wEAAoFhB,KAApF;;;;;;AAOF,uBAA8BA,OAAuB6I;QAChD7I,UAAU,KAAV,IAAmBd,SAASc,KAAT,CAAvB,EAAwC;eAChCA,KAAP;;QAEGA,SAAS,IAAT,IAAiB,CAAC6I,OAAtB,EAA+B;gBACtB7H,IAAR,2DAAuEhB,KAAvE;;;;;;AAOF,wBAA+BA;YACtBA,KAAR;aACM,KAAL;mBACQ,CAAP;aAEI,IAAL;mBACQ,IAAP;;gBAGM8I,SAASK,SAASnJ,KAAT,EAAuB,EAAvB,CAAf;gBAEI,CAACqE,MAAMyE,MAAN,CAAD,IAAkBA,UAAU,CAAhC,EAAmC;uBAC3BA,MAAP;;;;QAIC9I,SAAS,IAAb,EAAmB;gBACVgB,IAAR,4DAAwEhB,KAAxE;;;;;;AAOF,uBAA8BA;QACzBnB,SAASmB,KAAT,CAAJ,EAAqB;eACbA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACV+I,KAAR,2DAAwE/I,KAAxE;;;;;;AAOF,sBAA6BA;QACxB4I,UAAU5I,KAAV,CAAJ,EAAsB;eACdA,KAAP;;QAEGA,SAAS,IAAb,EAAmB;gBACV+I,KAAR,0DAAuE/I,KAAvE;;;;ACpQF;AACA;AAeA,IAAIqI,gBAAJ;IACCe,cADD;IAECC,iBAFD;IAGCC,cAHD;IAIC9B,iBAJD;IAKC+B,eALD;IAMCC,iBAND;IAOCC,aAPD;IAQCC,iBARD;IASCC,qBATD;IAUCC,gBAVD;IAWCC,2BAXD;IAYCC,cAZD;IAaCC,eAbD;IAcCC,cAdD;IAeCC,aAfD;AAiBA,cAAA;;;;;;;;sBAEU3I,aAAR;oBACQhB,SAAR;uBACWA,SAAX;oBACQiB,aAAR;uBACWC,gBAAX;qBACS0I,eAAezI,cAAf,EAA+BD,gBAA/B,CAAT;uBACWE,gBAAX;mBACOC,YAAP;2BACeN,sBAAsBK,gBAArC;sBACUE,eAAV;iCACqBC,4BAArB;oBACQC,aAAR;qBACSC,cAAT;oBACQC,aAAR;mBACOC,YAAP;;;;;mBAIOoG,OAAP;SApBF;6BAuBkBrI,KAvBlB;oBAwBUmK,cAAcnK,KAAd,CAAR;gBACIA,UAAUM,SAAd,EAAyB;0BAChBN,KAAR;;;;;;mBAKMoJ,KAAP;SA/BF;6BAiCkBpJ,KAjClB;oBAkCUoK,cAAcpK,KAAd,CAAR;gBACIA,UAAUM,SAAd,EAAyB;wBAChBN,KAAR;;;;;;mBAKMqJ,QAAP;SAzCF;6BA4CqBrJ,KA5CrB;oBA6CUqK,iBAAiBrK,KAAjB,CAAR;gBACIA,UAAUM,SAAd,EAAyB;2BACbN,KAAX;;;;;;mBAKMsJ,KAAP;SApDF;6BAsDkBtJ,KAtDlB;oBAuDUsK,cAActK,KAAd,CAAR;gBACIA,UAAUM,SAAd,EAAyB;wBAChBN,KAAR;;;;;;mBAKMwH,QAAP;SA9DF;6BAgEqBxH,KAhErB;oBAiEUuK,iBAAiBvK,KAAjB,CAAR;gBACIA,UAAUM,SAAd,EAAyB;2BACbN,KAAX;;;;;;mBAKMuJ,MAAP;SAxEF;6BA0EmBvJ,KA1EnB;oBA2EUkK,eAAelK,KAAf,EAAsBwH,QAAtB,CAAR;gBACIxH,UAAUM,SAAd,EAAyB;yBACfN,KAAT;;;;;;mBAKMwJ,QAAP;SAlFF;6BAoFqBxJ,KApFrB;oBAqFUwK,iBAAiBxK,KAAjB,CAAR;gBACIA,UAAUM,SAAd,EAAyB;2BACbN,KAAX;+BACeqB,sBAAsBrB,KAArC;;;;;;mBAKMyJ,IAAP;SA7FF;6BA+FiBzJ,KA/FjB;oBAgGUyK,aAAazK,KAAb,CAAR;gBACIA,UAAUM,SAAd,EAAyB;uBACjBN,KAAP;;;;;;mBAKM0J,QAAP;SAvGF;6BAyGqB1J,KAzGrB;gBA0GM4I,UAAU5I,KAAV,CAAJ,EAAsB;2BACVA,KAAX;;;;;;mBAKM2J,YAAP;;;;;mBAIOC,OAAP;SApHF;6BAsHoB5J,KAtHpB;oBAuHU0K,gBAAgB1K,KAAhB,CAAR;gBACIA,UAAUM,SAAd,EAAyB;0BACdN,KAAV;;;;;;mBAKM6J,kBAAP;SA9HF;6BAgI+B7J,KAhI/B;oBAiIU2K,2BAA2B3K,KAA3B,CAAR;gBACIA,UAAUM,SAAd,EAAyB;qCACHN,KAArB;;;;;;mBAKM8J,KAAP;SAxIF;6BA0IkB9J,KA1IlB;oBA2IU4K,cAAc5K,KAAd,CAAR;gBACIA,UAAUM,SAAd,EAAyB;wBAChBN,KAAR;;;;;;mBAKM+J,MAAP;SAlJF;6BAoJmB/J,KApJnB;oBAqJU6K,eAAe7K,KAAf,CAAR;gBACIA,UAAUM,SAAd,EAAyB;yBACfN,KAAT;;;;;;mBAKM+J,MAAP;;;;;mBAIOC,KAAP;SAhKF;6BAkKkBhK,KAlKlB;oBAmKU8K,cAAc9K,KAAd,CAAR;gBACIA,UAAUM,SAAd,EAAyB;wBAChBN,KAAR;;;;;;mBAIMiK,IAAP;SAzKF;6BA2KiBjK,KA3KjB;oBA4KU+K,aAAa/K,KAAb,CAAR;gBACIA,UAAUM,SAAd,EAAyB;uBACjBN,KAAP;;;;;;AAKH5B,OAAO4M,MAAP,CAAcC,UAAd;;AAGAA,WAASC,KAAT;;ACnNA;;;AAGA;;;AAKA,IAAaC,iBAA+D,EAArE;;;;;;;AAQP,IAAaC,qBAAmE,EAAzE;;;;;AAMP,IAAaC,wBAAwB,IAAIC,GAAJ,EAA9B;;;;;;;AAeP,IAAaC,eAA8C,EAApD;;;;;AAMP,IAAaC,mBAAmB,IAAIC,GAAJ,EAAzB;;ACjDP;AACA;AAIA,IAAMC,WAAW,cAAjB;;;;AAKA,cAAqBnM;;QAEdoM,OAAOpM,QAAQmM,QAAR,CAAb;QAEIC,IAAJ,EAAU;eACFA,IAAP;;QAEK1M,SAASM,QAAQqM,aAAR,CAAsBC,WAArC;QACIC,QAAQ,CAAZ;SAEK,IAAIC,QAAQ,CAAjB,EAAoBA,QAAQR,aAAazM,MAAzC,EAAiDiN,OAAjD,EAA0D;YACnDnN,eAAc2M,aAAaQ,KAAb,CAApB;YAEI7M,SAASN,YAAT,CAAJ,EAA2B;gBACtBW,mBAAmBN,OAAOL,YAAP,CAAvB,EAA4C;yBAClC,KAAKmN,KAAd,CAD2C;;SAD7C,MAIO,IAAIxM,mBAAmBX,YAAvB,EAAoC;qBACjC,KAAKmN,KAAd,CAD0C;;;;QAKtCC,UAAuB;oBAAA;eAErB,CAFqB;uBAGb,IAHa;eAIrB,EAJqB;mBAKjB,EALiB;2BAMT,EANS;wBAOZ,EAPY;;KAA7B;WAWO9L,cAAP,CAAsBX,OAAtB,EAA+BmM,QAA/B,EAAyC;eACjCM;KADR;WAIOA,OAAP;;;AC/CD;AACA,IAEMC,WAAWhN,UAAUA,WAAWA,OAAOA,MAA7C;IACCiN,qBAAqBD,YAAYhN,OAAOkN,WAAP,KAAuB7L,SADzD;AAGA,IAAa8L,QAAuB;sBAAA;cAEzBH,YAAY,iEAAiEI,IAAjE,CAAsEC,UAAUC,SAAhF,CAFa;mBAGpBN,YAAY,uBAAuBI,IAAvB,CAA4BC,UAAUC,SAAtC,CAHQ;mBAIpBN,YAAYO,SAASC,aAAT,CAAuB,KAAvB,CAJQ;0CAAA;kBAMrBP,qBAAqBjN,MAArB,GAA+B,CAACgN,QAAD,IAAaO,SAASE,eAAtB,IAAyCF,SAASG,IAAT,CAAcC,UAAvD,IAAqEJ,SAASG,IANxF;wBAOfT,qBAAqB,aAArB,GAAqC,YAPtB;uBAQhBA,qBAAqB,aAArB,GAAqC,WARrB;eASxBhK,SATwB;eAUxB,KAVwB;WAW5B5B,SAX4B;UAY7BA,SAZ6B;cAazBA;CAbJ;;ACJP;AACA;;;;AASA,gBAAA,CAAiBuM,SAAjB;QACOC,OAAOV,MAAMW,IAAnB;cAEUC,KAAV,GAAkBF,IAAlB;cACUG,KAAV,GAAkB3M,SAAlB;QACIwM,IAAJ,EAAU;aACJG,KAAL,GAAaJ,SAAb;KADD,MAEO;cACAK,KAAN,GAAcL,SAAd;;UAEKE,IAAN,GAAaF,SAAb;QACI,CAACT,MAAMe,QAAX,EAAqB;cACdA,QAAN,GAAiBN,SAAjB;;QAEKtN,UAAUsN,UAAUtN,OAA1B;QACCoM,OAAOyB,KAAK7N,OAAL,CADR;QAGI,CAACoM,KAAK0B,KAAL,EAAL,EAAmB;;;;iBAMT9N,OAAT,EAAkB6M,MAAM5M,SAAxB;;;;;;AAOF,iBAAsBD,SAA2BsN,WAA0BS;QACpE3B,OAAOyB,KAAK7N,OAAL,CAAb;QAEI+N,cAAc,KAAlB,EAAyB;;;aAGnBC,iBAAL,CAAuBD,SAAvB,IAAoCT,SAApC;;QAEGS,cAAc,KAAlB,EAAyB;gBAChBT,SAAR;KADD,MAEO;YACF,CAAC3N,SAASoO,SAAT,CAAL,EAA0B;wBACb,EAAZ;;YAEGP,OAAOpB,KAAK6B,SAAL,CAAeF,SAAf,CAAX;YAEI,CAACP,IAAL,EAAW;gBACNA,SAAS,IAAb,EAAmB;qBACbS,SAAL,CAAeF,SAAf,IAA4BT,SAA5B;aADD,MAEO;qBACDW,SAAL,CAAeF,SAAf,IAA4B,IAA5B;wBACQT,SAAR;;SALF,MAOO;mBACCE,KAAKE,KAAZ,EAAmB;uBACXF,KAAKE,KAAZ;;iBAEIA,KAAL,GAAaJ,SAAb;sBACUG,KAAV,GAAkBD,IAAlB;;;;;;;;;AAUH,iBAAwBxN,SAA2B+N,WAA8BG;QAC5EH,cAAc,KAAlB,EAAyB;YACpB,CAACpO,SAASoO,SAAT,CAAL,EAA0B;wBACb,EAAZ;;YAEK3B,OAAOyB,KAAK7N,OAAL,CAAb;YACCsN,YAAYlB,KAAK6B,SAAL,CAAeF,SAAf,CADb;YAGIT,SAAJ,EAAe;iBACTW,SAAL,CAAeF,SAAf,IAA4BT,UAAUI,KAAV,IAAmB,IAA/C;gBACI,CAACQ,IAAL,EAAW;wBACFZ,SAAR;;SAHF,MAKO,IAAIA,cAAc,IAAlB,EAAwB;mBACvBlB,KAAK6B,SAAL,CAAeF,SAAf,CAAP;;eAGMT,SAAP;;;;;;;;;AAUF,2BAAkCA;QAC3Ba,OAAOb,UAAUI,KAAvB;QACCH,OAAOD,UAAUG,KADlB;QAECM,YAAYT,UAAU/C,KAAV,IAAmB,IAAnB,GAA0B+C,UAAUc,OAAV,CAAkB7D,KAA5C,GAAoD+C,UAAU/C,KAF3E;QAIIsC,MAAMe,QAAN,KAAmBN,SAAvB,EAAkC;cAC3BM,QAAN,GAAiBO,IAAjB;;QAEGtB,MAAMc,KAAN,KAAgBL,SAApB,EAA+B;cACxBK,KAAN,GAAcQ,IAAd;KADD,MAEO,IAAIZ,IAAJ,EAAU;aACXG,KAAL,GAAaS,IAAb;;QAEGtB,MAAMW,IAAN,KAAeF,SAAnB,EAA8B;cACvBE,IAAN,GAAaD,IAAb;KADD,MAEO,IAAIY,IAAJ,EAAU;aACXV,KAAL,GAAaF,IAAb;;QAEGQ,SAAJ,EAAe;YACR3B,OAAOyB,KAAKP,UAAUtN,OAAf,CAAb;YAEIoM,IAAJ,EAAU;sBACCsB,KAAV,GAAkBJ,UAAUG,KAAV,GAAkB1M,SAApC;;;;;ACjII,IAAMsN,kBAAkD,EAAxD;;ACEP;AACA;;;;AAUA,qBAAA,CAAsBC,UAAtB;QACO9M,WAAW8M,WAAWxE,QAAX,IAAuBwE,WAAWF,OAAX,CAAmBtE,QAA3D;QAEItI,QAAJ,EAAc;YACT;gBACG+M,WAAWD,WAAWC,QAA5B;qBAESvP,IAAT,CAAcuP,QAAd,EAAwBA,QAAxB,EAAkCD,UAAlC;SAHD,CAIE,OAAO9E,KAAP,EAAc;uBACJ;sBACJA,KAAN;aADD,EAEG,CAFH;;;;;;;;;AAYH,sBAA6B8E;;QAEtBF,UAAUE,WAAWF,OAA3B;QACC7D,QAAQiE,SAASF,WAAW/D,KAApB,EAA2B6D,QAAQ7D,KAAnC,CADT;QAECkE,SAASD,SAASF,WAAWpE,IAApB,EAA0BkE,QAAQlE,IAAlC,EAAwCwB,WAASxB,IAAjD,CAFV;QAGCwE,WAAWF,SAASF,WAAW9D,MAApB,EAA4B4D,QAAQ5D,MAApC,EAA4CkB,WAASlB,MAArD,CAHZ;QAICmE,YAAYL,WAAWM,MAAX,IAJb;QAMI,CAACD,SAAD,KAAeF,UAAUC,QAAzB,CAAJ,EAAwC;;;;;YAOnCA,YAAYA,aAAa,IAA7B,EAAmC;uBACvBlE,MAAX,GAAoBkE,WAAW,CAA/B;SADD,MAEO,IAAID,UAAUA,WAAW,IAAzB,EAA+B;uBAC1BvE,IAAX,GAAkBuE,SAAS,CAA3B;uBACWjE,MAAX,GAAoBgE,SAASF,WAAWO,WAApB,EAAiCT,QAAQS,WAAzC,EAAsDnD,WAASmD,WAA/D,CAApB;;YAEGJ,MAAJ,EAAY;uBACAG,MAAX,MAAA,eADW;;YAGRrE,UAAU,KAAd,EAAqB;;iBAEf+D,WAAWtO,OAAhB,EAAyB8O,cAAzB,CAAwCvE,KAAxC,IAAiD+D,WAAWS,SAAX,GAAuBP,SAASF,WAAWrG,QAApB,EAA8BmG,QAAQnG,QAAtC,EAAgDyD,WAASzD,QAAzD,CAAxE;;mBAEU8G,SAAX,GAAuBT,WAAWU,YAAX,GAA0BV,WAAWvL,eAAX,GAA6B,CAA9E;mBACW6L,MAAX,IAAqB,EAArB,eArBuC;KAAxC,MAsBO;YACA5O,UAAUsO,WAAWtO,OAA3B;YACCoM,OAAOyB,KAAK7N,OAAL,CADR;YAGI,IAAGoM,KAAK0B,KAAR,IAAiB,CAACa,SAAtB,EAAiC;;;;wBAMpB3O,OAAZ,EAAqB6M,MAAM5M,SAA3B;;;;;;;;YAUGmO,WAAW,EAAEA,QAAQa,UAAV,KAAyBb,QAAQc,MAAhD,EAAwD;gBACnD,CAACP,SAAD,IAAcP,QAAQtE,QAA1B,EAAoC;;;6BAGtBwE,UAAb;wBACQxE,QAAR,GAAmB,IAAnB;;gBAEKqF,WAAWf,QAAQgB,SAAzB;gBAEID,QAAJ,EAAc;;yBAEJb,WAAWC,QAApB;uBACOH,QAAQgB,SAAf;;;;;;YAQE7E,UAAU,KAAd,EAAqB;;gBAEhB,CAACoE,SAAL,EAAgB;;;;qBAIVG,cAAL,CAAoBvE,KAApB,IAA6B+D,WAAWS,SAAX,GAAuBP,SAASF,WAAWrG,QAApB,EAA8BmG,QAAQnG,QAAtC,EAAgDyD,WAASzD,QAAzD,CAApD;;;;oBAIOjI,OAAR,EAAiBuK,KAAjB;;;0BAGiB+D,UAAlB;;;;AC/GF;AACA;;;;;;;;;;;;;;;;AAqBA,+BACC1N;QAIMvB,cAAcuB,KAAK,CAAL,CAApB;QACCJ,OAAeI,KAAK,CAAL,CADhB;QAECY,WAAWZ,KAAK,CAAL,CAFZ;QAIKjB,SAASN,WAAT,KAAyB,EAAEK,OAAOL,WAAP,aAA+BR,MAAjC,CAA1B,IACC,CAACc,SAASN,WAAT,CAAD,IAA0B,EAAEA,uBAAuBR,MAAzB,CAD/B,EACkE;gBACzD4C,IAAR,uFAAmGpC,WAAnG;KAFD,MAGO,IAAI,CAACM,SAASa,IAAT,CAAL,EAAqB;gBACnBiB,IAAR,gFAA4FjB,IAA5F;KADM,MAEA,IAAI,CAAChB,WAAWgC,QAAX,CAAL,EAA2B;gBACzBC,IAAR,oFAAgGjB,IAAhG,EAAsGgB,QAAtG;KADM,MAEA;YACFgL,QAAQR,aAAaqD,OAAb,CAAqBhQ,WAArB,CAAZ;YACCiQ,UAAU,CADX;YAGI9C,QAAQ,CAAR,IAAa,CAAC7M,SAASN,WAAT,CAAlB,EAAyC;gBACpC4M,iBAAiBsD,GAAjB,CAAqBlQ,WAArB,CAAJ,EAAuC;wBAC9B2M,aAAaqD,OAAb,CAAqBpD,iBAAiBuD,GAAjB,CAAqBnQ,WAArB,CAArB,CAAR;aADD,MAEO;qBACD,IAAMS,QAAX,IAAuBJ,MAAvB,EAA+B;wBAC1BA,OAAOI,QAAP,MAAqBT,WAAzB,EAAsC;gCAC7B2M,aAAaqD,OAAb,CAAqBvP,QAArB,CAAR;4BACI0M,QAAQ,CAAZ,EAAe;oCACNR,aAAapD,IAAb,CAAkB9I,QAAlB,IAA8B,CAAtC;2CACe0M,KAAf,IAAwB,EAAxB;6CACiBiD,GAAjB,CAAqBpQ,WAArB,EAAkCS,QAAlC;;;;;;;YAOD0M,QAAQ,CAAZ,EAAe;oBACNR,aAAapD,IAAb,CAAkBvJ,WAAlB,IAAiC,CAAzC;2BACemN,KAAf,IAAwB,EAAxB;;uBAEcA,KAAf,EAAsBhM,IAAtB,IAA8BgB,QAA9B;YACI7B,SAASiB,KAAK0O,OAAL,CAAT,CAAJ,EAA6B;gBACtBI,OAAO9O,KAAK0O,SAAL,CAAb;gBACIK,QAAQ9D,mBAAmB6D,IAAnB,CAAZ;gBAEI,CAACC,KAAL,EAAY;wBACH9D,mBAAmB6D,IAAnB,IAA2B,EAAnC;;kBAEK9G,IAAN,CAAWpH,QAAX;;YAEGZ,KAAK0O,OAAL,MAAkB,KAAtB,EAA6B;kCACNlP,GAAtB,CAA0BI,IAA1B;;;;;;;AAQH,0BAAiCI;QAC1BvB,cAAcuB,KAAK,CAAL,CAApB;QACCJ,OAAeI,KAAK,CAAL,CADhB;QAEI4L,QAAQR,aAAaqD,OAAb,CAAqBhQ,WAArB,CAAZ;QAEImN,QAAQ,CAAR,IAAa,CAAC7M,SAASN,WAAT,CAAlB,EAAyC;YACpC4M,iBAAiBsD,GAAjB,CAAqBlQ,WAArB,CAAJ,EAAuC;oBAC9B2M,aAAaqD,OAAb,CAAqBpD,iBAAiBuD,GAAjB,CAAqBnQ,WAArB,CAArB,CAAR;SADD,MAEO;iBACD,IAAMS,QAAX,IAAuBJ,MAAvB,EAA+B;oBAC1BA,OAAOI,QAAP,MAAqBT,WAAzB,EAAsC;4BAC7B2M,aAAaqD,OAAb,CAAqBvP,QAArB,CAAR;;;;;;WAOG0M,SAAS,CAAT,IAAcZ,eAAeY,KAAf,EAAsBpN,cAAtB,CAAqCoB,IAArC,CAArB;;;;;AAMD,8BAAqCwI;SAC/B,IAAM0G,IAAX,IAAmB7D,kBAAnB,EAAuC;YAClCA,mBAAmB6D,IAAnB,EAAyBE,QAAzB,CAAkC5G,EAAlC,CAAJ,EAA2C;mBACnC0G,IAAP;;;WAIK,EAAP;;;;;;;AAQD,0BAAiC1P,SAA2B6P;QACrDzD,OAAOyB,KAAK7N,OAAL,CAAb;QACIgJ,WAAJ;SAEK,IAAIwD,QAAQR,aAAazM,MAAb,GAAsB,CAAlC,EAAqCgN,QAAQH,KAAKG,KAAvD,EAA8D,CAACvD,EAAD,IAAOwD,SAAS,CAA9E,EAAiFA,OAAjF,EAA0F;YACrFD,QAAS,KAAKC,KAAlB,EAA0B;;iBACpBZ,eAAeY,KAAf,EAAsBqD,YAAtB,CAAL;;;WAIK7G,EAAP;;AAGDtH,eAAe,CAAC,uBAAD,EAA0BoO,qBAA1B,CAAf;AACApO,eAAe,CAAC,kBAAD,EAAqBqO,gBAArB,CAAf;;AC7IA;AACA;;;;AASA,0BAAiC/P,SAA2B6P,cAAsBG,eAAoBhH;QAC/FiH,UAAUnE,sBAAsByD,GAAtB,CAA0BM,YAA1B,CAAhB;QACCzD,OAAO,CAAC6D,OAAD,IAAYpC,KAAK7N,OAAL,CADpB;QAGIiQ,WAAY7D,QAAQA,KAAKtD,KAAL,CAAW+G,YAAX,MAA6BG,aAArD,EAAqE;;YAEhE,CAACC,OAAL,EAAc;iBACRnH,KAAL,CAAW+G,YAAX,IAA2BG,iBAAiBjP,SAA5C;;aAEIiI,MAAMkH,iBAAiBlQ,OAAjB,EAA0B6P,YAA1B,CAAX;YACI7G,EAAJ,EAAQ;eACJhJ,OAAH,EAAYgQ,aAAZ;;YAEGG,YAASC,KAAT,IAAkB,CAAtB,EAAyB;oBAChBC,IAAR,YAAqBR,YAArB,cAAwCG,aAAxC,SAA0DhQ,OAA1D;;;;;AC3BH;;;AAGA,IAAM8I,UAAsC,EAA5C;;;;;;AAOA,mBAA0BhJ;MACnBwQ,QAAQxH,QAAMhJ,QAAN,CAAd;MAEIwQ,KAAJ,EAAW;WACHA,KAAP;;SAGMxH,QAAMhJ,QAAN,IAAkBA,SAASsB,OAAT,CAAiB,WAAjB,EAA8B,UAACmP,CAAD,EAAYC,MAAZ;WAA+BA,OAAOC,WAAP,EAA/B;GAA9B,CAAzB;;;ACjBD;AACA,IAAMC,WAAW,yCAAjB;IACCC,WAAW,gCADZ;IAECC,cAAc,4BAFf;IAGCC,QAAQ,uBAHT;IAICC,WAAW,MAJZ;;;;;;AAWA,IAAaC,aAAuC,EAA7C;;;;AAKP,iBAAA,CAAkBC,MAAlB,EAA+BC,CAA/B,EAA0CC,CAA1C,EAAqDvJ,CAArD;qBACgBiC,SAASqH,CAAT,EAAY,EAAZ,CAAf,SAAkCrH,SAASsH,CAAT,EAAY,EAAZ,CAAlC,SAAqDtH,SAASjC,CAAT,EAAY,EAAZ,CAArD;;;;;;AAOD,mBAA0BrB;WAClBA,IACLlF,OADK,CACGsP,QADH,EACaS,QADb,EAEL/P,OAFK,CAEGuP,QAFH,EAEa,UAACS,EAAD,EAAKH,CAAL,EAAQC,CAAR,EAAWvJ,CAAX;eACXwJ,SAASC,EAAT,EAAaH,IAAIA,CAAjB,EAAoBC,IAAIA,CAAxB,EAA2BvJ,IAAIA,CAA/B,CAAP;KAHK,EAKLvG,OALK,CAKGwP,WALH,EAKgB,UAACQ,EAAD,EAAKC,EAAL,EAASC,EAAT;YACjBP,WAAWO,EAAX,CAAJ,EAAoB;mBACZ,CAACD,KAAKA,EAAL,GAAU,OAAX,IAAsBN,WAAWO,EAAX,CAAtB,IAAwCD,KAAK,EAAL,GAAU,KAAlD,CAAP;;eAGMD,EAAP;KAVK,EAYLhQ,OAZK,CAYGyP,KAZH,EAYU,UAACO,EAAD,EAAKC,EAAL,EAASC,EAAT;0BACAA,GAAGlQ,OAAH,CAAW0P,QAAX,EAAqB,EAArB,KAA4BO,KAAK,EAAL,GAAU,IAAtC,CAAf;KAbK,CAAP;;;ACvBD;AACA;;;;AAMA,0BAAiCrR,SAA2BQ,MAA0B+Q;QAC/EC,cAAcC,iBAAiBzR,OAAjB,EAA0B,WAA1B,EAClBjB,QADkB,GAElBoK,WAFkB,OAEA,YAFpB;QAIIqI,gBAAgBD,SAApB,EAA+B;;;YAGxBG,QAAQlR,SAAS,OAAT,GAAmB,CAAC,MAAD,EAAS,OAAT,CAAnB,GAAuC,CAAC,KAAD,EAAQ,QAAR,CAArD;YACCmR,SAAS,aAAWD,MAAM,CAAN,CAAX,cAAiCA,MAAM,CAAN,CAAjC,aAAsDA,MAAM,CAAN,CAAtD,uBAAgFA,MAAM,CAAN,CAAhF,WADV;YAEIE,UAAU,CAAd;;;;;;iCAEoBD,MAApB,8HAA4B;oBAAjBE,KAAiB;;oBACrBpR,QAAQ0H,WAAWsJ,iBAAiBzR,OAAjB,EAA0B6R,KAA1B,CAAX,CAAd;oBAEI,CAAC/M,MAAMrE,KAAN,CAAL,EAAmB;+BACPA,KAAX;;;;;;;;;;;;;;;;;;eAIK8Q,YAAY,CAACK,OAAb,GAAuBA,OAA9B;;WAGM,CAAP;;;AC9BD;AACA;;;;AAWA,uBAAA,CAAwB5R,OAAxB,EAAmDF,QAAnD;WACSE,QAAQ8R,qBAAR,GAAgChS,QAAhC,IAA4CiS,iBAAiB/R,OAAjB,EAA0BF,QAA1B,EAAoC,IAApC,CAA7C,GAA0F,IAAjG;;;AAID,8BAAqCE,SAA2BF;QACzDsM,OAAOyB,KAAK7N,OAAL,CAAb;;;;oBAGiBoM,KAAK4F,aAAL,GAAqB5F,KAAK4F,aAA1B,GAA0C5F,KAAK1M,MAAL,CAAYuS,gBAAZ,CAA6BjS,OAA7B,EAAsC,IAAtC,CAH3D;QAIIkS,gBAAiC,CAArC;QAEI,CAAC9F,KAAK4F,aAAV,EAAyB;aACnBA,aAAL,GAAqBA,aAArB;;QAEGA,cAAc,SAAd,MAA6B,MAAjC,EAAyC;gBAChClS,QAAR;iBACM,OAAL;iBACK,QAAL;;;;iCAIkBE,OAAjB,EAA0B,SAA1B,EAAqC,MAArC;gCACgBmS,eAAenS,OAAf,EAAwBF,QAAxB,CAAhB;iCACiBE,OAAjB,EAA0B,SAA1B,EAAqC,MAArC;uBAEOoS,OAAOF,aAAP,CAAP;;;;;;;oBASaF,cAAclS,QAAd,CAAhB;;;QAGI,CAACoS,aAAL,EAAoB;wBACHlS,QAAQqS,KAAR,CAAcvS,QAAd,CAAhB;;;;;;;;QAQGoS,kBAAkB,MAAtB,EAA8B;gBACrBpS,QAAR;iBACM,OAAL;iBACK,QAAL;gCACiBqS,eAAenS,OAAf,EAAwBF,QAAxB,CAAhB;;iBAGI,KAAL;iBACK,MAAL;AACC;iBACI,OAAL;iBACK,QAAL;oBACOwS,WAAWb,iBAAiBzR,OAAjB,EAA0B,UAA1B,CAAjB;oBAEIsS,aAAa,OAAb,IAAyBC,aAAwB,UAArD,EAAkE;;;;oCAIjDvS,QAAQ8R,qBAAR,CAA8BhS,QAA9B,IAA0C,IAA1D;;;;;gCAKe,KAAhB;;;;WAKIoS,gBAAgBE,OAAOF,aAAP,CAAhB,GAAwC,EAA/C;;;;;;AAOD,0BAAiClS,SAA2B6P,cAAsB7G,IAA+BwJ;QAC1GpG,OAAOyB,KAAK7N,OAAL,CAAb;QACIgQ,sBAAJ;QAEIlE,sBAAsByD,GAAtB,CAA0BM,YAA1B,CAAJ,EAA6C;oBAChC,IAAZ;;QAEG,CAAC2C,SAAD,IAAcpG,IAAd,IAAsBA,KAAKtD,KAAL,CAAW+G,YAAX,KAA4B,IAAtD,EAA4D;wBAC3CzD,KAAKtD,KAAL,CAAW+G,YAAX,CAAhB;KADD,MAEO;aACD7G,MAAMkH,iBAAiBlQ,OAAjB,EAA0B6P,YAA1B,CAAX;YACI7G,EAAJ,EAAQ;4BACSA,GAAGhJ,OAAH,CAAhB;gBACIoM,IAAJ,EAAU;qBACJtD,KAAL,CAAW+G,YAAX,IAA2BG,aAA3B;;;;QAICG,YAASC,KAAT,IAAkB,CAAtB,EAAyB;gBAChBC,IAAR,YAAqBR,YAArB,cAAwCG,aAAxC,SAA0DhQ,OAA1D;;WAGMgQ,aAAP;;;AC/GD;AACA;AAcA,IAAMyC,QAAQ,uBAAd;IACCC,WAQI;cACO,mBAACjS,KAAD,EAAQT,OAAR,EAAiBuO,QAAjB,EAA2BoE,iBAA3B,EAA8C9C,YAA9C,EAA4D+C,KAA5D;eACDnS,MAAyCzB,IAAzC,CAA8CgB,OAA9C,EAAuD2S,iBAAvD,EAA0EpE,SAAShP,MAAnF,EAA2FsQ,YAA3F,CAAR;KAFE;YAIK,gBAACpP,KAAD,EAAQT,OAAR,EAAiBuO,QAAjB,EAA2BoE,iBAA3B,EAA8C9C,YAA9C,EAA4D+C,KAA5D;eACAR,OAAO3R,KAAP,IAAgBoS,qBAAqBD,MAAM5J,EAA3B,CAAvB;KALE;YAOK,gBAACvI,KAAD,EAAQT,OAAR,EAAiBuO,QAAjB,EAA2BoE,iBAA3B,EAA8C9C,YAA9C,EAA4D+C,KAA5D;eACAE,UAAUrS,KAAV,CAAP;KARE;eAUQ,mBAACA,KAAD,EAAQT,OAAR,EAAiBuO,QAAjB,EAA2BoE,iBAA3B,EAA8C9C,YAA9C,EAA4D+C,KAA5D;eACHE,UAAUrB,iBAAiBzR,OAAjB,EAA0B6P,YAA1B,EAAwC+C,MAAM5J,EAA9C,KAAqD,EAA/D,CAAP;;CApBH;;;;;;AA6BA,0BAAiCsE,WAA0ByF;QACpDC,SAAS1F,UAAU0F,MAAV,GAAmBnU,OAAOoU,MAAP,CAAc,IAAd,CAAlC;QACC1E,WAAWjB,UAAUiB,QADtB;QAECvO,UAAUsN,UAAUtN,OAFrB;QAGC2S,oBAAoBpE,SAASc,OAAT,CAAiBrP,OAAjB,CAHrB;QAICoM,OAAOyB,KAAK7N,OAAL,CAJR;QAKCuK,QAAQiE,SAASlB,UAAU/C,KAAnB,EAA0B+C,UAAUc,OAAV,CAAkB7D,KAA5C,CALT;QAMCtC,WAAWuG,SAASlB,UAAUc,OAAV,CAAkBnG,QAA3B,EAAqCyD,WAASzD,QAA9C,CANZ;SAQK,IAAMnI,QAAX,IAAuBiT,UAAvB,EAAmC;YAC9BA,WAAW3T,cAAX,CAA0BU,QAA1B,CAAJ,EAAyC;gBAClC+P,eAAeqD,UAAUpT,QAAV,CAArB;gBACCkJ,KAAKkH,iBAAiBlQ,OAAjB,EAA0B6P,YAA1B,CADN;gBAEIsD,YAAYJ,WAAWjT,QAAX,CAAhB;gBAEI,CAACkJ,EAAD,IAAO6G,iBAAiB,OAA5B,EAAqC;oBAChCM,YAASC,KAAb,EAAoB;4BACXgD,GAAR,iBAAyBtT,QAAzB;;;;gBAIEqT,aAAa,IAAjB,EAAuB;oBAClBhD,YAASC,KAAb,EAAoB;4BACXgD,GAAR,iBAAyBtT,QAAzB;;;;gBAII8S,QAAuBI,OAAOnD,YAAP,IAAuB,EAApD;gBACI5M,iBAAJ;gBACCD,mBADD;kBAGMgG,EAAN,GAAWA,EAAX;gBACIxJ,WAAW2T,SAAX,CAAJ,EAA2B;;;;4BAIbA,UAAiCnU,IAAjC,CAAsCgB,OAAtC,EAA+C2S,iBAA/C,EAAkEpE,SAAShP,MAA3E,EAAmFgP,QAAnF,CAAb;;gBAEGjO,MAAMmJ,OAAN,CAAc0J,SAAd,CAAJ,EAA8B;;;oBAGvBE,OAAOF,UAAU,CAAV,CAAb;oBACCG,OAAOH,UAAU,CAAV,CADR;2BAGWA,UAAU,CAAV,CAAX;oBACKxT,SAAS0T,IAAT,MAAmB,SAASvG,IAAT,CAAcuG,IAAd,KAAuBZ,MAAM3F,IAAN,CAAWuG,IAAX,CAA1C,CAAD,IAAiE7T,WAAW6T,IAAX,CAAjE,IAAqF/T,SAAS+T,IAAT,CAAzF,EAAyG;iCAC3FA,IAAb;iBADD,MAEO,IAAK1T,SAAS0T,IAAT,KAAkBxQ,QAAQwQ,IAAR,CAAnB,IAAqC/S,MAAMmJ,OAAN,CAAc4J,IAAd,CAAzC,EAA8D;0BAC9DrJ,MAAN,GAAeW,eAAe0I,IAAf,EAAqBpL,QAArB,CAAf;iCACaqL,IAAb;iBAFM,MAGA;iCACOD,QAAQC,IAArB;;aAbF,MAeO;2BACKH,SAAX;;kBAEKI,GAAN,GAAYb,gBAAgBzP,QAAhB,yCAAgBA,QAAhB,GAA0BA,QAA1B,EAAoCjD,OAApC,EAA6CuO,QAA7C,EAAuDoE,iBAAvD,EAA0E9C,YAA1E,EAAwF+C,KAAxF,CAAZ;gBACI5P,cAAc,IAAd,IAAuBuH,UAAU,KAAV,IAAmB6B,KAAK6B,SAAL,CAAe1D,KAAf,MAA0BxJ,SAAxE,EAAoF;sBAC7EyS,KAAN,GAAcd,gBAAgB1P,UAAhB,yCAAgBA,UAAhB,GAA4BA,UAA5B,EAAwChD,OAAxC,EAAiDuO,QAAjD,EAA2DoE,iBAA3D,EAA8E9C,YAA9E,EAA4F+C,KAA5F,CAAd;6BACa/C,YAAb,EAA2B+C,KAA3B,EAAkC3K,QAAlC;;;;;;AAOJ,IAAMwL,UAAU,0FAAhB;IACCC,WAAW,2CADZ;;;;;;;;;;;AAaA,qBAA4BC,OAA8B9D;QACnD+D,cAAcD,MAAMpU,MAA1B;QACCsU,SAAqB,EADtB;QAECC,UAAoB,EAFrB;QAGIC,gBAAJ;;;SAIK,IAAIC,OAAO,CAAhB,EAAmBA,OAAOJ,WAA1B,EAAuCI,MAAvC,EAA+C;YAC1CrU,SAASgU,MAAMK,IAAN,CAAT,CAAJ,EAA2B;gBACtBL,MAAMK,IAAN,MAAgB,EAApB,EAAwB;uBAChBA,IAAP,IAAe,CAAC,EAAD,CAAf;aADD,MAEO;uBACCA,IAAP,IAAeC,WAAWN,MAAMK,IAAN,EAAYE,KAAZ,CAAkBT,OAAlB,CAAX,CAAf;;oBAEOO,IAAR,IAAgB,CAAhB;;sBAEUD,WAAWF,OAAOG,IAAP,EAAazU,MAAb,GAAsB,CAA3C;;SARD,MAUO;;;;;QAKF4U,WAAqB,EAA3B;QACCC,UAAWD,SAASC,OAAT,GAAmB,EAD/B;QAECC,YAAY,SAAZA,SAAY,CAACC,IAAD;YACP3U,SAASyU,QAAQA,QAAQ7U,MAAR,GAAiB,CAAzB,CAAT,CAAJ,EAA2C;oBAClC6U,QAAQ7U,MAAR,GAAiB,CAAzB,KAA+B+U,IAA/B;SADD,MAEO,IAAIA,IAAJ,EAAU;oBACR1L,IAAR,CAAa0L,IAAb;iBACK,IAAIN,QAAO,CAAhB,EAAmBA,QAAOJ,WAA1B,EAAuCI,OAAvC,EAA+C;yBACpCA,KAAT,EAAyBpL,IAAzB,CAA8B,IAA9B;;;KARL;QAYC2L,mBAAmB,SAAnBA,gBAAmB;YACdR,WAAWK,QAAQ7U,MAAR,GAAiB,CAAhC,EAAmC;;;;YAI7BiV,YAAY3E,iBAAiB,SAAnC;YACC4E,eAAe5E,iBAAiB,YADjC;aAGK,IAAImE,SAAO,CAAhB,EAAmBA,SAAOJ,WAA1B,EAAuCI,QAAvC,EAA+C;gBACxCvT,QAAQkT,MAAMK,MAAN,CAAd;qBAESA,MAAT,EAAe,CAAf,IAAoBvT,KAApB;;qBAESuT,MAAT,EAAehK,MAAf,GAAwBW,eAAgB6J,aAAa/T,UAAU,MAAxB,IAAoCgU,gBAAgBhU,UAAU,QAA9D,IAA4E,CAAC+T,SAAD,IAAc,CAACC,YAA3F,GAA2G,QAA3G,GAAsH,UAArI,EAAiJ,GAAjJ,CAAxB;;gBAEO,CAAR,IAAa,KAAb;eAEON,QAAP;KA7BF;QA+BIO,OAAO,IAAX;SAEK,IAAIV,SAAO,CAAhB,EAAmBA,SAAOJ,WAA1B,EAAuCI,QAAvC,EAA+C;iBACrCA,MAAT,IAAiB,EAAjB;;WAEMU,IAAP,EAAa;YACNC,OAAyD,EAA/D;YACChF,QAAkB,EADnB;YAEI2E,aAAJ;YACCM,aAAa,KADd;YAECC,aAAa,KAFd;aAIK,IAAIb,SAAO,CAAhB,EAAmBA,SAAOJ,WAA1B,EAAuCI,QAAvC,EAA+C;gBACxCxH,QAAQsH,QAAQE,MAAR,GAAd;gBACCc,QAAQjB,OAAOG,MAAP,EAAaxH,KAAb,CADT;gBAGIsI,KAAJ,EAAW;oBACJrR,MAAMqR,MAAMZ,KAAN,CAAYR,QAAZ,CAAZ,CADU;oBAGNjQ,GAAJ,EAAS;;wBAEJ6Q,IAAJ,EAAU;+BACFC,kBAAP;;wBAEKQ,SAAS5M,WAAW1E,IAAI,CAAJ,CAAX,CAAf;wBACCiM,OAAOjM,IAAI,CAAJ,CADR;wBAECuR,SAASvR,IAAI,CAAJ,IAASA,IAAI,CAAJ,EAAO,CAAP,IAAYiM,IAArB,GAA4B3O,SAFtC;wBAGCkU,eAAeD,UAAUtF,IAH1B;wBAKIqF,UAAU,CAACpF,MAAMC,QAAN,CAAeqF,YAAf,CAAf,EAA6C;;8BAEtCrM,IAAN,CAAWqM,YAAX;;wBAEG,CAACvF,IAAL,EAAW;4BACNqF,MAAJ,EAAY;yCACE,IAAb;yBADD,MAEO;yCACO,IAAb;;;yBAGGf,MAAL,IAAagB,SAAS,CAACD,MAAD,EAASE,YAAT,EAAuB,IAAvB,CAAT,GAAwC,CAACF,MAAD,EAASE,YAAT,CAArD;iBArBD,MAsBO,IAAIN,KAAKpV,MAAT,EAAiB;2BAChBgV,kBAAP;iBADM,MAEA;;wBAEF,CAACD,IAAL,EAAW;+BACHQ,KAAP;qBADD,MAEO,IAAIR,SAASQ,KAAb,EAAoB;+BACnBP,kBAAP;;;aAhCH,MAmCO,IAAI,CAACP,MAAL,EAAW;uBACVA,SAAOJ,WAAd,EAA2BI,QAA3B,EAAmC;wBAC5BkB,SAASpB,QAAQE,MAAR,GAAf;wBAEIH,OAAOG,MAAP,EAAakB,MAAb,CAAJ,EAA0B;+BAClBX,kBAAP;;;;uBAIK,KAAP;;aATM,MAWA;;;;;YAKJD,IAAJ,EAAU;sBACCA,IAAV;SADD,MAEO,IAAI3E,MAAMpQ,MAAV,EAAkB;gBACpBoQ,MAAMpQ,MAAN,KAAiB,CAAjB,IAAsBqV,UAAtB,IAAoC,CAACC,UAAzC,EAAqD;;sBAE9CM,MAAN,CAAaxF,MAAM,CAAN,IAAW,CAAX,GAAe,CAA5B,EAA+B,CAA/B;;gBAEGA,MAAMpQ,MAAN,KAAiB,CAArB,EAAwB;;oBAEjBmQ,QAAOC,MAAM,CAAN,CAAb;oBACCyF,cAAc1F,MAAK,CAAL,CADf;wBAGQ0F,WAAR;yBACM,GAAL;yBACK,GAAL;yBACK,GAAL;yBACK,GAAL;4BACKvF,YAAJ,EAAkB;oCACTrG,KAAR,0EAAoFqG,YAApF,UAAsG8D,KAAtG;;;;wBAKK/K,IAAR,CAAa,KAAb;qBACK,IAAIoL,SAAO,CAAhB,EAAmBA,SAAOJ,WAA1B,EAAuCI,QAAvC,EAA+C;6BACpCA,MAAT,EAAyBpL,IAAzB,CAA8B+L,KAAKX,MAAL,EAAW,CAAX,CAA9B;;0BAEQtE,KAAV;aApBD,MAqBO;;0BAEI,OAAV;oBACM2F,cAAcjB,QAAQ7U,MAAR,GAAiB,CAArC,CAHM;qBAKD,IAAIsF,IAAI,CAAb,EAAgBA,IAAI8K,MAAMpQ,MAA1B,EAAkCsF,GAAlC,EAAuC;wBAChC6K,SAAOC,MAAM9K,CAAN,CAAb;wBACCuQ,eAAc1F,OAAK,CAAL,CADf;wBAEC4F,YAAYF,iBAAgB,GAAhB,IAAuBA,iBAAgB,GAFpD;wBAGCG,UAAUD,aAAaF,iBAAgB,GAA7B,IAAoCA,iBAAgB,GAH/D;wBAKIE,SAAJ,EAAe;;gCAEND,WAAR,KAAwB,GAAxB;kCACU,GAAV;;wBAEGxQ,CAAJ,EAAO;yCACQ0Q,UAAUH,YAAV,GAAwB,GAAtC;;4BAEOxM,IAAR,CAAa,KAAb;yBACK,IAAIoL,SAAO,CAAhB,EAAmBA,SAAOJ,WAA1B,EAAuCI,QAAvC,EAA+C;4BACxCwB,MAAMb,KAAKX,MAAL,CAAZ;4BACCvT,QAAQ+U,IAAI,CAAJ,MAAW9F,MAAX,GACL8F,IAAI,CAAJ,CADK,GAELA,IAAIjW,MAAJ,KAAe,CAAf,GACC4U,SAASH,SAAO,CAAhB,EAAmBG,SAASH,SAAO,CAAhB,EAAmBzU,MAAnB,GAA4B,CAA/C,CADD,GAEC+V,YAAY,CAAZ,GAAgB,CALrB;iCAOUtB,MAAT,EAAyBpL,IAAzB,CAA8BnI,KAA9B;;8BAEQ8U,UAAU7F,OAAK+F,SAAL,CAAe,CAAf,CAAV,GAA8B/F,MAAxC;;0BAES,GAAV;;;;;;;SAOE,IAAI7K,KAAI,CAAR,EAAW6Q,QAAQ,CAAxB,EAA2B7Q,KAAIuP,QAAQ7U,MAAvC,EAA+CsF,IAA/C,EAAoD;YAC7CyP,QAAOF,QAAQvP,EAAR,CAAb;YAEIlF,SAAS2U,KAAT,CAAJ,EAAoB;gBACfoB,SAAUpB,MAAgBjF,OAAhB,CAAwB,GAAxB,KAAgC,CAA9C,EAAiD;;aAAjD,MAEO,IAAKiF,MAAgBjF,OAAhB,CAAwB,KAAxB,KAAkC,CAAvC,EAA0C;wBACxC,CAAR;;SAJF,MAMO,IAAIqG,KAAJ,EAAW;gBACbA,QAAQ,CAAZ,EAAe;wBACN7Q,EAAR,IAAa,IAAb;aADD,MAEO;wBACE,CAAR;;;;WAKIsP,QAAP;;;;;;AAOD,qBAAA,CAAsBtE,YAAtB,EAA4C+C,KAA5C,EAAkE3K,QAAlE,EAAoF0N,QAApF;QACO3S,aAAqB4P,MAAMY,KAAjC;QACCvQ,WAAmB2P,MAAMW,GAD1B;QAGI,CAAC5T,SAASsD,QAAT,CAAD,IAAuB,CAACtD,SAASqD,UAAT,CAA5B,EAAkD;;;QAG9CmR,WAAqByB,YAAY,CAAC5S,UAAD,EAAaC,QAAb,CAAZ,EAAoC4M,YAApC,CAAzB;QAEI,CAACsE,QAAD,IAAawB,QAAjB,EAA2B;;;;;;;YAOpBE,eAAe7S,WAAWkR,KAAX,CAAiB,WAAjB,KAAiC,CAAC,GAAD,CAAtD;YACCpG,QAAQ+H,aAAatW,MADtB;YAEIiN,QAAQ,CAAZ;mBAEWoJ,YAAY,CAAC3S,SAAS7B,OAAT,CAAiB,YAAjB,EAA+B;mBAC/CyU,aAAarJ,UAAUsB,KAAvB,CAAP;SADuB,CAAD,EAEnB7K,QAFmB,CAAZ,EAEI4M,YAFJ,CAAX;;QAIGsE,QAAJ,EAAc;YACThE,YAASC,KAAb,EAAoB;oBACXgD,GAAR,8BAAyCe,QAAzC;;iBAEQ,CAAT,EAAY2B,OAAZ,GAAsB,CAAtB;iBACS,CAAT,EAAYA,OAAZ,GAAsB,CAAtB;cACM3B,QAAN,GAAiBA,QAAjB;gBACQvB,MAAM5I,MAAd;iBACMnH,QAAQ,UAAR,CAAL;iBACKA,QAAQ,QAAR,CAAL;iBACKA,QAAQ,QAAR,CAAL;yBACU,CAAT,EAAYmH,MAAZ,GAAqBmK,SAAS,CAAT,EAAYnK,MAAZ,GAAqB4I,MAAM5I,MAAhD;;;;;;;;;;;AAYJ,wBAA+BsE;;QAE1BzB,MAAMe,QAAN,KAAmBU,UAAvB,EAAmC;cAC5BV,QAAN,GAAiBU,WAAWZ,KAA5B;;;QAGGY,WAAWM,MAAX,IAAJ,iBAAiD;;;;QAG3C5O,UAAUsO,WAAWtO,OAA3B;QACCgT,SAAS1E,WAAW0E,MADrB;QAEC/K,WAAWuG,SAASF,WAAWF,OAAX,CAAmBnG,QAA5B,EAAsCyD,WAASzD,QAA/C,CAFZ;;SAKK,IAAM4H,YAAX,IAA2BmD,MAA3B,EAAmC;YAC5BJ,QAAQI,OAAOnD,YAAP,CAAd;YAEI+C,MAAMY,KAAN,IAAe,IAAnB,EAAyB;;gBAElBxQ,aAAayO,iBAAiBnD,WAAWtO,OAA5B,EAAqC6P,YAArC,CAAnB;gBAEIlQ,SAASqD,UAAT,CAAJ,EAA0B;sBACnBwQ,KAAN,GAAcV,UAAU9P,UAAV,CAAd;6BACa6M,YAAb,EAA2B+C,KAA3B,EAAkC3K,QAAlC,EAA4C,IAA5C;aAFD,MAGO,IAAI,CAAC3H,MAAMmJ,OAAN,CAAczG,UAAd,CAAL,EAAgC;wBAC9BvB,IAAR,aAAyBmR,KAAzB,EAAgC/C,YAAhC,EAA8C7M,UAA9C;;;YAGEmN,YAASC,KAAb,EAAoB;oBACXgD,GAAR,wBAAgCvD,YAAhC,YAAkDkG,KAAKC,SAAL,CAAepD,KAAf,CAAlD,EAA2E5S,OAA3E;;;eAGS4O,MAAX,KAAA;;;ACnaD;AACA;;;;AAeA,mBAA0BN;QACnB9M,WAAW8M,WAAWzE,KAAX,IAAoByE,WAAWF,OAAX,CAAmBvE,KAAxD;QAEIrI,QAAJ,EAAc;YACT;gBACG+M,WAAWD,WAAWC,QAA5B;qBAESvP,IAAT,CAAcuP,QAAd,EAAwBA,QAAxB,EAAkCD,UAAlC;SAHD,CAIE,OAAO9E,KAAP,EAAc;uBACJ;sBACJA,KAAN;aADD,EAEG,CAFH;;;;;;;;AAWH,qBAAA,CAAsB8E,UAAtB;QACO9M,WAAW8M,WAAW2H,QAAX,IAAuB3H,WAAWF,OAAX,CAAmB6H,QAA3D;QAEIzU,QAAJ,EAAc;YACT;gBACG+M,WAAWD,WAAWC,QAA5B;gBACCxL,kBAAkBuL,WAAWvL,eAD9B;gBAECqL,UAAUE,WAAWF,OAFtB;gBAGC8H,aAAa5H,WAAWsE,KAHzB;qBAKS5T,IAAT,CAAcuP,QAAd,EACCA,QADD,EAECxL,eAFD,EAGCG,KAAKS,GAAL,CAAS,CAAT,EAAY2K,WAAWS,SAAX,IAAwBT,WAAWrG,QAAX,IAAuB,IAAvB,GAA8BqG,WAAWrG,QAAzC,GAAoDmG,QAAQnG,QAAR,IAAoB,IAApB,GAA2BmG,QAAQnG,QAAnC,GAA8CyD,WAASzD,QAAnI,IAA+IkO,QAA3J,CAHD,EAICD,eAAenV,SAAf,GAA2BmV,UAA3B,GAAwC9D,OAAOrP,kBAAkB,GAAzB,CAJzC,EAKCuL,UALD;SAND,CAYE,OAAO9E,KAAP,EAAc;uBACJ;sBACJA,KAAN;aADD,EAEG,CAFH;;;;AAOH,uBAAA;;;;;;6BAC0B4M,UAAzB,8HAAqC;gBAA1B9H,UAA0B;;yBACvBA,UAAb;;;;;;;;;;;;;;;;;eAEU+H,KAAX;;;;;;8BACyBC,SAAzB,mIAAoC;gBAAzBhI,WAAyB;;yBACtBA,WAAb;;;;;;;;;;;;;;;;;cAES+H,KAAV;;;;;AAOD,IAAME,aAAa,OAAO,EAA1B;;;;;AAICD,YAAY,IAAIvK,GAAJ,EAJb;;;;;AAQCqK,aAAa,IAAIrK,GAAJ,EARd;;;;;AAYCyK,cAAe;QACRC,OAAO/W,OAAO8W,WAAP,IAAsB,EAAnC;QAEI,OAAOC,KAAKzV,GAAZ,KAAoB,UAAxB,EAAoC;YAC7B0V,YAAYD,KAAKE,MAAL,IAAeF,KAAKE,MAAL,CAAYC,eAA3B,GAA6CH,KAAKE,MAAL,CAAYC,eAAzD,GAA2E5V,KAA7F;aAEKA,GAAL,GAAW;mBACHA,QAAQ0V,SAAf;SADD;;WAKMD,IAAP;CAXa,EAZf;;;;;;;;;AAgCCI,WAAW,SAAXA,QAAW,CAACrV,QAAD;WACHsV,WAAWtV,QAAX,EAAqB0B,KAAKS,GAAL,CAAS,CAAT,EAAY4S,cAAcC,YAAYxV,GAAZ,KAAoBmV,QAAlC,CAAZ,CAArB,CAAP;CAjCF;;;;;AAsCCY,UAAUrX,OAAOsX,qBAAP,IAAgCH,QAtC3C;;;;AA2CA,IAAII,gBAAJ;;;;;;AAKCC,eALD;;;;;AAWA,IAAWf,WAAmB,CAAvB;;;;;;;;;;AAWP,iBAAA;;;QACKgB,iBAAJ;SAEKC,SAAL,GAAiB,UAACC,CAAD;gBACRA,EAAEjL,IAAV;iBACM,IAAL;oBACK,CAAC+K,QAAL,EAAe;+BACHG,YAAY;8BACjBC,WAAL,CAAiB,IAAjB;qBADU,EAER,OAAO,EAFC,CAAX;;;iBAMG,KAAL;oBACKJ,QAAJ,EAAc;kCACCA,QAAd;+BACW,CAAX;;;;sBAKII,WAAL,CAAiBF,EAAEjL,IAAnB;;;KAlBH;;AAwBD,IAAI;;aAEM,IAAIoL,MAAJ,CAAWC,IAAIC,eAAJ,CAAoB,IAAIC,IAAJ,CAAS,OAAKC,QAAL,SAAT,CAApB,CAAX,CAAT;;WAEOR,SAAP,GAAmB,UAACC,CAAD;YACdA,EAAEjL,IAAF,KAAW,IAAf,EAAqB;;SAArB,MAEO;;;KAHR;;QAQI,CAACS,MAAMgL,QAAP,IAAmB5K,SAAS6K,MAAT,KAAoB/W,SAA3C,EAAsD;iBAC5CgX,gBAAT,CAA0B,kBAA1B,EAA8C;mBACtCR,WAAP,CAAmB1K,MAAMmL,SAAN,IAAmB/K,SAAS6K,MAA/C;SADD;;CAbF,CAiBE,OAAOT,CAAP,EAAU;;;;;;;;;;;;;;AAeZ,cAAqBY;QAChBhB,OAAJ,EAAa;;;;;cAKH,IAAV;;;;;;;QAOIgB,cAAc,KAAlB,EAAyB;YAClBC,cAAc1B,YAAYxV,GAAZ,EAApB;YACCmX,YAAYhC,WAAW+B,cAAc/B,QAAzB,GAAoCI,UADjD;YAEC6B,eAAe1M,WAASjB,KAFzB;YAGC4N,gBAAgB3M,WAAS1B,MAH1B;YAICsO,kBAAkB5M,WAASzD,QAJ5B;YAKIqG,mBAAJ;YACCiK,iBADD;YAGIJ,aAAazM,WAAStB,YAAtB,IAAsC,CAAC+L,QAA3C,EAAqD;uBACzC+B,WAAX;;;;;mBAOOrL,MAAMe,QAAb,EAAuB;+BACPf,MAAMe,QAArB;;;iBAGIU,aAAazB,MAAMc,KAAxB,EAA+BW,cAAcA,eAAezB,MAAMe,QAAlE,EAA4EU,aAAaA,WAAWZ,KAApG,EAA2G;oBACpG1N,UAAUsO,WAAWtO,OAA3B;oBACCoM,OAAOyB,KAAK7N,OAAL,CADR;;;;oBAMI,CAACA,QAAQqN,UAAT,IAAuB,CAACjB,IAA5B,EAAkC;;sCAEfkC,UAAlB;;;;oBAIKF,UAAUE,WAAWF,OAA3B;oBACCoK,QAAQlK,WAAWM,MADpB;oBAEIG,YAAYT,WAAWS,SAA3B;;;;;oBAMI,CAACA,SAAL,EAAgB;wBACTxE,QAAQ+D,WAAW/D,KAAX,IAAoB,IAApB,GAA2B+D,WAAW/D,KAAtC,GAA8C6D,QAAQ7D,KAApE;gCAEY2N,cAAcC,SAA1B;wBACI5N,UAAU,KAAd,EAAqB;oCACRrH,KAAKS,GAAL,CAASoL,SAAT,EAAoB3C,KAAK0C,cAAL,CAAoBvE,KAApB,KAA8B,CAAlD,CAAZ;;+BAEUwE,SAAX,GAAuBA,SAAvB;;;;oBAIGyJ,UAAJ,eAAmC;;;;mCAGvBzJ,SAAX,IAAwBoJ,SAAxB;;;;;oBAKG,EAAEK,SAAF,aAAJ,EAAqC;;+BACzB5J,MAAX,KAAA,aADoC;4BAE5B6J,MAAR;;;;;iBAKGnK,aAAazB,MAAMc,KAAxB,EAA+BW,cAAcA,eAAezB,MAAMe,QAAlE,EAA4EU,aAAaiK,QAAzF,EAAmG;oBAC5FC,SAAQlK,WAAWM,MAAzB;2BAEWN,WAAWZ,KAAtB;oBACI,EAAE8K,UAAF,iBAAoCA,WAApC,eAAoE;;;;oBAGlEpK,WAAUE,WAAWF,OAA3B;oBAEKoK,WAAD,eAAiCpK,SAAQqK,MAAR,GAAiBrK,SAAQc,MAA9D,EAAsE;;+BAC1DH,SAAX,IAAwBoJ,SAAxB;;;oBAGK1N,QAAQ6D,WAAW7D,KAAX,IAAoB,IAApB,GAA2B6D,WAAW7D,KAAtC,GAA8C2D,SAAQ3D,KAAR,IAAiB,IAAjB,GAAwB2D,SAAQ3D,KAAhC,GAAwC2N,YAApG;oBACIrJ,aAAYT,WAAWS,SAA3B;;oBAGI,EAAEyJ,UAAF,eAAJ,EAAuC;;wBAChCzO,QAAQuE,WAAWvE,KAAX,IAAoB,IAApB,GAA2BuE,WAAWvE,KAAtC,GAA8CqE,SAAQrE,KAApE;;;;wBAKIA,KAAJ,EAAW;4BACNgF,aAAahF,QAAQU,KAArB,GAA8ByN,WAAlC,EAA+C;;;mCAGpCnJ,SAAX,GAAuBA,cAAahF,SAASA,QAAQ,CAAR,GAAYU,KAAZ,GAAoB,CAA7B,CAApC;;+BAEUmE,MAAX,KAAA,eAZsC;;;;wBAgBlCR,SAAQsK,QAAR,OAAuB,CAA3B,EAA8B;iCACrBC,MAAR,GAAiBrK,UAAjB;4BACIF,SAAQvE,KAAZ,EAAmB;;sCAERyE,UAAV;;qCAEQzE,KAAR,GAAgB9I,SAAhB;;;;oBAIC0J,UAAU,CAAd,EAAiB;;;+BAGLsE,SAAX,GAAuBA,cAAa7L,KAAKQ,GAAL,CAASyU,SAAT,EAAoBD,cAAcnJ,UAAlC,KAAgD,IAAItE,KAApD,CAApC;;oBAEKmO,eAAetK,WAAWtE,MAAX,IAAqB,IAArB,GAA4BsE,WAAWtE,MAAvC,GAAgDoE,SAAQpE,MAAR,IAAkB,IAAlB,GAAyBoE,SAAQpE,MAAjC,GAA0CqO,aAA/G;oBACCQ,uBAAuBvK,WAAWU,YAAX,GAA0BkJ,cAAcnJ,UADhE;oBAEC9G,WAAWqG,WAAWrG,QAAX,IAAuB,IAAvB,GAA8BqG,WAAWrG,QAAzC,GAAoDmG,SAAQnG,QAAR,IAAoB,IAApB,GAA2BmG,SAAQnG,QAAnC,GAA8CqQ,eAF9G;oBAGCvV,kBAAkBuL,WAAWvL,eAAX,GAA6BoN,YAAS2I,IAAT,GAAgB,CAAhB,GAAoB5V,KAAKQ,GAAL,CAASmV,uBAAuB5Q,QAAhC,EAA0C,CAA1C,CAHpE;oBAIC+K,SAAS1E,WAAW0E,MAJrB;oBAKC+F,UAAUP,WALX,eAhDkG;oBAuD9FlK,WAAW2H,QAAX,IAAwB7H,SAAQuK,MAAR,KAAmBrK,UAAnB,IAAiCF,SAAQ6H,QAArE,EAAgF;+BACpE7V,GAAX,CAAekO,UAAf;;oBAEGvL,oBAAoB,CAAxB,EAA2B;8BAChB3C,GAAV,CAAckO,UAAd;;;qBAGI,IAAMxO,QAAX,IAAuBkT,MAAvB,EAA+B;;wBAExBJ,QAAQI,OAAOlT,QAAP,CAAd;wBACCqU,WAAWvB,MAAMuB,QADlB;wBAECC,UAAUD,SAASC,OAFpB;wBAGI4E,eAAe,EAAnB;wBACCnU,IAAI,CADL;wBAGIuP,OAAJ,EAAa;4BACN6E,iBAAiB,CAACrG,MAAM5I,MAAN,IAAgB4O,YAAjB,EAA+B7V,eAA/B,EAAgD,CAAhD,EAAmD,CAAnD,EAAsDjD,QAAtD,CAAvB;4BACIoZ,OAAO,CAAX;6BAEK,IAAIC,IAAI,CAAb,EAAgBA,IAAIhF,SAAS5U,MAAT,GAAkB,CAAtC,EAAyC4Z,GAAzC,EAA8C;gCACzChF,SAASgF,CAAT,EAAYrD,OAAZ,GAAsBmD,cAA1B,EAA0C;uCAClCE,CAAP;;;4BAGIC,YAAuBjF,SAAS+E,IAAT,CAA7B;4BACCG,UAAqBlF,SAAS+E,OAAO,CAAhB,KAAsBE,SAD5C;4BAECE,eAAe,CAACvW,kBAAkBqW,UAAUtD,OAA7B,KAAyCuD,QAAQvD,OAAR,GAAkBsD,UAAUtD,OAArE,CAFhB;4BAGC9L,SAASqP,QAAQrP,MAAR,IAAkB1G,YAH5B;+BAKOuB,IAAIuP,QAAQ7U,MAAnB,EAA2BsF,GAA3B,EAAgC;gCACzB7B,aAAaoW,UAAUvU,CAAV,CAAnB;gCAEI7B,cAAc,IAAlB,EAAwB;gDACPoR,QAAQvP,CAAR,CAAhB;6BADD,MAEO;oCACA5B,WAAWoW,QAAQxU,CAAR,CAAjB;oCAEI7B,eAAeC,QAAnB,EAA6B;oDACZD,UAAhB;iCADD,MAEO;;wCAEAuW,SAASvP,OAAO+O,UAAU,IAAIO,YAAd,GAA6BA,YAApC,EAAkDtW,UAAlD,EAAwEC,QAAxE,EAA4FnD,QAA5F,CAAf;oDAEgBsU,QAAQvP,CAAR,MAAe,IAAf,GAAsB3B,KAAK+F,KAAL,CAAWsQ,MAAX,CAAtB,GAA2CA,MAA3D;;;;4BAICzZ,aAAa,OAAjB,EAA0B;gCACrBiD,oBAAoB,CAApB,IAAyBiW,aAAaQ,UAAb,CAAwB,WAAxB,CAA7B,EAAmE;+CACnDR,aAAa5X,OAAb,CAAqB,iCAArB,EAAwD,IAAxD,CAAf;;;6CAGgBkN,WAAWtO,OAA5B,EAAqCF,QAArC,EAA+CkZ,YAA/C,EAA6DpG,MAAM5J,EAAnE;yBALD,MAMO;;;uCAGK4J,KAAX,GAAmBoG,YAAnB;;qBAzCF,MA2CO;gCACEvX,IAAR,iCAA6C3B,QAA7C,EAAuDiW,KAAKC,SAAL,CAAepD,MAAM9S,QAAN,CAAf,CAAvD;+BACOkT,OAAOlT,QAAP,CAAP;;;;gBAICsW,WAAWqD,IAAX,IAAmBnD,UAAUmD,IAAjC,EAAuC;oBAClC,CAACxM,SAAS6K,MAAd,EAAsB;;iBAAtB,MAEO,IAAIZ,MAAJ,EAAY;2BACXK,WAAP,CAAmB,EAAnB;iBADM,MAEA;+BACKmC,cAAX,EAA2B,CAA3B;;;;;QAKA7M,MAAMc,KAAV,EAAiB;cACVqK,SAAN,GAAkB,IAAlB;YACI,CAAC/K,SAAS6K,MAAd,EAAsB;oBACb6B,IAAR;SADD,MAEO,IAAI,CAACzC,MAAL,EAAa;qBACVyC,IAAT;SADM,MAEA,IAAI1B,cAAc,KAAlB,EAAyB;;mBAExBV,WAAP,CAAmB,IAAnB;;KARF,MAUO;cACAS,SAAN,GAAkB,KAAlB;mBACW,CAAX;YACI/K,SAAS6K,MAAT,IAAmBZ,MAAvB,EAA+B;;mBAEvBK,WAAP,CAAmB,KAAnB;;;cAGQ,KAAV;;;AC5aD;AACA;;;;AAeA,uCAAA,CAAwCjK,SAAxC,EAAkES,SAAlE,EAA6F6L,YAA7F;mBACgBtM,SAAf;QACIS,cAAchN,SAAd,IAA2BgN,cAAcS,SAASlB,UAAU/C,KAAnB,EAA0B+C,UAAUc,OAAV,CAAkB7D,KAA5C,EAAmDqP,YAAnD,CAA7C,EAA+G;YAC1G,EAAEtM,UAAUsB,MAAV,IAAF,eAAJ,EAAkD;;;;gBAG3CR,UAAUd,UAAUc,OAA1B;;;;gBAKIA,QAAQsK,QAAR,OAAuB,CAA3B,EAA8B;wBACrBC,MAAR,GAAiBrL,SAAjB;oBACIc,QAAQvE,KAAZ,EAAmB;;8BAERyD,SAAV;;4BAEQzD,KAAR,GAAgB9I,SAAhB;;;sBAGQ6N,MAAV,KAAA,eAjBiD;;;aAoB7C,IAAM9O,QAAX,IAAuBwN,UAAU0F,MAAjC,EAAyC;gBAClCJ,QAAQtF,UAAU0F,MAAV,CAAiBlT,QAAjB,CAAd;gBACCqU,WAAWvB,MAAMuB,QADlB;gBAECC,UAAUD,SAASC,OAFpB;gBAGI4E,eAAe,EAAnB;gBACCnU,IAAI,CADL;gBAGIuP,OAAJ,EAAa;oBACNyF,YAAY1F,SAASA,SAAS5U,MAAT,GAAkB,CAA3B,CAAlB;uBAEOsF,IAAIuP,QAAQ7U,MAAnB,EAA2BsF,GAA3B,EAAgC;wBACzB5B,WAAW4W,UAAUhV,CAAV,CAAjB;oCAEgB5B,YAAY,IAAZ,GAAmBmR,QAAQvP,CAAR,CAAnB,GAAgC5B,QAAhD;;;6BAGeqK,UAAUtN,OAA3B,EAAoCF,QAApC,EAA8CkZ,YAA9C,EAA4DpG,MAAM5J,EAAlE;;qBAEYsE,SAAb;;;;;;;;;;;;;;;;;AAkBF,eAAA,CAAgB1M,IAAhB,EAA6B2N,QAA7B,EAAuDuL,cAAvD;QACO/L,YAA4B1C,cAAczK,KAAK,CAAL,CAAd,EAAuB,IAAvB,CAAlC;QACCgZ,eAA+BlO,WAASnB,KADzC;QAECwP,YAAYnZ,KAAKmN,cAAchN,SAAd,GAA0B,CAA1B,GAA8B,CAAnC,MAA0C,IAFvD;QAIIiZ,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAApD,EAAgE;;;;;;iCACvC1L,SAAS9O,QAAT,CAAkBwa,UAA1C,8HAAsD;oBAA3C3M,SAA2C;;+CACtBA,SAA/B,EAA0CS,SAA1C,EAAqD6L,YAArD;;;;;;;;;;;;;;;;KAFF,MAIO;eACC/M,MAAMe,QAAb,EAAuB;2BACPf,MAAMe,QAArB;;aAEI,IAAIU,aAAazB,MAAMc,KAAvB,EAA8B4K,QAAnC,EAA4DjK,eAAeyL,aAAazL,eAAezB,MAAMe,QAAjD,CAA5D,EAAwHU,aAAaiK,YAAY1L,MAAMe,QAAvJ,EAAiK;uBACrJU,WAAWZ,KAAtB;gBACI,CAACa,QAAD,IAAaA,SAASqB,QAAT,CAAkBtB,WAAWtO,OAA7B,CAAjB,EAAwD;+CACxBsO,UAA/B,EAA2CP,SAA3C,EAAsD6L,YAAtD;;;;QAICE,cAAJ,EAAoB;YACfE,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAAhD,IAA8D1L,SAAS2L,IAA3E,EAAiF;qBACvEA,IAAT,CAAcJ,eAAe1K,SAA7B;SADD,MAEO;2BACSA,SAAf,CAAyBb,QAAzB;;;;AAKH7M,eAAe,CAAC,QAAD,EAAWyY,MAAX,CAAf,EAAmC,IAAnC;;AC9FA;;;AAGA,IAAMC,iBAA0C;iBAAA;MAE/CC,UAF+C;MAG/CC,YAH+C;MAI/C3L,YAJ+C;MAK/C4L,YAL+C;MAM/CC,UAN+C;MAO/CC,aAP+C;CAAhD;;;;;;;;AAiBA,eAAA,CAAgB7Z,IAAhB,EAA8B2N,QAA9B,EAAyDuL,cAAzD,EAA2FY,MAA3F;QACOC,MAAM/Z,KAAK,CAAL,CAAZ;QACC2J,QAAQmQ,OAAOrL,OAAP,CAAe,GAAf,KAAuB,CAAvB,GAA2BqL,OAAOtZ,OAAP,CAAe,OAAf,EAAwB,EAAxB,CAA3B,GAAyDL,SADlE;QAECgN,YAAYxD,UAAU,OAAV,GAAoB,KAApB,GAA4Bc,cAAcd,KAAd,EAAqB,IAArB,CAFzC;QAGI0P,mBAAJ;QACCxZ,QAAQG,KAAK,CAAL,CADT;QAGI,CAAC+Z,GAAL,EAAU;gBACDlZ,IAAR;eAEO,IAAP;;;;QAIGuY,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAApD,EAAgE;qBAClD1L,SAAS9O,QAAT,CAAkBwa,UAA/B;KADD,MAEO;qBACO,EAAb;aAEK,IAAI3L,aAAazB,MAAMc,KAA5B,EAAmCW,UAAnC,EAA+CA,aAAaA,WAAWZ,KAAvE,EAA8E;gBACzEa,SAASc,OAAT,CAAiBf,WAAWtO,OAA5B,KAAwC,CAAxC,IAA6CwO,SAASF,WAAW/D,KAApB,EAA2B+D,WAAWF,OAAX,CAAmB7D,KAA9C,MAAyDwD,SAA1G,EAAqH;2BACzGnF,IAAX,CAAgB0F,UAAhB;;;;;;YAMEC,SAAShP,MAAT,GAAkB,CAAlB,IAAuB0a,WAAW1a,MAAX,GAAoB,CAA/C,EAAkD;gBAC7CsF,IAAI,CAAR;gBACCuJ,UAAU6L,WAAW,CAAX,EAAc7L,OADzB;mBAGOvJ,IAAIoV,WAAW1a,MAAtB,EAA8B;oBACzB0a,WAAWpV,GAAX,EAAgBuJ,OAAhB,KAA4BA,OAAhC,EAAyC;8BAC9B,IAAV;;;;;gBAKEA,OAAJ,EAAa;6BACC,CAAC6L,WAAW,CAAX,CAAD,CAAb;;;;;QAKCxZ,UAAUM,SAAd,EAAyB;YAClBwY,SAAS,EAAf;YACCqB,OAAOR,eAAeO,GAAf,CADR;;;;;;iCAGwBV,UAAxB,8HAAoC;oBAAzB3M,SAAyB;;oBAC/BsN,SAAS7Z,SAAb,EAAwB;;2BAEhB6H,IAAP,CAAY4F,SAASlB,UAAUqN,GAAV,CAAT,EAAyBrN,UAAUc,OAAV,CAAkBuM,GAAlB,CAAzB,CAAZ;iBAFD,MAGO;;2BAEC/R,IAAP,CAAY,CAAC0E,UAAUsB,MAAV,GAAmBgM,IAApB,MAA8B,CAA1C,EAFM;;;;;;;;;;;;;;;;;;YAKJrM,SAAShP,MAAT,KAAoB,CAApB,IAAyB0a,WAAW1a,MAAX,KAAsB,CAAnD,EAAsD;;;mBAG9Cga,OAAO,CAAP,CAAP;;eAGMA,MAAP;;;QAGGsB,0BAAJ;YAEQF,GAAR;aACM,OAAL;oBACS/P,cAAcnK,KAAd,CAAR;;aAEI,OAAL;oBACSoK,cAAcpK,KAAd,CAAR;;aAEI,UAAL;oBACSqK,iBAAiBrK,KAAjB,CAAR;;aAEI,OAAL;oBACSsK,cAActK,KAAd,CAAR;;aAEI,UAAL;oBACSuK,iBAAiBvK,KAAjB,CAAR;;aAEI,UAAL;oBACSwK,iBAAiBxK,KAAjB,CAAR;;aAEI,MAAL;oBACSyK,aAAazK,KAAb,CAAR;;aAEI,iBAAL;gCACqB,IAApB;oBACQ0H,WAAW1H,KAAX,CAAR;;aAEI,QAAL;aACK,aAAL;oBACS6K,eAAe7K,KAAf,CAAR;;;gBAGIka,IAAI,CAAJ,MAAW,GAAf,EAAoB;oBACblX,MAAM0E,WAAW1H,KAAX,CAAZ;oBAEIA,UAAU2R,OAAO3O,GAAP,CAAd,EAA2B;4BAClBA,GAAR;;;;;aAKE,OAAL;aACK,SAAL;aACK,oBAAL;aACK,QAAL;aACK,SAAL;oBACShC,IAAR,+CAA2DkZ,GAA3D;;;QAIEla,UAAUM,SAAV,IAAuBN,UAAUA,KAArC,EAA4C;gBACnCgB,IAAR,iDAA2DkZ,GAA3D,SAAkEla,KAAlE,UAA4EG,KAAK,CAAL,CAA5E;eAEO,IAAP;;;;;;;8BAEuBqZ,UAAxB,mIAAoC;gBAAzB3M,UAAyB;;gBAC/BuN,iBAAJ,EAAuB;2BACZ9L,SAAV,GAAsBoH,WAAY3H,SAASlB,WAAUrF,QAAnB,EAA6BqF,WAAUc,OAAV,CAAkBnG,QAA/C,EAAyDyD,WAASzD,QAAlE,IAA8ExH,KAAhH;aADD,MAEO;2BACIka,GAAV,IAAiBla,KAAjB;;;;;;;;;;;;;;;;;;QAGEqZ,cAAJ,EAAoB;YACfE,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAAhD,IAA8D1L,SAAS2L,IAA3E,EAAiF;qBACvEA,IAAT,CAAcJ,eAAe1K,SAA7B;SADD,MAEO;2BACSA,SAAf,CAAyBb,QAAzB;;;;AAKH7M,eAAe,CAAC,QAAD,EAAWoZ,MAAX,CAAf,EAAmC,IAAnC;;ACxKA;AACA;;;AAUA,uBAAA,CAAwBxN,SAAxB,EAAkDS,SAAlD,EAA6E6L,YAA7E,EAA2GW,QAA3G;QACKxM,cAAchN,SAAd,IAA2BgN,cAAcS,SAASlB,UAAU/C,KAAnB,EAA0B+C,UAAUc,OAAV,CAAkB7D,KAA5C,EAAmDqP,YAAnD,CAA7C,EAA+G;YAC1GW,QAAJ,EAAc;sBACH3L,MAAV,MAAA,cADa;SAAd,MAEO;sBACIA,MAAV,IAAoB,GAApB,cADM;;;;;;;;;AAWT,oBAAA,CAAqBhO,IAArB,EAAmC2N,QAAnC,EAA8DuL,cAA9D,EAAgGY,MAAhG;QACOH,WAAWG,OAAOrL,OAAP,CAAe,OAAf,MAA4B,CAA7C;QACC9E,QAAQmQ,OAAOrL,OAAP,CAAe,GAAf,KAAuB,CAAvB,GAA2BqL,OAAOtZ,OAAP,CAAe,OAAf,EAAwB,EAAxB,CAA3B,GAAyDL,SADlE;QAECgN,YAAYxD,UAAU,OAAV,GAAoB,KAApB,GAA4Bc,cAAczK,KAAK,CAAL,CAAd,CAFzC;QAGCgZ,eAAelO,WAASnB,KAHzB;QAKIyP,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAApD,EAAgE;;;;;;iCACvC1L,SAAS9O,QAAT,CAAkBwa,UAA1C,8HAAsD;oBAA3C3M,SAA2C;;+BACtCA,SAAf,EAA0BS,SAA1B,EAAqC6L,YAArC,EAAmDW,QAAnD;;;;;;;;;;;;;;;;KAFF,MAIO;YACFjM,aAA4BzB,MAAMc,KAAtC;eAEOW,UAAP,EAAmB;gBACd,CAACC,QAAD,IAAaA,SAASqB,QAAT,CAAkBtB,WAAWtO,OAA7B,CAAjB,EAAwD;+BACxCsO,UAAf,EAA2BP,SAA3B,EAAsC6L,YAAtC,EAAoDW,QAApD;;yBAEYjM,WAAWZ,KAAxB;;;QAGEoM,cAAJ,EAAoB;YACfE,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAAhD,IAA8D1L,SAAS2L,IAA3E,EAAiF;qBACvEA,IAAT,CAAcJ,eAAe1K,SAA7B;SADD,MAEO;2BACSA,SAAf,CAAyBb,QAAzB;;;;AAKH7M,eAAe,CAAC,OAAD,EAAUqZ,WAAV,CAAf,EAAuC,IAAvC;AACArZ,eAAe,CAAC,QAAD,EAAWqZ,WAAX,CAAf,EAAwC,IAAxC;;ACxDA;AACA;;;;;;;;;;;;;;AAoBA,wBAA+Bna,MAAc2N,UAA2BuL,gBAAkCY;QACnG5a,WAAWc,KAAK,CAAL,CAAjB;QACCH,QAAQG,KAAK,CAAL,CADT;QAGI,CAACd,QAAL,EAAe;gBACN2B,IAAR;eAEO,IAAP;;;QAGGhB,UAAUM,SAAV,IAAuB,CAACia,cAAclb,QAAd,CAA5B,EAAqD;YAChDQ,MAAMmJ,OAAN,CAAc3J,QAAd,CAAJ,EAA6B;gBACxByO,SAAShP,MAAT,KAAoB,CAAxB,EAA2B;oBACpBga,SAAS,EAAf;;;;;;yCAEmBzZ,QAAnB,8HAA6B;4BAAlBmb,IAAkB;;+BACrBA,IAAP,IAAenI,UAAUrB,iBAAiBlD,SAAS,CAAT,CAAjB,EAA8B0M,IAA9B,CAAV,CAAf;;;;;;;;;;;;;;;;;uBAGM1B,MAAP;aAPD,MAQO;oBACAA,UAAS,EAAf;;;;;;0CAEsBhL,QAAtB,mIAAgC;4BAArBvO,OAAqB;;4BACzBkb,MAAM,EAAZ;;;;;;kDAEmBpb,QAAnB,mIAA6B;oCAAlBmb,KAAkB;;oCACxBA,KAAJ,IAAYnI,UAAUrB,iBAAiBzR,OAAjB,EAA0Bib,KAA1B,CAAV,CAAZ;;;;;;;;;;;;;;;;;gCAGMrS,IAAP,CAAYsS,GAAZ;;;;;;;;;;;;;;;;;uBAGM3B,OAAP;;SAtBF,MAwBO;;;gBAGFhL,SAAShP,MAAT,KAAoB,CAAxB,EAA2B;uBACnBuT,UAAUrB,iBAAiBlD,SAAS,CAAT,CAAjB,EAA8BzO,QAA9B,CAAV,CAAP;;gBAEKyZ,WAAS,EAAf;;;;;;sCAEsBhL,QAAtB,mIAAgC;wBAArBvO,QAAqB;;6BACxB4I,IAAP,CAAYkK,UAAUrB,iBAAiBzR,QAAjB,EAA0BF,QAA1B,CAAV,CAAZ;;;;;;;;;;;;;;;;;mBAGMyZ,QAAP;;;;QAII/P,QAAkB,EAAxB;QAEIwR,cAAclb,QAAd,CAAJ,EAA6B;aACvB,IAAM+P,YAAX,IAA2B/P,QAA3B,EAAqC;gBAChCA,SAASV,cAAT,CAAwByQ,YAAxB,CAAJ,EAA2C;;;;;;0CACpBtB,QAAtB,mIAAgC;4BAArBvO,SAAqB;;4BACzBgQ,gBAAgBlQ,SAAS+P,YAAT,CAAtB;4BAEIlQ,SAASqQ,aAAT,KAA2B1Q,SAAS0Q,aAAT,CAA/B,EAAwD;6CACtChQ,SAAjB,EAA0B6P,YAA1B,EAAwC/P,SAAS+P,YAAT,CAAxC;yBADD,MAEO;kCACAjH,IAAN,8BAAqCiH,YAArC,uCAAiFG,aAAjF,yCAAiFA,aAAjF;oCACQvO,IAAR,0CAAmDoO,YAAnD,6BAAwFG,aAAxF;;;;;;;;;;;;;;;;;;;KAVL,MAeO,IAAIrQ,SAASc,KAAT,KAAmBnB,SAASmB,KAAT,CAAvB,EAAwC;;;;;;kCACxB8N,QAAtB,mIAAgC;oBAArBvO,SAAqB;;iCACdA,SAAjB,EAA0BF,QAA1B,EAAoCsS,OAAO3R,KAAP,CAApC;;;;;;;;;;;;;;;;KAFK,MAIA;cACAmI,IAAN,8BAAqC9I,QAArC,uCAA6EW,KAA7E,yCAA6EA,KAA7E;gBACQgB,IAAR,0CAAmD3B,QAAnD,6BAAoFW,KAApF;;QAEGqZ,cAAJ,EAAoB;YACftQ,MAAMjK,MAAV,EAAkB;2BACF4b,SAAf,CAAyB3R,MAAM4R,IAAN,CAAW,IAAX,CAAzB;SADD,MAEO,IAAIpB,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAAhD,IAA8D1L,SAAS2L,IAA3E,EAAiF;qBAC9EA,IAAT,CAAcJ,eAAe1K,SAA7B;SADM,MAEA;2BACSA,SAAf,CAAyBb,QAAzB;;;;AAKH7M,eAAe,CAAC,UAAD,EAAa2Z,cAAb,CAAf,EAA6C,IAA7C;;AC5GA;AACA,eAEe,CAAC,SAAD,EAAY,UAACza,IAAD,EAAe2N,QAAf,EAA+DuL,cAA/D,EAAiGY,MAAjG;;cAEpB,IAAIY,WAAJ,CAAgB,2DAAhB,CAAN;CAFc,CAAf,EAGI,IAHJ;;ACHA;AACA;;;;AAaA,sCAAA,CAAuChO,SAAvC,EAAiES,SAAjE,EAA4F6L,YAA5F;mBACgBtM,SAAf;QACIS,cAAchN,SAAd,IAA2BgN,cAAcS,SAASlB,UAAU/C,KAAnB,EAA0B+C,UAAUc,OAAV,CAAkB7D,KAA5C,EAAmDqP,YAAnD,CAA7C,EAA+G;kBACpGhL,MAAV,KAAA,eAD8G;qBAEjGtB,SAAb;;;;;;;;;;;;;;;;;;;;;AAsBF,aAAA,CAAc1M,IAAd,EAA2B2N,QAA3B,EAAqDuL,cAArD,EAAuFY,MAAvF;QACO3M,YAA4B1C,cAAczK,KAAK,CAAL,CAAd,EAAuB,IAAvB,CAAlC;QACCgZ,eAA+BlO,WAASnB,KADzC;QAECwP,YAAYnZ,KAAKmN,cAAchN,SAAd,GAA0B,CAA1B,GAA8B,CAAnC,MAA0C,IAFvD;QAIIiZ,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAApD,EAAgE;;;;;;iCACvC1L,SAAS9O,QAAT,CAAkBwa,UAA1C,8HAAsD;oBAA3C3M,SAA2C;;8CACvBA,SAA9B,EAAyCS,SAAzC,EAAoD6L,YAApD;;;;;;;;;;;;;;;;KAFF,MAIO;eACC/M,MAAMe,QAAb,EAAuB;2BACPf,MAAMe,QAArB;;aAEI,IAAIU,aAAazB,MAAMc,KAAvB,EAA8B4K,QAAnC,EAA4DjK,eAAeyL,aAAazL,eAAezB,MAAMe,QAAjD,CAA5D,EAAwHU,aAAaiK,YAAY1L,MAAMe,QAAvJ,EAAiK;uBACrJU,WAAWZ,KAAtB;gBACI,CAACa,QAAD,IAAaA,SAASqB,QAAT,CAAkBtB,WAAWtO,OAA7B,CAAjB,EAAwD;8CACzBsO,UAA9B,EAA0CP,SAA1C,EAAqD6L,YAArD;;;;QAICE,cAAJ,EAAoB;YACfE,iBAAiBzL,QAAjB,KAA8BA,SAAS9O,QAAT,CAAkBwa,UAAhD,IAA8D1L,SAAS2L,IAA3E,EAAiF;qBACvEA,IAAT,CAAcJ,eAAe1K,SAA7B;SADD,MAEO;2BACSA,SAAf,CAAyBb,QAAzB;;;;AAKH7M,eAAe,CAAC,MAAD,EAAS6Z,IAAT,CAAf,EAA+B,IAA/B;;ACxEA;AACA,eAGe,CAAC,OAAD,EAAUF,cAAV,CAAf,EAA0C,IAA1C;;ACEA;AACA;;;AAgBA,oBAAA,CAAqBza,IAArB,EAAmC2N,QAAnC,EAA8DuL,cAA9D,EAAgGY,MAAhG;QACKc,4BAAJ;QAEI,CAACjN,QAAL,EAAe;YACV,CAAC3N,KAAKrB,MAAV,EAAkB;oBACT8Q,IAAR;mBAGO,IAAP;;mBAEU,CAACpD,SAASG,IAAV,CAAX;8BACsB,IAAtB;KARD,MASO,IAAImB,SAAShP,MAAT,KAAoB,CAAxB,EAA2B;;cAE3B,IAAIkc,KAAJ,CAAU,iDAAV,CAAN;;QAEK1Y,kBAA0BnC,KAAK,CAAL,CAAhC;QACC8a,gBAAgB;0BAAA;iBAENnN,SAAS,CAAT,CAFM;eAGR,KAHQ;iBAIN;sBACE;SALI;gBAOP;KARV;QAUCgL,SAAuC,EAVxC;QAWIxG,aAAiCnS,KAAK,CAAL,CAArC;QACC+a,qBADD;QAECC,sBAFD;QAGC5R,SAA6BpJ,KAAK,CAAL,CAH9B;QAICkN,QAAQ,CAJT;QAMInO,SAASiB,KAAK,CAAL,CAAT,CAAJ,EAAuB;YAClByN,mBAAmBA,gBAAgBzN,KAAK,CAAL,CAAhB,CAAvB,EAAiD;4BAChCyN,gBAAgBzN,KAAK,CAAL,CAAhB,CAAhB;yBACa,EAAb;qBACSA,KAAK,CAAL,CAAT;SAHD,MAIO;2BACS,IAAf;4CAEEA,KAAK,CAAL,CADF,EACYA,KAAK,CAAL,CADZ;qBAGSA,KAAK,CAAL,CAAT;;KAVF,MAYO,IAAIN,MAAMmJ,OAAN,CAAc7I,KAAK,CAAL,CAAd,CAAJ,EAA4B;uBACnB,IAAf;qBACa;mBACLA,KAAK,CAAL;SADR;iBAGSA,KAAK,CAAL,CAAT;;QAEG,CAACtB,SAASyD,eAAT,CAAD,IAA8BA,kBAAkB,CAAhD,IAAqDA,kBAAkB,CAA3E,EAA8E;cACvE,IAAI0Y,KAAJ,CAAU,kDAAV,CAAN;;QAEG,CAACT,cAAcjI,UAAd,CAAL,EAAgC;cACzB,IAAI0I,KAAJ,CAAU,+CAAV,CAAN;;QAEGD,mBAAJ,EAAyB;aACnB,IAAM1b,QAAX,IAAuBiT,UAAvB,EAAmC;gBAC9BA,WAAW3T,cAAX,CAA0BU,QAA1B,MAAwC,CAACQ,MAAMmJ,OAAN,CAAcsJ,WAAWjT,QAAX,CAAd,CAAD,IAAwCiT,WAAWjT,QAAX,EAAqBP,MAArB,GAA8B,CAA9G,CAAJ,EAAsH;sBAC/G,IAAIkc,KAAJ,CAAU,2EAA2E3b,QAArF,CAAN;;;;QAIG8Y,eAAejO,eAAe6D,SAASxE,MAAT,EAAiB0B,WAAS1B,MAA1B,CAAf,EAAkD/H,gBAAlD,CAArB;QAEI2Z,aAAJ,EAAmB;uBACHF,aAAf,EAA8BE,aAA9B;KADD,MAEO;yBACWF,aAAjB,EAAiD3I,UAAjD;;;SAGI,IAAMjT,SAAX,IAAuB4b,cAAc1I,MAArC,EAA6C;;YAEtC6I,gBAAgBH,cAAc1I,MAAd,CAAqBlT,SAArB,CAAtB;YACCqU,WAAW0H,cAAc1H,QAD1B;YAECC,UAAUD,SAASC,OAFpB;YAGI4E,eAAe,EAAnB;YACCnU,IAAI,CADL;;YAIIuP,OAAJ,EAAa;gBACN6E,iBAAiB,CAAC4C,cAAc7R,MAAd,IAAwB4O,YAAzB,EAAuC7V,eAAvC,EAAwD,CAAxD,EAA2D,CAA3D,EAA8DjD,SAA9D,CAAvB;gBACIoZ,OAAO,CAAX;iBAEK,IAAIC,IAAI,CAAb,EAAgBA,IAAIhF,SAAS5U,MAAT,GAAkB,CAAtC,EAAyC4Z,GAAzC,EAA8C;oBACzChF,SAASgF,CAAT,EAAYrD,OAAZ,GAAsBmD,cAA1B,EAA0C;2BAClCE,CAAP;;;gBAGIC,YAAuBjF,SAAS+E,IAAT,CAA7B;gBACCG,UAAqBlF,SAAS+E,OAAO,CAAhB,KAAsBE,SAD5C;gBAECE,eAAe,CAACvW,kBAAkBqW,UAAUtD,OAA7B,KAAyCuD,QAAQvD,OAAR,GAAkBsD,UAAUtD,OAArE,CAFhB;gBAGCgG,cAAczC,QAAQrP,MAAR,IAAkB1G,YAHjC;mBAKOuB,IAAIuP,QAAQ7U,MAAnB,EAA2BsF,GAA3B,EAAgC;oBACzB7B,aAAaoW,UAAUvU,CAAV,CAAnB;oBAEI7B,cAAc,IAAlB,EAAwB;oCACPoR,QAAQvP,CAAR,CAAhB;iBADD,MAEO;wBACA5B,WAAWoW,QAAQxU,CAAR,CAAjB;wBAEI7B,eAAeC,QAAnB,EAA6B;wCACZD,UAAhB;qBADD,MAEO;;4BAEAvC,QAAQqb,YAAYxC,YAAZ,EAA0BtW,UAA1B,EAAgDC,QAAhD,EAAoEnD,SAApE,CAAd;wCAEgBsU,QAAQvP,CAAR,MAAe,IAAf,GAAsB3B,KAAK+F,KAAL,CAAWxI,KAAX,CAAtB,GAA0CA,KAA1D;;;;mBAIIX,SAAP,IAAmBkZ,YAAnB;;;QAIE2C,gBAAgB7N,UAAU,CAA9B,EAAiC;aAC3B,IAAMhO,UAAX,IAAuByZ,MAAvB,EAA+B;gBAC1BA,OAAOna,cAAP,CAAsBU,UAAtB,CAAJ,EAAqC;uBAC7ByZ,OAAOzZ,UAAP,CAAP;;;;WAKIyZ,MAAP;;AAGD7X,eAAe,CAAC,OAAD,EAAUqa,WAAV,CAAf,EAAuC,IAAvC;;AC1JA;AACA;;;AAKA,IAAMC,cAAc;eACR,QADQ;kBAEL,QAFK;UAGb,QAHa;gBAIP,QAJO;WAKZ,QALY;WAMZ,QANY;YAOX,QAPW;WAQZ,QARY;oBASH,QATG;UAUb,QAVa;gBAWP,QAXO;WAYZ,QAZY;eAaR,QAbQ;eAcR,QAdQ;gBAeP,QAfO;eAgBR,QAhBQ;WAiBZ,QAjBY;oBAkBH,QAlBG;cAmBT,QAnBS;aAoBV,QApBU;UAqBb,QArBa;cAsBT,QAtBS;cAuBT,QAvBS;mBAwBJ,QAxBI;cAyBT,QAzBS;cA0BT,QA1BS;eA2BR,QA3BQ;eA4BR,QA5BQ;iBA6BN,QA7BM;oBA8BH,QA9BG;gBA+BP,QA/BO;gBAgCP,QAhCO;aAiCV,QAjCU;gBAkCP,QAlCO;kBAmCL,QAnCK;mBAoCJ,QApCI;mBAqCJ,QArCI;mBAsCJ,QAtCI;mBAuCJ,QAvCI;gBAwCP,QAxCO;cAyCT,QAzCS;iBA0CN,QA1CM;aA2CV,QA3CU;aA4CV,QA5CU;gBA6CP,QA7CO;eA8CR,QA9CQ;iBA+CN,QA/CM;iBAgDN,QAhDM;aAiDV,QAjDU;eAkDR,QAlDQ;gBAmDP,QAnDO;UAoDb,QApDa;eAqDR,QArDQ;UAsDb,QAtDa;UAuDb,QAvDa;WAwDZ,QAxDY;iBAyDN,QAzDM;cA0DT,QA1DS;aA2DV,QA3DU;eA4DR,QA5DQ;YA6DX,QA7DW;WA8DZ,QA9DY;WA+DZ,QA/DY;cAgET,QAhES;mBAiEJ,QAjEI;eAkER,QAlEQ;kBAmEL,QAnEK;eAoER,QApEQ;gBAqEP,QArEO;eAsER,QAtEQ;0BAuEG,QAvEH;eAwER,QAxEQ;eAyER,QAzEQ;gBA0EP,QA1EO;eA2ER,QA3EQ;iBA4EN,QA5EM;mBA6EJ,QA7EI;kBA8EL,QA9EK;oBA+EH,QA/EG;oBAgFH,QAhFG;oBAiFH,QAjFG;iBAkFN,QAlFM;UAmFb,QAnFa;eAoFR,QApFQ;WAqFZ,QArFY;aAsFV,QAtFU;YAuFX,QAvFW;sBAwFD,QAxFC;gBAyFP,QAzFO;kBA0FL,QA1FK;kBA2FL,QA3FK;oBA4FH,QA5FG;qBA6FF,QA7FE;uBA8FA,QA9FA;qBA+FF,QA/FE;qBAgGF,QAhGE;kBAiGL,QAjGK;eAkGR,QAlGQ;eAmGR,QAnGQ;cAoGT,QApGS;iBAqGN,QArGM;UAsGb,QAtGa;aAuGV,QAvGU;WAwGZ,QAxGY;eAyGR,QAzGQ;YA0GX,QA1GW;eA2GR,QA3GQ;YA4GX,QA5GW;mBA6GJ,QA7GI;eA8GR,QA9GQ;mBA+GJ,QA/GI;mBAgHJ,QAhHI;gBAiHP,QAjHO;eAkHR,QAlHQ;UAmHb,QAnHa;UAoHb,QApHa;UAqHb,QArHa;gBAsHP,QAtHO;YAuHX,QAvHW;mBAwHJ,QAxHI;SAyHd,QAzHc;eA0HR,QA1HQ;eA2HR,QA3HQ;iBA4HN,QA5HM;YA6HX,QA7HW;gBA8HP,QA9HO;cA+HT,QA/HS;cAgIT,QAhIS;YAiIX,QAjIW;YAkIX,QAlIW;aAmIV,QAnIU;eAoIR,QApIQ;eAqIR,QArIQ;eAsIR,QAtIQ;UAuIb,QAvIa;iBAwIN,QAxIM;eAyIR,QAzIQ;SA0Id,QA1Ic;UA2Ib,QA3Ia;aA4IV,QA5IU;YA6IX,QA7IW;eA8IR,QA9IQ;YA+IX,QA/IW;WAgJZ,QAhJY;WAiJZ,QAjJY;gBAkJP,QAlJO;YAmJX,QAnJW;iBAoJN;CApJd;AAuJA,KAAK,IAAMxb,IAAX,IAAmBwb,WAAnB,EAAgC;QAC3BA,YAAY5c,cAAZ,CAA2BoB,IAA3B,CAAJ,EAAsC;YAC/Byb,QAAQD,YAAYxb,IAAZ,CAAd;mBAEWA,IAAX,IAAsB0C,KAAK2F,KAAL,CAAWoT,QAAQ,KAAnB,CAAtB,SAAmD/Y,KAAK2F,KAAL,CAAWoT,QAAQ,GAAR,GAAc,GAAzB,CAAnD,SAAqFA,QAAQ,GAA7F;;;;AC/JF;AACA,wBAE+Bzb,MAAc0b;mBAC7B,CAAC1b,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGMC,KAAKiZ,GAAL,CAASpZ,eAAT,EAA0B,CAA1B,KAAgC,CAACmZ,SAAS,CAAV,IAAenZ,eAAf,GAAiCmZ,MAAjE,KAA4EjZ,WAAWD,UAAvF,CAAP;KARc,CAAf;;AAYD,yBAAgCxC,MAAc0b;mBAC9B,CAAC1b,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGM,CAACC,KAAKiZ,GAAL,CAAS,EAAEpZ,eAAX,EAA4B,CAA5B,KAAkC,CAACmZ,SAAS,CAAV,IAAenZ,eAAf,GAAiCmZ,MAAnE,IAA6E,CAA9E,KAAoFjZ,WAAWD,UAA/F,CAAP;KARc,CAAf;;AAYD,2BAAkCxC,MAAc0b;cACrC,KAAV;mBACe,CAAC1b,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;2BAEkB,CAAnB;eAEO,CAACF,kBAAkB,CAAlB,GACJG,KAAKiZ,GAAL,CAASpZ,eAAT,EAA0B,CAA1B,KAAgC,CAACmZ,SAAS,CAAV,IAAenZ,eAAf,GAAiCmZ,MAAjE,CADI,GAEJhZ,KAAKiZ,GAAL,CAASpZ,kBAAkB,CAA3B,EAA8B,CAA9B,KAAoC,CAACmZ,SAAS,CAAV,KAAgBnZ,kBAAkB,CAAlC,IAAuCmZ,MAA3E,IAAqF,CAFlF,IAGH,GAHG,IAGIjZ,WAAWD,UAHf,CAAP;KATc,CAAf;;AAgBDoZ,eAAe,YAAf,EAA6B,GAA7B;AACAC,gBAAgB,aAAhB,EAA+B,GAA/B;AACAC,kBAAkB,eAAlB,EAAmC,GAAnC;;;ACjDA;AACA,6BAEA,CAA8BvZ,eAA9B;QACKA,kBAAkB,IAAI,IAA1B,EAAgC;eACvB,SAASA,eAAT,GAA2BA,eAAnC;;QAEGA,kBAAkB,IAAI,IAA1B,EAAgC;eACvB,UAAUA,mBAAmB,MAAM,IAAnC,IAA2CA,eAA3C,GAA6D,IAArE;;QAEGA,kBAAkB,MAAM,IAA5B,EAAkC;eACzB,UAAUA,mBAAmB,OAAO,IAApC,IAA4CA,eAA5C,GAA8D,MAAtE;;WAGO,UAAUA,mBAAmB,QAAQ,IAArC,IAA6CA,eAA7C,GAA+D,QAAvE;;AAGD,4BAAA,CAA6BA,eAA7B;WACQ,IAAIwZ,qBAAqB,IAAIxZ,eAAzB,CAAX;;AAGD,sBAA6BA,iBAAyBC,YAAoBC;QACrEF,oBAAoB,CAAxB,EAA2B;eACnBC,UAAP;;QAEGD,oBAAoB,CAAxB,EAA2B;eACnBE,QAAP;;WAGMuZ,oBAAoBzZ,eAApB,KAAwCE,WAAWD,UAAnD,CAAP;;AAGD,uBAA8BD,iBAAyBC,YAAoBC;QACtEF,oBAAoB,CAAxB,EAA2B;eACnBC,UAAP;;QAEGD,oBAAoB,CAAxB,EAA2B;eACnBE,QAAP;;WAGMsZ,qBAAqBxZ,eAArB,KAAyCE,WAAWD,UAApD,CAAP;;AAGD,yBAAgCD,iBAAyBC,YAAoBC;QACxEF,oBAAoB,CAAxB,EAA2B;eACnBC,UAAP;;QAEGD,oBAAoB,CAAxB,EAA2B;eACnBE,QAAP;;WAGM,CAACF,kBAAkB,GAAlB,GACLyZ,oBAAoBzZ,kBAAkB,CAAtC,IAA2C,GADtC,GAELwZ,qBAAqBxZ,kBAAkB,CAAlB,GAAsB,CAA3C,IAAgD,GAAhD,GAAsD,GAFlD,KAGFE,WAAWD,UAHT,CAAP;;AAMDF,eAAe,CAAC,cAAD,EAAiB2Z,YAAjB,CAAf;AACA3Z,eAAe,CAAC,eAAD,EAAkB4Z,aAAlB,CAAf;AACA5Z,eAAe,CAAC,iBAAD,EAAoB6Z,eAApB,CAAf;;AC3DA;AACA;AAGA,IAAMC,MAAM1Z,KAAKE,EAAL,GAAU,CAAtB;AAEA,2BAAkC5C,MAAcqc,WAAmBC;mBACnD,CAACtc,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGM,EAAE4Z,YAAY3Z,KAAKiZ,GAAL,CAAS,CAAT,EAAY,MAAMpZ,mBAAmB,CAAzB,CAAZ,CAAZ,GAAuDG,KAAK6Z,GAAL,CAAS,CAACha,kBAAmB+Z,SAASF,GAAT,GAAe1Z,KAAK8Z,IAAL,CAAU,IAAIH,SAAd,CAAnC,IAAgED,GAAhE,GAAsEE,MAA/E,CAAzD,KAAoJ7Z,WAAWD,UAA/J,CAAP;KARc,CAAf;;AAYD,4BAAmCxC,MAAcqc,WAAmBC;mBACpD,CAACtc,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;eAGM,CAAC4Z,YAAY3Z,KAAKiZ,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAMpZ,eAAlB,CAAZ,GAAiDG,KAAK6Z,GAAL,CAAS,CAACha,kBAAmB+Z,SAASF,GAAT,GAAe1Z,KAAK8Z,IAAL,CAAU,IAAIH,SAAd,CAAnC,IAAgED,GAAhE,GAAsEE,MAA/E,CAAjD,GAA0I,CAA3I,KAAiJ7Z,WAAWD,UAA5J,CAAP;KARc,CAAf;;AAYD,8BAAqCxC,MAAcqc,WAAmBC;mBACtD,CAACtc,IAAD,EAAO,UAACuC,eAAD,EAA0BC,UAA1B,EAA8CC,QAA9C;YACjBF,oBAAoB,CAAxB,EAA2B;mBACnBC,UAAP;;YAEGD,oBAAoB,CAAxB,EAA2B;mBACnBE,QAAP;;YAEKga,IAAIH,SAASF,GAAT,GAAe1Z,KAAK8Z,IAAL,CAAU,IAAIH,SAAd,CAAzB;0BAEkB9Z,kBAAkB,CAAlB,GAAsB,CAAxC;eAEO,CAACA,kBAAkB,CAAlB,GACL,CAAC,GAAD,IAAQ8Z,YAAY3Z,KAAKiZ,GAAL,CAAS,CAAT,EAAY,KAAKpZ,eAAjB,CAAZ,GAAgDG,KAAK6Z,GAAL,CAAS,CAACha,kBAAkBka,CAAnB,IAAwBL,GAAxB,GAA8BE,MAAvC,CAAxD,CADK,GAELD,YAAY3Z,KAAKiZ,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAMpZ,eAAlB,CAAZ,GAAiDG,KAAK6Z,GAAL,CAAS,CAACha,kBAAkBka,CAAnB,IAAwBL,GAAxB,GAA8BE,MAAvC,CAAjD,GAAkG,GAAlG,GAAwG,CAFpG,KAGF7Z,WAAWD,UAHT,CAAP;KAXc,CAAf;;AAkBDka,kBAAkB,eAAlB,EAAmC,CAAnC,EAAsC,GAAtC;AACAC,mBAAmB,gBAAnB,EAAqC,CAArC,EAAwC,GAAxC;AACAC,qBAAqB,kBAArB,EAAyC,CAAzC,EAA4C,MAAM,GAAlD;;;ACpDA;AACA;;;;AAMA,iBAAwBra,iBAAyBC,YAAiBC;SAC1DF,oBAAoB,CAApB,GACJC,UADI,GAEJC,QAFH;;;;;;AASD,gBAAuBF,iBAAyBC,YAAiBC;SACzDF,oBAAoB,CAApB,IAAyBA,oBAAoB,CAA7C,GACJC,UADI,GAEJC,QAFH;;;;;AAQD,eAAsBF,iBAAyBC,YAAiBC;SACxDF,oBAAoB,CAApB,GACJE,QADI,GAEJD,UAFH;;AAKDF,eAAe,CAAC,UAAD,EAAaua,OAAb,CAAf;AACAva,eAAe,CAAC,QAAD,EAAWwa,MAAX,CAAf;AACAxa,eAAe,CAAC,QAAD,EAAWya,KAAX,CAAf;;AClCA;AACA;;;AAOA,qBAAA,CAAsB/c,IAAtB,EAAgD+Q,SAAhD;WACS,UAACvR,OAAD,EAA4BgQ,aAA5B;YACHA,kBAAkBjP,SAAtB,EAAiC;mBACzBgR,iBAAiB/R,OAAjB,EAA0BQ,IAA1B,EAAgC+Q,SAAhC,IAA6C,IAApD;;yBAEgBvR,OAAjB,EAA0BQ,IAA1B,EAAiC2H,WAAW6H,aAAX,IAA4B+B,iBAAiB/R,OAAjB,EAA0BQ,IAA1B,EAAgC+Q,SAAhC,CAA7B,GAA2E,IAA3G;KAJD;;AAQDzB,sBAAsB,CAAC,SAAD,EAAY,YAAZ,EAA0B0N,aAAa,OAAb,EAAsB,IAAtB,CAA1B,CAAtB;AACA1N,sBAAsB,CAAC,SAAD,EAAY,aAAZ,EAA2B0N,aAAa,QAAb,EAAuB,IAAvB,CAA3B,CAAtB;AACA1N,sBAAsB,CAAC,SAAD,EAAY,YAAZ,EAA0B0N,aAAa,OAAb,EAAsB,KAAtB,CAA1B,CAAtB;AACA1N,sBAAsB,CAAC,SAAD,EAAY,aAAZ,EAA2B0N,aAAa,QAAb,EAAuB,KAAvB,CAA3B,CAAtB;;ACpBA;AACA;AAKA,IAAaC,WAAW,0JAAjB;IACNC,aAAa,SADP;IAENC,aAAa,SAFP;IAGNC,UAAU,YAHJ;IAINC,kBAAkB,YAJZ;AAYP,gBAAA,CAAiB7d,OAAjB,EAA4CgQ,aAA5C;QACOqC,QAAQrS,QAAQqS,KAAtB;QAEIrC,kBAAkBjP,SAAtB,EAAiC;eACzB+c,qBAAqB9d,OAArB,EAA8B,SAA9B,CAAP;;QAEGgQ,kBAAkB,MAAtB,EAA8B;YACvB+N,WAAW/d,WAAWA,QAAQ+d,QAApC;YACC3R,OAAOyB,KAAK7N,OAAL,CADR;YAGIyd,SAAS3Q,IAAT,CAAciR,QAAd,CAAJ,EAA6B;4BACZ,QAAhB;SADD,MAEO,IAAIL,WAAW5Q,IAAX,CAAgBiR,QAAhB,CAAJ,EAA+B;4BACrB,WAAhB;SADM,MAEA,IAAIJ,WAAW7Q,IAAX,CAAgBiR,QAAhB,CAAJ,EAA+B;4BACrB,WAAhB;SADM,MAEA,IAAIH,QAAQ9Q,IAAR,CAAaiR,QAAb,CAAJ,EAA4B;4BAClB,OAAhB;SADM,MAEA,IAAIF,gBAAgB/Q,IAAhB,CAAqBiR,QAArB,CAAJ,EAAoC;4BAC1B,iBAAhB;SADM,MAEA;;4BAEU,OAAhB;;;;aAIIjV,KAAL,CAAW,SAAX,IAAwBkH,aAAxB;;UAEKgO,OAAN,GAAgBhO,aAAhB;;AAGDF,sBAAsB,CAAC,SAAD,EAAY,SAAZ,EAAuBkO,OAAvB,CAAtB;;ACjDA;AACA,oBAQA,CAAqBhe,OAArB,EAAgDgQ,aAAhD;QACKA,iBAAiB,IAArB,EAA2B;eACnBhQ,QAAQie,WAAR,GAAsB,IAA7B;;;AASF,oBAAA,CAAqBje,OAArB,EAAgDgQ,aAAhD;QACKA,iBAAiB,IAArB,EAA2B;eACnBhQ,QAAQke,WAAR,GAAsB,IAA7B;;;AASF,qBAAA,CAAsBle,OAAtB,EAAiDgQ,aAAjD;QACKA,iBAAiB,IAArB,EAA2B;eACnBhQ,QAAQme,YAAR,GAAuB,IAA9B;;;AASF,qBAAA,CAAsBne,OAAtB,EAAiDgQ,aAAjD;QACKA,iBAAiB,IAArB,EAA2B;eACnBhQ,QAAQoe,YAAR,GAAuB,IAA9B;;;AASF,eAAA,CAAgBC,SAAhB,EAA+C9K,GAA/C;WACS,UAACvT,OAAD,EAA4BgQ,aAA5B;YACHA,iBAAiB,IAArB,EAA2B;;6BAEThQ,OAAjB,EAA0B,WAAWqe,SAArC,EAAgD,IAAhD,EAAsD,IAAtD;6BACiBre,OAAjB,EAA0B,WAAWqe,SAArC,EAAgD,IAAhD,EAAsD,IAAtD;mBAEOre,QAAQ,WAAWuT,GAAnB,IAA0B,IAAjC;;YAEK9S,QAAQ0H,WAAW6H,aAAX,CAAd;YACCN,OAAOM,cAAc5O,OAAd,CAAsBgR,OAAO3R,KAAP,CAAtB,EAAqC,EAArC,CADR;gBAGQiP,IAAR;iBACM,EAAL;iBACK,IAAL;wBACS,WAAW6D,GAAnB,IAA0B9S,KAA1B;;iBAGI,GAAL;oBACO6d,SAASnW,WAAWsJ,iBAAiBzR,OAAjB,EAA0B,WAAWqe,SAArC,CAAX,CAAf;oBACCE,cAAcpW,WAAWsJ,iBAAiBzR,OAAjB,EAA0B,WAAWqe,SAArC,CAAX,CADf;wBAGQ,WAAW9K,GAAnB,IAA0BrQ,KAAKS,GAAL,CAAS,CAAT,EAAY4a,cAAcD,MAA1B,IAAoC7d,KAApC,GAA4C,GAAtE;;;KArBH;;AA2BDqP,sBAAsB,CAAC,aAAD,EAAgB,QAAhB,EAA0B0O,OAAO,QAAP,EAAiB,KAAjB,CAA1B,EAAmD,KAAnD,CAAtB;AACA1O,sBAAsB,CAAC,aAAD,EAAgB,WAAhB,EAA6B0O,OAAO,QAAP,EAAiB,KAAjB,CAA7B,EAAsD,KAAtD,CAAtB;AACA1O,sBAAsB,CAAC,aAAD,EAAgB,YAAhB,EAA8B0O,OAAO,OAAP,EAAgB,MAAhB,CAA9B,EAAuD,KAAvD,CAAtB;AACA1O,sBAAsB,CAAC,aAAD,EAAgB,aAAhB,EAA+BoO,WAA/B,CAAtB;AACApO,sBAAsB,CAAC,aAAD,EAAgB,aAAhB,EAA+BmO,WAA/B,CAAtB;AACAnO,sBAAsB,CAAC,aAAD,EAAgB,cAAhB,EAAgCsO,YAAhC,CAAtB;AACAtO,sBAAsB,CAAC,aAAD,EAAgB,cAAhB,EAAgCqO,YAAhC,CAAtB;;ACnFA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA,IAAMM,UAAU,kjBAAhB;;;;;AAMA,uBAAA,CAAwB5O,YAAxB,EAA8C6O,UAA9C;WACS,UAAC1e,OAAD,EAA4BgQ,aAA5B;YACHA,kBAAkBjP,SAAtB,EAAiC;mBACzB+c,qBAAqB9d,OAArB,EAA8B6P,YAA9B,KAA+CiO,qBAAqB9d,OAArB,EAA8B0e,UAA9B,CAAtD;;gBAEOrM,KAAR,CAAcxC,YAAd,IAA8B7P,QAAQqS,KAAR,CAAcqM,UAAd,IAA4B1O,aAA1D;KAJD;;;;;AAWD,oBAAA,CAAqBH,YAArB;WACS,UAAC7P,OAAD,EAA4BgQ,aAA5B;YACHA,kBAAkBjP,SAAtB,EAAiC;mBACzB+c,qBAAqB9d,OAArB,EAA8B6P,YAA9B,CAAP;;gBAEOwC,KAAR,CAAcxC,YAAd,IAA8BG,aAA9B;KAJD;;;;;AAWD,IAAM2O,YAAY,yBAAlB;IACCC,gBAAgB/R,MAAM+R,aADvB;AAGA,IAAIA,aAAJ,EAAmB;SACb,IAAM/O,YAAX,IAA2B+O,cAAcvM,KAAzC,EAAgD;YAC3CsM,UAAU7R,IAAV,CAAe+C,YAAf,CAAJ,EAAkC;gBAC3B6O,aAAa7O,aAAazO,OAAb,CAAqB,gBAArB,EAAuC,UAACmP,CAAD,EAAIC,MAAJ;uBAAuBA,OAAOrH,WAAP,EAAvB;aAAvC,CAAnB;;oBAGO0V,UAAUJ,QAAQ3R,IAAR,CAAa4R,UAAb,IAA2B,IAA3B,GAAkC3d,SAAlD;sCAEsB,CAAC,SAAD,EAAY2d,UAAZ,EAAwBI,eAAejP,YAAf,EAA6B6O,UAA7B,CAAxB,EAAkEG,OAAlE,CAAtB;;SANF,MAQO,IAAI,CAAC9O,iBAAiB,CAAC,SAAD,EAAYF,YAAZ,CAAjB,CAAL,EAAkD;gBAClDgP,WAAUJ,QAAQ3R,IAAR,CAAa+C,YAAb,IAA6B,IAA7B,GAAoC9O,SAApD;kCAEsB,CAAC,SAAD,EAAY8O,YAAZ,EAA0BkP,YAAYlP,YAAZ,CAA1B,EAAqDgP,QAArD,CAAtB;;;;;ACzHH;AACA;;;AAMA,qBAAA,CAAsBre,IAAtB;WACS,UAACR,OAAD,EAAmBgQ,aAAnB;YACHA,kBAAkBjP,SAAtB,EAAiC;mBACzBf,QAAQgf,YAAR,CAAqBxe,IAArB,CAAP;;gBAEOye,YAAR,CAAqBze,IAArB,EAA2BwP,aAA3B;KAJD;;AAQD,IAAMkP,OAAOjS,SAASC,aAAT,CAAuB,KAAvB,CAAb;IACCiS,YAAY,kBADb;IAECC,YAAY,UAFb;AAIAvgB,OAAOwgB,mBAAP,CAA2B3f,MAA3B,EACE4f,OADF,CACU,UAACxf,QAAD;QACFyf,UAAUJ,UAAUK,IAAV,CAAe1f,QAAf,CAAhB;QAEIyf,WAAWA,QAAQ,CAAR,MAAe,KAA9B,EAAqC;;YAChC;gBACGvf,UAAUuf,QAAQ,CAAR,IAAatS,SAASwS,eAAT,CAAyB,4BAAzB,EAAuD,CAACF,QAAQ,CAAR,KAAc,KAAf,EAAsBpW,WAAtB,EAAvD,CAAb,GAA2G8D,SAASC,aAAT,CAAuB,KAAvB,CAA3H;;iBAGK,IAAMwS,SAAX,IAAwB1f,OAAxB,EAAiC;;;oBAG1BS,QAAQT,QAAQ0f,SAAR,CAAd;oBAEI/f,SAAS+f,SAAT,KACA,EAAEA,UAAU,CAAV,MAAiB,GAAjB,IAAwBA,UAAU,CAAV,MAAiB,GAA3C,CADA,IAEAA,cAAcA,UAAUjP,WAAV,EAFd,IAGA,CAAC2O,UAAUtS,IAAV,CAAe4S,SAAf,CAHD,IAIA,EAAEA,aAAaR,IAAf,CAJA,IAKA,CAAC1f,WAAWiB,KAAX,CALL,EAKwB;;0CAED,CAACX,QAAD,EAAW4f,SAAX,EAAsBV,aAAaU,SAAb,CAAtB,CAAtB;;;SAhBH,CAmBE,OAAOrI,CAAP,EAAU;oBACH7N,KAAR,kEAA6E1J,QAA7E,QAA0FuX,CAA1F;;;CAzBJ;;ACpBA;AACA;;;AAKA,uBAAA,CAAsB7W,IAAtB;WACS,UAACR,OAAD,EAA4BgQ,aAA5B;YACHA,kBAAkBjP,SAAtB,EAAiC;;gBAE5B;uBACKf,QAA+B2f,OAA/B,GAAyCnf,IAAzC,IAAiD,IAAzD;aADD,CAEE,OAAO6W,CAAP,EAAU;uBACJ,KAAP;;;gBAGM4H,YAAR,CAAqBze,IAArB,EAA2BwP,aAA3B;KATD;;AAaDF,sBAAsB,CAAC,YAAD,EAAe,OAAf,EAAwB0N,eAAa,OAAb,CAAxB,CAAtB;AACA1N,sBAAsB,CAAC,YAAD,EAAe,QAAf,EAAyB0N,eAAa,QAAb,CAAzB,CAAtB;;ACrBA;AACA;;;AAKA,oBAAA,CAAqBxd,OAArB,EAAgDgQ,aAAhD;QACKA,kBAAkBjP,SAAtB,EAAiC;eACzB,EAAP;;;AAIF+O,sBAAsB,CAAC,SAAD,EAAY,OAAZ,EAAqB8P,WAArB,CAAtB;;ACfA;AACA,IAAaC,UAAU,OAAhB;;ACOP;AACA,IAcM1P,cAA2B2P,UAAjC;;;;AAKA,IAAUC,cAAV;AAAA,WAAUA;;;;;;;;0BAQI,GAA8CC,OAA9C;;;;0BAKA,GAA8CC,OAA9C;;;;4BAKA,GAA4C5R,eAA5C;;;;wBAKA,GAAuB6R,KAAvB;;;;2BAKA,GAAyDC,UAAzD;;;;;;;;;;wBAWA,GAAQC,KAAR;;;;wBAKF,GAAyB,KAAzB;;;;;;;uBAQA,GAAgB,KAAhB;;;;0BAKE,GAAUP,OAAV;;;;2BAKA,GAA2BC,UAA3B;CA9Dd,EAAUC,mBAAAA,mBAAA,CAAV;;AAkEA,IAAMM,KAAM;QAKNpT,SAAwBqT,YAA7B,EAA2C;eAClCrT,SAAwBqT,YAAhC;KADD,MAEO;aACD,IAAIzb,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;gBACvB0b,MAAMtT,SAASC,aAAT,CAAuB,KAAvB,CAAV;gBAEIsT,SAAJ,UAAqB,IAArB,eAAmC3b,CAAnC;gBACI0b,IAAIE,oBAAJ,CAAyB,MAAzB,EAAiClhB,MAArC,EAA6C;sBACtC,IAAN;uBAEOsF,CAAP;;;;WAKI9D,SAAP;CApBU,EAAX;;;;AA2BA,IAAIsf,MAAM,CAAV,EAAa;UACN,IAAI5E,KAAJ,CAAU,yDAAV,CAAN;;;;;AAOD,IAAI/b,MAAJ,EAAY;;;;;;;;;;;QAWLghB,SAAqBhhB,OAAeghB,MAA1C;QACCC,QAAoBjhB,OAAeihB,KADpC;UAGQjhB,MAAR,EAAgB,IAAhB;UACQQ,WAAWA,QAAQpB,SAA3B;UACQ8hB,YAAYA,SAAS9hB,SAA7B;UACQ+hB,kBAAkBA,eAAe/hB,SAAzC;UAEQ4hB,MAAR,EAAgB,IAAhB;UACQA,UAAUA,OAAO1X,EAAzB;UAEQ2X,KAAR,EAAe,IAAf;UACQA,SAASA,MAAM3X,EAAvB;;;;2BAIUlJ;QACNigB,eAAe3gB,cAAf,CAA8BU,QAA9B,CAAJ,EAA6C;uBAC7BA,QAAf,yCAAeA,QAAf;iBACM,QAAL;iBACK,SAAL;iCACgBqQ,WAAf,EAAyBrQ,QAAzB,EAAmC;uBAAA;+BAE1BigB,eAAejgB,QAAf,CAAP;qBAFiC;uBAAA,kBAI9BW,KAJ8B;uCAKlBX,QAAf,IAA2BW,KAA3B;;iBALF,EAOG,IAPH;;;iCAWe0P,WAAf,EAAyBrQ,QAAzB,EAAmCigB,eAAejgB,QAAf,CAAnC,EAA6D,IAA7D;;;;;;AAhBJ,KAAK,IAAMA,QAAX,IAAuBigB,cAAvB,EAAuC;UAA5BjgB,QAA4B;;AAsBvCjB,OAAO4M,MAAP,CAAc0E,WAAd;;AC/KA;AACA,IAYM2Q,aAAa,4BAAnB;AAEA,wBAA+BxT,WAA0B6G;QAClDnB,SAAS1F,UAAU0F,MAAV,GAAmBnU,OAAOoU,MAAP,CAAc,IAAd,CAAlC;QACCjT,UAAUsN,UAAUtN,OADrB;SAGK,IAAM6P,YAAX,IAA2BsE,SAASnB,MAApC,EAA4C;YACvCmB,SAASnB,MAAT,CAAgB5T,cAAhB,CAA+ByQ,YAA/B,CAAJ,EAAkD;gBAC3C7G,KAAKkH,iBAAiBlQ,OAAjB,EAA0B6P,YAA1B,CAAX;gBAEI,CAAC7G,EAAD,IAAO6G,iBAAiB,OAA5B,EAAqC;oBAChCM,YAASC,KAAb,EAAoB;4BACXgD,GAAR,gBAAyBvD,YAAzB;;;;mBAIKA,YAAP,IAAuB;sBAAA;0BAEZsE,SAASnB,MAAT,CAAgBnD,YAAhB;aAFX;;;;;;;;;AAaH,0BAAiCjP;QAC5Boa,cAAcpa,KAAK,CAAL,CAAd,CAAJ,EAA4B;aACtB,IAAMJ,IAAX,IAAoBI,KAAK,CAAL,CAApB,EAAoE;gBAC/DA,KAAK,CAAL,EAAQxB,cAAR,CAAuBoB,IAAvB,CAAJ,EAAkC;iCAChB,CAACA,IAAD,EAAOI,KAAK,CAAL,EAAQJ,IAAR,CAAP,CAAjB;;;KAHH,MAMO,IAAIb,SAASiB,KAAK,CAAL,CAAT,CAAJ,EAAuB;YACvBJ,QAAOI,KAAK,CAAL,CAAb;YACCuT,WAAWvT,KAAK,CAAL,CADZ;YAGI,CAACjB,SAASa,KAAT,CAAL,EAAqB;oBACZiB,IAAR,2EAAuFjB,KAAvF;SADD,MAEO,IAAI,CAACwa,cAAc7G,QAAd,CAAL,EAA8B;oBAC5B1S,IAAR,+EAA2FjB,KAA3F,EAAiG2T,QAAjG;SADM,MAEA;gBACF9F,gBAAgB7N,KAAhB,CAAJ,EAA2B;wBAClBiB,IAAR,0CAAsDjB,KAAtD;;gBAEKugB,WAAsC,EAA5C;gBACChY,QAAkB,IAAIzI,KAAJ,CAAU,GAAV,CADnB;gBAECyS,aAAuB,EAFxB;gBAGCiO,eAC6B3S,gBAAgB7N,KAAhB,IAAwB,EAJtD;gBAKCyH,WAAW+C,iBAAkBmJ,SAAiBlM,QAAnC,CALZ;yBAOa+K,MAAb,GAAsB,EAAtB;gBACI1T,SAAS2I,QAAT,CAAJ,EAAwB;6BACVA,QAAb,GAAwBA,QAAxB;;iBAEI,IAAM+L,IAAX,IAAmBG,QAAnB,EAA6B;oBACxBA,SAAS/U,cAAT,CAAwB4U,IAAxB,CAAJ,EAAmC;wBAC5BiN,OAAO7O,OAAO4B,IAAP,EACXE,KADW,CACL4M,UADK,CAAb;wBAGIG,IAAJ,EAAU;AACTD;;;;;iDACkBC,IAAlB,8HAAwB;oCAAbtG,GAAa;;oCACjB7E,UAAU6E,QAAQ,MAAR,GACb,CADa,GAEbA,QAAQ,IAAR,GACC,GADD,GAECxS,WAAWwS,GAAX,CAJJ;oCAMI7E,UAAU,CAAV,IAAeA,UAAU,GAA7B,EAAkC;4CACzBrU,IAAR,gFAA4FjB,KAA5F,EAAkGsV,OAAlG;iCADD,MAEO,IAAIhR,MAAMgR,OAAN,CAAJ,EAAoB;4CAClBrU,IAAR,iEAA6EjB,KAA7E,EAAmFwT,IAAnF,EAAyF2G,GAAzF;iCADM,MAEA;wCACF,CAACoG,SAAS3O,OAAO0D,OAAP,CAAT,CAAL,EAAgC;iDACtB1D,OAAO0D,OAAP,CAAT,IAA4B,EAA5B;;6CAEQ1D,OAAO0D,OAAP,CAAT,EAA0BlN,IAA1B,CAA+BoL,IAA/B;yCACK,IAAMlU,QAAX,IAAuBqU,SAASH,IAAT,CAAvB,EAAuC;4CAClC,CAACjB,WAAWnD,QAAX,CAAoB9P,QAApB,CAAL,EAAoC;uDACxB8I,IAAX,CAAgB9I,QAAhB;;;;;;;;;;;;;;;;;;;;;;gBAQDohB,kBAAkBriB,OAAOoiB,IAAP,CAAYF,QAAZ,EACtBI,IADsB,CACjB,UAACzZ,CAAD,EAAIC,CAAJ;oBACCyZ,KAAKjZ,WAAWT,CAAX,CAAX;oBACC2Z,KAAKlZ,WAAWR,CAAX,CADN;uBAGOyZ,KAAKC,EAAL,GAAU,CAAV,GAAcD,KAAKC,EAAL,GAAU,CAAC,CAAX,GAAe,CAApC;aALsB,CAAxB;4BAQgB/B,OAAhB,CAAwB,UAAC3E,GAAD;sBACjB/R,IAAN,CAAWe,KAAX,CAAiBoX,SAASpG,GAAT,CAAjB;aADD;;;;;;sCAGuB5H,UAAvB,mIAAmC;wBAAxBjT,SAAwB;;wBAC5B6T,QAAkB,EAAxB;wBACC9D,eAAeqD,UAAUpT,SAAV,CADhB;;;;;;8CAGkBohB,eAAlB,mIAAmC;gCAAxBvG,IAAwB;;;;;;sDACdoG,SAASpG,IAAT,CAApB,mIAAmC;wCAAxBla,MAAwB;;wCAC5B6gB,iBAAiBnN,SAAS1T,MAAT,CAAvB;wCAEI6gB,eAAezR,YAAf,CAAJ,EAAkC;8CAC3BjH,IAAN,CAAWjJ,SAAS2hB,eAAezR,YAAf,CAAT,IACRyR,eAAezR,YAAf,CADQ,GAERyR,eAAezR,YAAf,EAA6B,CAA7B,CAFH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wBAMC8D,MAAMpU,MAAV,EAAkB;4BACXgiB,eAAe3L,YAAYjC,KAAZ,EAAmB9D,YAAnB,CAArB;4BACIrD,QAAQ,CAAZ;4BAEI+U,YAAJ,EAAkB;;;;;;sDACCL,eAAlB,mIAAmC;wCAAxBvG,KAAwB;;;;;;8DACdoG,SAASpG,KAAT,CAApB,mIAAmC;gDAAxBla,KAAwB;;gDAC5B+gB,mBAAmBrN,SAAS1T,KAAT,EAAgBoP,YAAhB,CAAzB;gDAEI2R,gBAAJ,EAAsB;oDACjBlhB,MAAMmJ,OAAN,CAAc+X,gBAAd,KAAmCA,iBAAiBjiB,MAAjB,GAA0B,CAA7D,KAAmEI,SAAS6hB,iBAAiB,CAAjB,CAAT,KAAiClhB,MAAMmJ,OAAN,CAAc+X,iBAAiB,CAAjB,CAAd,CAApG,CAAJ,EAA6I;iEAC/HhV,KAAb,EAAoBxC,MAApB,GAA6BW,eAAe6W,iBAAiB,CAAjB,CAAf,EAAoCC,aAAaxZ,QAAb,IAAyBhG,gBAA7D,CAA7B;;6DAEYuK,OAAb,EAAsBsJ,OAAtB,GAAgC3N,WAAWwS,KAAX,IAAkB,GAAlD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yCAIU3H,MAAb,CAAoBnD,YAApB,IAAoC0R,YAApC;;;;;;;;;;;;;;;;;;;;;AAQN7f,eAAe,CAAC,kBAAD,EAAqBggB,gBAArB,CAAf,EAAuD,IAAvD;;ACtJA;AACA,IAkBIC,sBAAJ;AAEA,IAAI;oBACaC,OAAhB;CADD,CAEE,YAAWC,EAAX,EAAM;AAER,IAAMC,kBAAkB,2EAAxB;;;;AAKA,qBAAA,CAAsBC,aAAtB,EAAmDxI,MAAnD;qBACgBA,MAAf,EAAuB,SAAvB,EAAkCwI,aAAlC;qBACexI,MAAf,EAAuB,MAAvB,EAA+BwI,cAAc7H,IAAd,CAAmB8H,IAAnB,CAAwBD,aAAxB,CAA/B;qBACexI,MAAf,EAAuB,OAAvB,EAAgCwI,cAAcE,KAAd,CAAoBD,IAApB,CAAyBD,aAAzB,CAAhC;QACKA,cAAsBG,OAA3B,EAAoC;;yBAEpB3I,MAAf,EAAuB,SAAvB,EAAmCwI,cAAsBG,OAAtB,CAA8BF,IAA9B,CAAmCD,aAAnC,CAAnC;;;;AAmBF;sCAA2DI;;;;;;;;kBAK9ChC,UAJZ;;;;;WAQQtf,SARR;;;;;YAYSD,KAAK,CAAL,CAZT;;;;;;;;;;;;;qBAwBkBoa,cAAcoH,KAAd,MAAyBA,MAAMC,CAAN,IAAarH,cAAcoH,MAAMrP,UAApB,KAAmC,CAAEqP,MAAMrP,UAAN,CAAyBuP,KAA/D,IAAyE3iB,SAASyiB,MAAMrP,UAAf,CAA9G,CAxBlB;;;;;;;oBA+ByB,CANzB;;;;;qBAAA;;;;;;;;;;0BAAA;;;;;;uBAAA;;;;;;;uBAAA;;;;;oBAAA;;;qBAAA;;;qBAAA;;;;;;QA6CInT,OAAO,IAAP,CAAJ,EAAkB;;mBAEN,CAAC,IAAD,CAAX;KAFD,MAGO,IAAI2iB,UAAU,IAAV,CAAJ,EAAqB;;;mBAGhBtO,WAAW,IAAX,CAAX;YACI+F,iBAAiB,IAAjB,CAAJ,EAA4B;yBACb,KAAwBva,QAAxB,CAAiCwa,UAA/C;;KALK,MAOA,IAAIuI,cAAJ,EAAoB;mBACfvO,WAAWmO,MAAM7T,QAAN,IAAkB6T,MAAM/K,CAAnC,CAAX;;KADM,MAGA,IAAIzX,OAAOwiB,KAAP,CAAJ,EAAmB;mBACdnO,WAAW,CAACmO,KAAD,CAAX,CAAX;;KADM,MAGA,IAAIG,UAAUH,KAAV,CAAJ,EAAsB;mBACjBnO,WAAWmO,KAAX,CAAX;;;;QAIG7T,QAAJ,EAAc;yBACEA,QAAf,EAAyB,UAAzB,EAAqC4B,WAAS6R,IAAT,CAAczT,QAAd,CAArC;YACI0L,UAAJ,EAAgB;6BACA1L,SAAS9O,QAAxB,EAAkC,YAAlC,EAAgDwa,UAAhD;;;;QAIEuI,cAAJ,EAAoB;wBACHhU,SAAS4T,MAAMrP,UAAf,EAA2BqP,MAAMC,CAAjC,CAAhB;KADD,MAEO;;wBAEUzhB,KAAK6hB,eAAL,CAAhB;;;;QAIKhI,YAAYiI,kBAAkB,SAApC;QACCC,WAAW,CAAClI,SAAD,IAAc9a,SAAS+iB,aAAT,CAD1B;QAEC9G,gBAAgB+G,YAAYtU,gBAAgBqU,aAAhB,CAF7B;QAGCE,OAAOJ,iBAAiBhU,SAAS4T,MAAMhU,OAAf,EAAwBgU,MAAMS,CAA9B,CAAjB,GAAoDjiB,KAAK6hB,aAAL,CAH5D;QAKIzH,cAAc4H,IAAd,CAAJ,EAAyB;qBACXA,IAAb;;;QAGGjB,iBAAiBnT,SAASsU,cAAcA,WAAWzY,OAAlC,EAA2CqB,YAASrB,OAApD,CAArB,EAAmF;kBACxE,IAAIsX,aAAJ,CAAkB,UAACoB,OAAD,EAAUC,MAAV;uBAChBA,MAAX;;;;;;;;uBAQW,kBAACzJ,MAAD;oBACNS,iBAAiBT,MAAjB,KAA4BA,OAAOlP,OAAvC,EAAgD;2BACxCkP,OAAOW,IAAd;2BACOX,OAAO0I,KAAd;2BACQ1I,OAAe2I,OAAvB;4BACQ3I,MAAR;iCACaA,OAAOlP,OAApB,EAA6BkP,MAA7B;iBALD,MAMO;4BACEA,MAAR;;aARF;SATS,CAAV;YAqBIhL,QAAJ,EAAc;yBACAlE,OAAb,EAAsBkE,QAAtB;;;QAGElE,OAAJ,EAAa;YACN4Y,2BAA2BH,cAAcA,WAAWxY,kBAA1D;YACCA,qBAA8BkE,SAASyU,wBAAT,EAAmCvX,YAASpB,kBAA5C,CAD/B;YAGI,CAACiE,QAAD,IAAa,CAACoU,QAAlB,EAA4B;gBACvBrY,kBAAJ,EAAwB;6DACmBjB,UAAU4Z,wBAAV,IAAsC,EAAtC,GAA2CnB,eAArF;aADD,MAEO;;;SAHR,MAMO,IAAI,CAACY,aAAL,EAAoB;gBACtBpY,kBAAJ,EAAwB;+DACqBjB,UAAU4Z,wBAAV,IAAsC,EAAtC,GAA2CnB,eAAvF;aADD,MAEO;;;;;QAKJ,CAACvT,QAAD,IAAa,CAACoU,QAAf,IAA4B,CAACD,aAAjC,EAAgD;eACxCrY,OAAP;;;;QAKGsY,QAAJ,EAAc;YACPO,aAAoB,EAA1B;YACCpJ,iBAAkCzP,WAAW;sBAClCA,OADkC;uBAEjC8E,QAFiC;uBAGjCgU;SAJb;eAOOV,gBAAgB7hB,KAAKrB,MAA5B,EAAoC;uBACxBqJ,IAAX,CAAgBhI,KAAK6hB,eAAL,CAAhB;;;;;;;;YASK/H,SAAUgI,cAAyBthB,OAAzB,CAAiC,OAAjC,EAA0C,EAA1C,CAAhB;YACCI,WAAWwe,QAActF,MAAd,CADZ;YAGIlZ,QAAJ,EAAc;gBACP+X,SAAS/X,SAAS0hB,UAAT,EAAqB3U,QAArB,EAA+BuL,cAA/B,EAA+C4I,aAA/C,CAAf;gBAEInJ,WAAWxY,SAAf,EAA0B;uBAClBwY,MAAP;;mBAGMhL,YAAYlE,OAAnB;SAPD,MAQO,IAAI,CAACuR,aAAL,EAAoB;oBAClBpS,KAAR,kCAA6CkZ,aAA7C;;;;QAKEU,yBAAJ;QAEIpI,cAAc0H,aAAd,KAAgCjI,SAAhC,IAA6CmB,aAAjD,EAAgE;;;;YAIzDxN,UAAiC,EAAvC;YACIoM,SAAS9O,YAAShB,IAAtB;;;YAIIL,OAAJ,EAAa;6BACG+D,OAAf,EAAwB,UAAxB,EAAoC/D,OAApC;6BACe+D,OAAf,EAAwB,WAAxB,EAAqC+U,QAArC;6BACe/U,OAAf,EAAwB,WAAxB,EAAqCe,QAArC;;yBAEcf,OAAf,EAAwB,QAAxB,EAAkC,CAAlC;yBACeA,OAAf,EAAwB,UAAxB,EAAoC,CAApC;yBACeA,OAAf,EAAwB,YAAxB,EAAsC,CAAtC;yBACeA,OAAf,EAAwB,QAAxB,EAAkC,CAAlC;;YAGI4M,cAAc8H,UAAd,CAAJ,EAA+B;gBACxBO,gBAAgBrY,iBAAiB8X,WAAW7a,QAA5B,CAAtB;+BAEmBob,kBAAkBtiB,SAArC;oBACQkH,QAAR,GAAmBuG,SAAS6U,aAAT,EAAwB3X,YAASzD,QAAjC,CAAnB;oBACQ8B,KAAR,GAAgByE,SAASzD,cAAc+X,WAAW/Y,KAAzB,CAAT,EAA0C2B,YAAS3B,KAAnD,CAAhB;;;oBAGQC,MAAR,GAAiBW,eAAe6D,SAASsU,WAAW9Y,MAApB,EAA4B0B,YAAS1B,MAArC,CAAf,EAA6DoE,QAAQnG,QAArE,KAAkF0C,eAAee,YAAS1B,MAAxB,EAAgCoE,QAAQnG,QAAxC,CAAnG;oBACQiC,IAAR,GAAesE,SAAStD,aAAa4X,WAAW5Y,IAAxB,CAAT,EAAwCwB,YAASxB,IAAjD,CAAf;oBACQM,MAAR,GAAiB4D,QAAQS,WAAR,GAAsBL,SAASlD,eAAewX,WAAWtY,MAA1B,CAAT,EAA4CkB,YAASlB,MAArD,CAAvC;gBACIsY,WAAWrY,KAAX,IAAoB,IAAxB,EAA8B;wBACrBA,KAAR,GAAgB+D,SAASjD,cAAcuX,WAAWrY,KAAzB,CAAT,EAA0C,CAA1C,CAAhB;;gBAEGpB,UAAUyZ,WAAWzY,OAArB,CAAJ,EAAmC;wBAC1BA,OAAR,GAAkByY,WAAWzY,OAA7B;;oBAEOE,KAAR,GAAgBiE,SAASnD,cAAcyX,WAAWvY,KAAzB,CAAT,EAA0CmB,YAASnB,KAAnD,CAAhB;gBACIuY,WAAW3Y,QAAX,IAAuB,CAAC+V,MAAYoD,aAAxC,EAAuD;;;;;wBAK9CnZ,QAAR,GAAmB,IAAnB;;gBAEG2Y,WAAWS,IAAX,KAAoB,IAAxB,EAA8B;wBACrBA,IAAR,GAAe,IAAf;;gBAEGjkB,SAASwjB,WAAWU,OAApB,KAAgChkB,WAAWsjB,WAAWU,OAAtB,CAApC,EAAoE;wBAC3DA,OAAR,GAAkBV,WAAWU,OAA7B;;gBAEG,CAAC/I,SAAL,EAAgB;oBACXqI,WAAW,SAAX,KAAyB,IAA7B,EAAmC;kCACc9E,OAA/C,GAAyD8E,WAAW,SAAX,CAAzD;4BACOtZ,KAAR,iEAA4EsZ,WAAW,SAAX,CAA5E;;oBAEGA,WAAW,YAAX,KAA4B,IAAhC,EAAsC;kCACWW,UAA/C,GAA4DX,WAAW,YAAX,CAA5D;4BACOtZ,KAAR,oEAA+EsZ,WAAW,YAAX,CAA/E;;;;gBAIIY,eAAe7Y,cAAciY,WAAWjZ,KAAzB,CAArB;gBACC8Z,kBAAkB7Y,iBAAiBgY,WAAWhZ,QAA5B,CADnB;gBAEC8Z,kBAAkBC,iBAAiBf,WAAW7M,QAA5B,CAFnB;gBAGC6N,cAActY,aAAasX,WAAWpY,IAAxB,CAHf;gBAKIgZ,gBAAgB,IAApB,EAA0B;wBACjB7Z,KAAR,GAAgB6Z,YAAhB;;gBAEGC,mBAAmB,IAAvB,EAA6B;wBACpB7Z,QAAR,GAAmB6Z,eAAnB;;gBAEGC,mBAAmB,IAAvB,EAA6B;wBACpB3N,QAAR,GAAmB2N,eAAnB;;gBAEGE,eAAe,IAAnB,EAAyB;yBACfA,WAAT;;SAzDF,MA2DO,IAAI,CAACtB,cAAL,EAAqB;;gBAEvBuB,SAAS,CAAb;oBAEQ9b,QAAR,GAAmB+C,iBAAiBpK,KAAK6hB,aAAL,CAAjB,EAAsC,IAAtC,CAAnB;gBACIrU,QAAQnG,QAAR,KAAqBlH,SAAzB,EAAoC;wBAC3BkH,QAAR,GAAmByD,YAASzD,QAA5B;aADD,MAEO;mCACa,IAAnB;;;gBAGG,CAACzI,WAAWoB,KAAK6hB,gBAAgBsB,MAArB,CAAX,CAAL,EAA+C;;oBAExC/Z,SAASW,eAAe/J,KAAK6hB,gBAAgBsB,MAArB,CAAf,EAA6CvV,SAASJ,WAAWpD,iBAAiBoD,QAAQnG,QAAzB,CAApB,EAAwDyD,YAASzD,QAAjE,CAA7C,EAAmI,IAAnI,CAAf;oBAEI+B,WAAWjJ,SAAf,EAA0B;;4BAEjBiJ,MAAR,GAAiBA,MAAjB;;;gBAGIF,WAAWgB,iBAAiBlK,KAAK6hB,gBAAgBsB,MAArB,CAAjB,EAA+C,IAA/C,CAAjB;gBAEIja,aAAa/I,SAAjB,EAA4B;wBACnB+I,QAAR,GAAmBA,QAAnB;;oBAEOC,KAAR,GAAgB2B,YAAS3B,KAAzB;oBACQG,IAAR,GAAewB,YAASxB,IAAxB;oBACQM,MAAR,GAAiB4D,QAAQS,WAAR,GAAsBnD,YAASlB,MAAhD;;YAGGiQ,aAAarM,QAAQ7D,KAAR,KAAkB,KAAnC,EAA0C;kBACnC,IAAIkR,KAAJ,CAAU,qDAAV,CAAN;;YAGG,CAAC2H,gBAAD,IAAqBxH,aAArB,IAAsCA,cAAc3T,QAAxD,EAAkE;oBACzDA,QAAR,GAAmB2T,cAAc3T,QAAjC;;;;;;;;YAUK+b,gBAA+B;4BAAA;8BAAA;mBAG7BjjB,SAH6B;mBAI7BA,SAJ6B;oBAK5ByZ,WAAA,cAA+B,CALH;6BAMnB,CANmB;0BAOtB,CAPsB;uBAQzB;SARZ;qBAWa,EAAb;aACK,IAAIhO,QAAQ,CAAjB,EAAoBA,QAAQ+B,SAAShP,MAArC,EAA6CiN,OAA7C,EAAsD;gBAC/CxM,UAAUuO,SAAS/B,KAAT,CAAhB;gBACIgM,QAAQ,CAAZ;gBAEI5Y,OAAOI,OAAP,CAAJ,EAAqB;;oBAChBya,SAAJ,EAAe;wBACRwJ,gBAAgBpW,KAAK7N,OAAL,EAAcgO,iBAAd,CAAgCI,QAAQ7D,KAAxC,CAAtB;oCAEgB0Z,iBAAiBA,cAAcjR,MAA/C;wBACI,CAAC0P,aAAL,EAAoB;gCACXlZ,KAAR,6FAA0GxJ,OAA1G;;;6BAGQ,mBAAyB,EAAEikB,cAAcrV,MAAd,KAAF,eAAlC,CARc;;oBAUTtB,8BACF0W,iBACHhkB,kBACA4O,QAAQoV,cAAcpV,MAAd,GAAuB4J,QAHhC;wBAMQtJ,MAAR;2BACWtG,IAAX,CAAgB0E,SAAhB;oBACIc,QAAQoV,OAAZ,EAAqB;wBAChBhkB,WAAW4O,QAAQoV,OAAnB,CAAJ,EAAiC;4BAC1B/f,MAAMygB,eAAe9V,QAAQoV,OAAvB,EAAgCxjB,OAAhC,EAAyCwM,KAAzC,EAAgD+B,SAAShP,MAAzD,EAAiEgP,QAAjE,EAA2E,SAA3E,CAAZ;4BAEIjP,SAASmE,GAAT,CAAJ,EAAmB;sCACRsG,KAAV,GAAkBqE,QAAQrE,KAAR,GAAgBtG,GAAlC;;qBAJF,MAMO;kCACIsG,KAAV,GAAkBqE,QAAQrE,KAAR,GAAiBqE,QAAQoV,OAAR,GAAkBhX,KAArD;;;oBAGE4B,QAAQmV,IAAZ,EAAkB;8BACPtb,QAAV,GAAqBmG,QAAQnG,QAAR,GAAoBmG,QAAQnG,QAAR,GAAmB/E,KAAKS,GAAL,CAAS,IAAI,CAAC6I,QAAQ,CAAT,IAAc+B,SAAShP,MAApC,EAA4C,IAA5C,CAA5D;;oBAEGqc,aAAJ,EAAmB;mCACHtO,SAAf,EAA0BsO,aAA1B;iBADD,MAEO,IAAInB,SAAJ,EAAe;;;8BAGXzH,MAAV,GAAmB0P,aAAnB;iBAHM,MAIA;8BACI1P,MAAV,GAAmBnU,OAAOoU,MAAP,CAAc,IAAd,CAAnB;qCACiB3F,SAAjB,EAA4BoV,aAA5B;;wBAEK1iB,OAAN,EAAesN,SAAf,EAA0Bc,QAAQ7D,KAAlC;;;YAGE2V,MAAYlI,SAAZ,KAA0B,KAA9B,EAAqC;;;iBAG/B,KAAL;;YAEGiC,UAAJ,EAAgB;6BACA1L,SAAS9O,QAAxB,EAAkC,YAAlC,EAAgDwa,UAAhD;;;;;;;WAQK1L,YAAYlE,OAAnB;;;;;AAMD,uBAAA,CAA2BrB,EAA3B,EAAoDhJ,OAApD,EAA+EwM,KAA/E,EAA8FjN,MAA9F,EAA8GgP,QAA9G,EAA4IuM,MAA5I;QACK;eACI9R,GAAGhK,IAAH,CAAQgB,OAAR,EAAiBwM,KAAjB,EAAwBjN,MAAxB,EAAgCgP,QAAhC,EAA0CuM,MAA1C,CAAP;KADD,CAEE,OAAOzD,CAAP,EAAU;gBACH7N,KAAR,0CAAqDsR,MAArD,kBAA0EzD,CAA1E;;;;AC7dF;AACA;;;;;;;;;AAYA,eAAsBnY,OAAYilB;QAC7B;yBACYjlB,KAAf,EAAsB,CAACilB,SAAS,GAAT,GAAe,GAAhB,IAAuB,SAA7C,EAAwDhU,UAAxD;KADD,CAEE,OAAOkH,CAAP,EAAU;gBACH5V,IAAR,oDAAgE4V,CAAhE;;;;ACTF;AACA,IAcMlH,aAA2B2P,UAAjC;;;;AAKA,IAAUC,gBAAV;AAAA,WAAUA;;;;;;;;0BAQI,GAA8CC,OAA9C;;;;0BAKA,GAA8CC,OAA9C;;;;4BAKA,GAA4C5R,eAA5C;;;;wBAKA,GAAuB6R,KAAvB;;;;2BAKA,GAAyDC,UAAzD;;;;;;;;;;wBAWA,GAAQC,KAAR;;;;wBAKF,GAAyB,KAAzB;;;;;;;uBAQA,GAAgB,KAAhB;;;;0BAKE,GAAUP,OAAV;;;;2BAKA,GAA2BC,UAA3B;CA9Dd,EAAUC,qBAAAA,qBAAA,CAAV;;AAkEA,IAAMM,OAAM;QAKNpT,SAAwBqT,YAA7B,EAA2C;eAClCrT,SAAwBqT,YAAhC;KADD,MAEO;aACD,IAAIzb,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;gBACvB0b,MAAMtT,SAASC,aAAT,CAAuB,KAAvB,CAAV;gBAEIsT,SAAJ,UAAqB,IAArB,eAAmC3b,CAAnC;gBACI0b,IAAIE,oBAAJ,CAAyB,MAAzB,EAAiClhB,MAArC,EAA6C;sBACtC,IAAN;uBAEOsF,CAAP;;;;WAKI9D,SAAP;CApBU,EAAX;;;;AA2BA,IAAIsf,QAAM,CAAV,EAAa;UACN,IAAI5E,KAAJ,CAAU,yDAAV,CAAN;;;;;AAOD,IAAI/b,MAAJ,EAAY;;;;;;;;;;;QAWLghB,WAAqBhhB,OAAeghB,MAA1C;QACCC,UAAoBjhB,OAAeihB,KADpC;UAGQjhB,MAAR,EAAgB,IAAhB;UACQQ,WAAWA,QAAQpB,SAA3B;UACQ8hB,YAAYA,SAAS9hB,SAA7B;UACQ+hB,kBAAkBA,eAAe/hB,SAAzC;UAEQ4hB,QAAR,EAAgB,IAAhB;UACQA,YAAUA,SAAO1X,EAAzB;UAEQ2X,OAAR,EAAe,IAAf;UACQA,WAASA,QAAM3X,EAAvB;;;;6BAIUlJ;QACNigB,iBAAe3gB,cAAf,CAA8BU,QAA9B,CAAJ,EAA6C;uBAC7BA,QAAf,yCAAeA,QAAf;iBACM,QAAL;iBACK,SAAL;iCACgBqQ,UAAf,EAAyBrQ,QAAzB,EAAmC;uBAAA;+BAE1BigB,iBAAejgB,QAAf,CAAP;qBAFiC;uBAAA,kBAI9BW,KAJ8B;yCAKlBX,QAAf,IAA2BW,KAA3B;;iBALF,EAOG,IAPH;;;iCAWe0P,UAAf,EAAyBrQ,QAAzB,EAAmCigB,iBAAejgB,QAAf,CAAnC,EAA6D,IAA7D;;;;;;AAhBJ,KAAK,IAAMA,UAAX,IAAuBigB,gBAAvB,EAAuC;YAA5BjgB,UAA4B;;AAsBvCjB,OAAO4M,MAAP,CAAc0E,UAAd;;"}